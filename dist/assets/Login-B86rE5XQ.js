const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/amplify-core-Blotw2Bg.js","assets/vendor-DeJPPs1q.js","assets/react-vendor-C_ls207L.js","assets/sanity-BS235U2J.js"])))=>i.map(i=>d[i]);
import{_ as F}from"./sanity-BS235U2J.js";import{r as t,a as q,u as C,j as s,L as g}from"./react-vendor-C_ls207L.js";import{a as D}from"./index-zctVBz0Z.js";import{F as O}from"./FormBox-Dl2qNixC.js";import{T as _}from"./TextInput-BQHZCKtc.js";import{P as V}from"./PrimaryButton-BzVl43HT.js";import{S as G}from"./StandardLayout-CHsFjCWf.js";/* empty css                        */import{c as W}from"./amplify-core-Blotw2Bg.js";import"./vendor-DeJPPs1q.js";import"./stripe-CN_WJsnY.js";/* empty css                  */import"./PageWrapper-CRYaw3_L.js";import"./Footer-B_S_3MWt.js";const te=()=>{const[n,u]=t.useState(""),[i,k]=t.useState(""),[L,d]=t.useState(""),[A,m]=t.useState(""),[f,x]=t.useState(!1),[h,o]=t.useState(""),[S,M]=t.useState(""),{formData:p}=D(),y=q(),l=C();t.useEffect(()=>{var r,a;(r=l.state)!=null&&r.message&&(M(l.state.message),(a=l.state)!=null&&a.email&&u(l.state.email))},[l.state]);const R=async r=>{var v,N,E,I,w,P,j,b;r.preventDefault(),d(""),m(""),o("");let a=!0;if(n||(d("Email is required"),a=!1),i||(m("Password is required"),a=!1),!!a){x(!0);try{console.log("ðŸ” Attempting sign in with:",{email:n,passwordLength:i.length}),console.log("ðŸ“§ Email format check:",/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(n));const e=await W({username:n,password:i});if(console.log("âœ… Sign in result:",e),console.log("ðŸ”‘ isSignedIn:",e.isSignedIn),console.log("ðŸ”„ nextStep:",e.nextStep),e.isSignedIn){console.log("User is signed in successfully");const c=((v=p._metadata)==null?void 0:v.lastVisitedStep)||((E=(N=p._metadata)==null?void 0:N.completedSteps)==null?void 0:E.length)>0||Object.keys(p.basicInformation||{}).length>0;y(c?"/welcome-back":"/welcome")}else if(console.log("â“ Sign in not complete. NextStep details:",e.nextStep),console.log("ðŸ“‹ NextStep type:",(I=e.nextStep)==null?void 0:I.signInStep),console.log("ðŸ“ Additional info:",(w=e.nextStep)==null?void 0:w.additionalInfo),((P=e.nextStep)==null?void 0:P.signInStep)==="CONFIRM_SIGN_UP"){o("Account needs verification. Attempting to verify automatically..."),console.log("ðŸ“§ User needs verification - attempting auto-confirm for MVP");try{const{confirmSignUp:c}=await F(async()=>{const{confirmSignUp:U}=await import("./amplify-core-Blotw2Bg.js").then(T=>T.i);return{confirmSignUp:U}},__vite__mapDeps([0,1,2,3]));await c({username:n,confirmationCode:"000000"})}catch(c){console.log("Auto-confirm failed (expected):",c),o("Please contact support to verify your account for this MVP.")}}else((j=e.nextStep)==null?void 0:j.signInStep)==="CONFIRM_SIGN_IN_WITH_NEW_PASSWORD_REQUIRED"?(o("Password change required. Please contact support."),console.log("ðŸ” User needs to change password")):((b=e.nextStep)==null?void 0:b.signInStep)==="CONFIRM_SIGN_IN_WITH_SMS_MFA"?(o("SMS verification required. This is not currently supported."),console.log("ðŸ“± SMS MFA required")):(o("Sign in incomplete. Please check your credentials."),console.log("â“ Unknown sign-in step required"))}catch(e){console.error("âŒ Login error details:"),console.error("- Error name:",e.name),console.error("- Error message:",e.message),console.error("- Error code:",e.code),console.error("- Full error:",e),console.error("- Email used:",n),console.error("- Password length:",i.length),e.$response&&(console.error("- Response status:",e.$response.statusCode),console.error("- Response body:",e.$response.body)),e.name==="NotAuthorizedException"?(m("Incorrect username or password"),console.error("ðŸš« This usually means wrong password or user needs confirmation")):e.name==="UserNotFoundException"?(d("No account found with this email address"),console.error("ðŸ‘¤ User not found - check if registration completed successfully")):e.name==="TooManyRequestsException"?o("Too many login attempts. Please try again later."):e.name==="UserNotConfirmedException"?(o("Account not verified. Please check your email for verification link."),console.error("ðŸ“§ User exists but not confirmed - check email verification")):e.name==="InvalidParameterException"?(o("Invalid login parameters. Please check your email format."),console.error("âš ï¸ Invalid parameters - likely email format issue")):(o(e.message||"Login failed. Please try again."),console.error("â“ Unhandled error type:",e.name))}finally{x(!1)}}};return s.jsx(G,{title:s.jsxs(s.Fragment,{children:[s.jsx("h2",{className:"h1sub pre-title-subtitle",children:"Good to see you again. Your plans, your pace."}),s.jsxs("span",{className:"h1",children:["Let's continue your ",s.jsx("span",{className:"h1b",children:"farewell"})," ",s.jsx("span",{className:"h1",children:"journey."})]})]}),className:"login-page",children:s.jsx("div",{className:"onboarding-form-content",children:s.jsx(O,{className:"onboarding-formbox",children:s.jsxs("form",{className:"standard-form",onSubmit:R,noValidate:!0,children:["            ",s.jsx(_,{label:"Email",value:n,onChange:r=>{u(r.target.value),d("")},type:"email",error:L,required:!0}),s.jsx(_,{label:"Password",value:i,onChange:r=>{k(r.target.value),m(""),o("")},type:"password",error:A,required:!0}),S&&s.jsx("div",{className:"success-message",style:{color:"#27ae60",fontSize:"14px",marginTop:"10px",textAlign:"center",backgroundColor:"#d5f4e6",padding:"10px",borderRadius:"4px",border:"1px solid #27ae60"},children:S}),h&&s.jsx("div",{className:"error-message",style:{color:"#e74c3c",fontSize:"14px",marginTop:"10px",textAlign:"center"},children:h}),s.jsx("div",{className:"forgot-password-link",children:s.jsx(g,{to:"/forgot-password",children:"Forgot password?"})}),s.jsx("div",{className:"onboarding-button-container",children:s.jsx(V,{type:"submit",disabled:f,children:f?"Logging in...":"Log In"})}),s.jsx("div",{className:"onboarding-privacy-container",children:s.jsxs("p",{className:"privacy-text",children:["By logging in you are accepting our"," ",s.jsx(g,{to:"/terms",className:"privacy-link",children:"Terms of Service"})," ","and"," ",s.jsx(g,{to:"/privacy",className:"privacy-link",children:"Privacy Policy"}),"."]})})]})})})})};export{te as default};
