import{u as y,E as S,y as L,r as n,A as C,R as e}from"./index-CF6624GP.js";import{u as P}from"./useCollaborators-CyRHwzSl.js";import{S as i}from"./StandardLayout-BbnnO7S-.js";import{F as c}from"./FormBox-CJsMRRhu.js";import{P as u}from"./PrimaryButton-DwYit0ib.js";import x from"./Login-CFjVW-ej.js";import"./PageWrapper-BpgNwjTZ.js";import"./Footer-Dbu-YUaM.js";import"./TextInput-BYf_x9nw.js";import"./TextInput-C1wQsApC.js";/* empty css                        */const j=()=>{const{inviteId:r}=y(),{isAuthenticated:o,isLoading:p}=S(),{updateCollaborator:d}=P(),l=L(),[t,g]=n.useState(null),[f,E]=n.useState(!0),[m,s]=n.useState(""),[w,v]=n.useState(!1),b=C();n.useEffect(()=>{r&&h()},[r]),n.useEffect(()=>{o&&t&&t.status==="pending"&&N()},[o,t]);const h=async()=>{try{const a=await b.models.Collaborator.get({id:r});a?(g(a),o||localStorage.setItem("pendingInviteId",r)):s("Invalid or expired invitation.")}catch(a){console.error("Error fetching invite:",a),s("Unable to load invitation details.")}finally{E(!1)}},N=async()=>{try{await d(r,{status:"accepted",respondedAt:new Date().toISOString()}),localStorage.removeItem("pendingInviteId"),l("/collaborator/welcome",{state:{planOwnerName:t.planOwnerName,farewellPlanId:t.farewellPlanCollaboratorsId}})}catch(a){console.error("Error accepting invite:",a),s("Failed to accept invitation. Please try again.")}},I=()=>{v(!0)};return p||f?e.createElement(i,{title:e.createElement("span",{className:"h1"},"Loading..."),subtitle:e.createElement("span",{className:"h1sub"},"Please wait while we process your invitation.")},e.createElement("div",{className:"onboarding-form-content"},e.createElement(c,{className:"onboarding-formbox"},e.createElement("p",null,"Loading invitation details...")))):m?e.createElement(i,{title:e.createElement("span",{className:"h1"},"Invitation Error"),subtitle:e.createElement("span",{className:"h1sub"},"There was a problem with your invitation.")},e.createElement("div",{className:"onboarding-form-content"},e.createElement(c,{className:"onboarding-formbox"},e.createElement("p",{className:"error-message"},m),e.createElement(u,{onClick:()=>l("/")},"Return to Homepage")))):w?e.createElement(x,null):o&&t?.status==="accepted"?(l("/collaborator/welcome",{state:{planOwnerName:t.planOwnerName,farewellPlanId:t.farewellPlanCollaboratorsId}}),null):e.createElement(i,{title:e.createElement(e.Fragment,null,e.createElement("span",{className:"h1"},"You're invited to view "),e.createElement("span",{className:"h1b"},t?.planOwnerName||"someone","'s"),e.createElement("span",{className:"h1"}," farewell plan")),subtitle:e.createElement("span",{className:"h1sub"},t?.planOwnerName," has shared their farewell wishes with you.")},e.createElement("div",{className:"onboarding-form-content"},e.createElement(c,{className:"onboarding-formbox"},e.createElement("div",{style:{textAlign:"center",marginBottom:"2rem"}},e.createElement("p",null,e.createElement("strong",null,t?.planOwnerName)," has invited you to view and collaborate on their farewell plan."),e.createElement("p",null,"To continue, please sign in to your account or create a new one.")),!o&&e.createElement("div",{className:"onboarding-button-container"},e.createElement(u,{onClick:I},"Sign In to Continue")))))};export{j as default};
