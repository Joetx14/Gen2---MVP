import{f as y,a as S,r as n,R as e}from"./react-D8qwWWc-.js";import{u as L}from"./index-C_jNqslI.js";import{u as C}from"./useCollaborators-S30JgYxW.js";import{S as i}from"./StandardLayout-CODG-ZJt.js";import{F as c}from"./FormBox-DKl1xVdV.js";import{P as p}from"./PrimaryButton-D-OJOajV.js";import P from"./Login-5Hx6Y7Ab.js";import{g as x}from"./amplify-CUteMs5F.js";import"./vendor-BRRJ753s.js";import"./PageWrapper-qXWqd5_q.js";import"./Footer-DbTn4dsc.js";import"./TextInput-CfcbAWFU.js";/* empty css                  *//* empty css                        */const G=()=>{const{inviteId:r}=y(),{isAuthenticated:o,isLoading:u}=L(),{updateCollaborator:d}=C(),l=S(),[t,f]=n.useState(null),[g,E]=n.useState(!0),[m,s]=n.useState(""),[w,v]=n.useState(!1),b=x();n.useEffect(()=>{r&&h()},[r]),n.useEffect(()=>{o&&t&&t.status==="pending"&&N()},[o,t]);const h=async()=>{try{const a=await b.models.Collaborator.get({id:r});a?(f(a),o||localStorage.setItem("pendingInviteId",r)):s("Invalid or expired invitation.")}catch(a){console.error("Error fetching invite:",a),s("Unable to load invitation details.")}finally{E(!1)}},N=async()=>{try{await d(r,{status:"accepted",respondedAt:new Date().toISOString()}),localStorage.removeItem("pendingInviteId"),l("/collaborator/welcome",{state:{planOwnerName:t.planOwnerName,farewellPlanId:t.farewellPlanCollaboratorsId}})}catch(a){console.error("Error accepting invite:",a),s("Failed to accept invitation. Please try again.")}},I=()=>{v(!0)};return u||g?e.createElement(i,{title:e.createElement("span",{className:"h1"},"Loading..."),subtitle:e.createElement("span",{className:"h1sub"},"Please wait while we process your invitation.")},e.createElement("div",{className:"onboarding-form-content"},e.createElement(c,{className:"onboarding-formbox"},e.createElement("p",null,"Loading invitation details...")))):m?e.createElement(i,{title:e.createElement("span",{className:"h1"},"Invitation Error"),subtitle:e.createElement("span",{className:"h1sub"},"There was a problem with your invitation.")},e.createElement("div",{className:"onboarding-form-content"},e.createElement(c,{className:"onboarding-formbox"},e.createElement("p",{className:"error-message"},m),e.createElement(p,{onClick:()=>l("/")},"Return to Homepage")))):w?e.createElement(P,null):o&&t?.status==="accepted"?(l("/collaborator/welcome",{state:{planOwnerName:t.planOwnerName,farewellPlanId:t.farewellPlanCollaboratorsId}}),null):e.createElement(i,{title:e.createElement(e.Fragment,null,e.createElement("span",{className:"h1"},"You're invited to view "),e.createElement("span",{className:"h1b"},t?.planOwnerName||"someone","'s"),e.createElement("span",{className:"h1"}," farewell plan")),subtitle:e.createElement("span",{className:"h1sub"},t?.planOwnerName," has shared their farewell wishes with you.")},e.createElement("div",{className:"onboarding-form-content"},e.createElement(c,{className:"onboarding-formbox"},e.createElement("div",{style:{textAlign:"center",marginBottom:"2rem"}},e.createElement("p",null,e.createElement("strong",null,t?.planOwnerName)," has invited you to view and collaborate on their farewell plan."),e.createElement("p",null,"To continue, please sign in to your account or create a new one.")),!o&&e.createElement("div",{className:"onboarding-button-container"},e.createElement(p,{onClick:I},"Sign In to Continue")))))};export{G as default};
