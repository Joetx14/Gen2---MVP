import{f as Gr,O as xt,v as zr,a as Wt,t as Qr,S as Ot,m as ai,b as Yr,c as Jr,d as Ns,e as As}from"./vendor-DeJPPs1q.js";const Xr="Logging",Zr="x-amz-user-agent",ea="NoHubcallbackProvidedException";var ie;(function(e){e.DEBUG="DEBUG",e.ERROR="ERROR",e.INFO="INFO",e.WARN="WARN",e.VERBOSE="VERBOSE",e.NONE="NONE"})(ie||(ie={}));const qi={VERBOSE:1,DEBUG:2,INFO:3,WARN:4,ERROR:5,NONE:6};class Y{constructor(t,n=ie.WARN){this.name=t,this.level=n,this._pluggables=[]}_padding(t){return t<10?"0"+t:""+t}_ts(){const t=new Date;return[this._padding(t.getMinutes()),this._padding(t.getSeconds())].join(":")+"."+t.getMilliseconds()}configure(t){return t?(this._config=t,this._config):this._config}_log(t,...n){let i=this.level;Y.LOG_LEVEL&&(i=Y.LOG_LEVEL),typeof window<"u"&&window.LOG_LEVEL&&(i=window.LOG_LEVEL);const o=qi[i];if(!(qi[t]>=o))return;let r=console.log.bind(console);t===ie.ERROR&&console.error&&(r=console.error.bind(console)),t===ie.WARN&&console.warn&&(r=console.warn.bind(console)),Y.BIND_ALL_LOG_LEVELS&&(t===ie.INFO&&console.info&&(r=console.info.bind(console)),t===ie.DEBUG&&console.debug&&(r=console.debug.bind(console)));const a=`[${t}] ${this._ts()} ${this.name}`;let c="";if(n.length===1&&typeof n[0]=="string")c=`${a} - ${n[0]}`,r(c);else if(n.length===1)c=`${a} ${n[0]}`,r(a,n[0]);else if(typeof n[0]=="string"){let u=n.slice(1);u.length===1&&(u=u[0]),c=`${a} - ${n[0]} ${u}`,r(`${a} - ${n[0]}`,u)}else c=`${a} ${n}`,r(a,n);for(const u of this._pluggables){const d={message:c,timestamp:Date.now()};u.pushLogs([d])}}log(...t){this._log(ie.INFO,...t)}info(...t){this._log(ie.INFO,...t)}warn(...t){this._log(ie.WARN,...t)}error(...t){this._log(ie.ERROR,...t)}debug(...t){this._log(ie.DEBUG,...t)}verbose(...t){this._log(ie.VERBOSE,...t)}addPluggable(t){t&&t.getCategoryName()===Xr&&(this._pluggables.push(t),t.configure(this._config))}listPluggables(){return this._pluggables}}Y.LOG_LEVEL=null;Y.BIND_ALL_LOG_LEVELS=!1;class ee extends Error{constructor({message:t,name:n,recoverySuggestion:i,underlyingError:o,metadata:s}){if(super(t),this.name=n,this.underlyingError=o,this.recoverySuggestion=i,s){const{extendedRequestId:r,httpStatusCode:a,requestId:c}=s;this.metadata={extendedRequestId:r,httpStatusCode:a,requestId:c}}this.constructor=ee,Object.setPrototypeOf(this,ee.prototype)}}var $e;(function(e){e.NoEndpointId="NoEndpointId",e.PlatformNotSupported="PlatformNotSupported",e.Unknown="Unknown",e.NetworkError="NetworkError"})($e||($e={}));const ci=(e,t=ee)=>(n,i,o)=>{const{message:s,recoverySuggestion:r}=e[i];if(!n)throw new t({name:i,message:o?`${s} ${o}`:s,recoverySuggestion:r})},qe=typeof Symbol<"u"?Symbol("amplify_default"):"@@amplify_default",It=new Y("Hub");class Cs{constructor(t){this.listeners=new Map,this.protectedChannels=["core","auth","api","analytics","interactions","pubsub","storage","ui","xr"],this.name=t}_remove(t,n){const i=this.listeners.get(t);if(!i){It.warn(`No listeners for ${t}`);return}this.listeners.set(t,[...i.filter(({callback:o})=>o!==n)])}dispatch(t,n,i,o){typeof t=="string"&&this.protectedChannels.indexOf(t)>-1&&(o===qe||It.warn(`WARNING: ${t} is protected and dispatching on it can have unintended consequences`));const s={channel:t,payload:{...n},source:i,patternInfo:[]};try{this._toListeners(s)}catch(r){It.error(r)}}listen(t,n,i="noname"){let o;if(typeof n!="function")throw new ee({name:ea,message:"No callback supplied to Hub"});o=n;let s=this.listeners.get(t);return s||(s=[],this.listeners.set(t,s)),s.push({name:i,callback:o}),()=>{this._remove(t,o)}}_toListeners(t){const{channel:n,payload:i}=t,o=this.listeners.get(n);o&&o.forEach(s=>{It.debug(`Dispatching to ${n} with `,i);try{s.callback(t)}catch(r){It.error(r)}})}}const He=new Cs("__default__"),dn=new Cs("internal-hub"),ta=()=>{if(typeof window=="object"&&typeof window.crypto=="object")return window.crypto;if(typeof crypto=="object")return crypto;throw new ee({name:"MissingPolyfill",message:"Cannot resolve the `crypto` function from the environment."})},na=()=>{if(typeof window<"u"&&typeof window.btoa=="function")return window.btoa;if(typeof btoa=="function")return btoa;throw new ee({name:"Base64EncoderError",message:"Cannot resolve the `btoa` function from the environment."})},ia=()=>{if(typeof window<"u"&&typeof window.atob=="function")return window.atob;if(typeof atob=="function")return atob;throw new ee({name:"Base64EncoderError",message:"Cannot resolve the `atob` function from the environment."})},ui={convert(e,t){let n=e;return t!=null&&t.urlSafe&&(n=n.replace(/-/g,"+").replace(/_/g,"/")),ia()(n)}};var ve;(function(e){e.AuthTokenConfigException="AuthTokenConfigException",e.AuthUserPoolAndIdentityPoolException="AuthUserPoolAndIdentityPoolException",e.AuthUserPoolException="AuthUserPoolException",e.InvalidIdentityPoolIdException="InvalidIdentityPoolIdException",e.OAuthNotConfigureException="OAuthNotConfigureException"})(ve||(ve={}));const oa={[ve.AuthTokenConfigException]:{message:"Auth Token Provider not configured.",recoverySuggestion:"Make sure to call Amplify.configure in your app."},[ve.AuthUserPoolAndIdentityPoolException]:{message:"Auth UserPool or IdentityPool not configured.",recoverySuggestion:"Make sure to call Amplify.configure in your app with UserPoolId and IdentityPoolId."},[ve.AuthUserPoolException]:{message:"Auth UserPool not configured.",recoverySuggestion:"Make sure to call Amplify.configure in your app with userPoolId and userPoolClientId."},[ve.InvalidIdentityPoolIdException]:{message:"Invalid identity pool id provided.",recoverySuggestion:"Make sure a valid identityPoolId is given in the config."},[ve.OAuthNotConfigureException]:{message:"oauth param not configured.",recoverySuggestion:"Make sure to call Amplify.configure with oauth parameter in your app."}},di=ci(oa);function F(e){let t=!0;e?t=!!e.userPoolId&&!!e.userPoolClientId:t=!1,di(t,ve.AuthUserPoolException)}function Rs(e){var n,i,o,s,r,a,c,u;const t=!!((i=(n=e==null?void 0:e.loginWith)==null?void 0:n.oauth)!=null&&i.domain)&&!!((s=(o=e==null?void 0:e.loginWith)==null?void 0:o.oauth)!=null&&s.redirectSignOut)&&!!((a=(r=e==null?void 0:e.loginWith)==null?void 0:r.oauth)!=null&&a.redirectSignIn)&&!!((u=(c=e==null?void 0:e.loginWith)==null?void 0:c.oauth)!=null&&u.responseType);di(t,ve.OAuthNotConfigureException)}function Jt(e){const t=!!(e!=null&&e.identityPoolId);di(t,ve.InvalidIdentityPoolIdException)}function We(e){const t=e.split(".");if(t.length!==3)throw new Error("Invalid token");try{const i=t[1].replace(/-/g,"+").replace(/_/g,"/"),o=decodeURIComponent(ui.convert(i).split("").map(r=>`%${`00${r.charCodeAt(0).toString(16)}`.slice(-2)}`).join("")),s=JSON.parse(o);return{toString:()=>e,payload:s}}catch{throw new Error("Invalid token payload")}}const _s=e=>e&&e["nonRetryable"],jt=new Y("retryUtil");async function sa(e,t,n,i){if(typeof e!="function")throw Error("functionToRetry must be a function");return new Promise(async(o,s)=>{let r=0,a=!1,c=()=>{},u;for(;!a;){r++,jt.debug(`${e.name} attempt #${r} with this vars: ${JSON.stringify(t)}`);try{o(await e(...t));return}catch(d){if(u=d,jt.debug(`error on ${e.name}`,d),_s(d)){jt.debug(`${e.name} non retryable error`,d),s(d);return}const l=n(r,t,d);if(jt.debug(`${e.name} retrying in ${l} ms`),l===!1||a){s(d);return}else await new Promise(p=>{c=p,setTimeout(c,l)})}}s(u)})}const bs=e=>{const t=Reflect.ownKeys(e);for(const n of t){const i=e[n];(i&&typeof i=="object"||typeof i=="function")&&bs(i)}return Object.freeze(e)},ra=new Y("parseAWSExports"),aa={API_KEY:"apiKey",AWS_IAM:"iam",AMAZON_COGNITO_USER_POOLS:"userPool",OPENID_CONNECT:"oidc",NONE:"none",AWS_LAMBDA:"lambda",LAMBDA:"lambda"},ca=(e={})=>{var Mi,Fi,Li,Ui,Ki,Bi;if(!Object.prototype.hasOwnProperty.call(e,"aws_project_region"))throw new ee({name:"InvalidParameterException",message:"Invalid config parameter.",recoverySuggestion:"Ensure passing the config object imported from  `amplifyconfiguration.json`."});const{aws_appsync_apiKey:t,aws_appsync_authenticationType:n,aws_appsync_graphqlEndpoint:i,aws_appsync_region:o,aws_bots_config:s,aws_cognito_identity_pool_id:r,aws_cognito_sign_up_verification_method:a,aws_cognito_mfa_configuration:c,aws_cognito_mfa_types:u,aws_cognito_password_protection_settings:d,aws_cognito_verification_mechanisms:l,aws_cognito_signup_attributes:p,aws_cognito_social_providers:h,aws_cognito_username_attributes:f,aws_mandatory_sign_in:E,aws_mobile_analytics_app_id:g,aws_mobile_analytics_app_region:y,aws_user_files_s3_bucket:I,aws_user_files_s3_bucket_region:T,aws_user_files_s3_dangerously_connect_to_http_endpoint_for_testing:v,aws_user_pools_id:S,aws_user_pools_web_client_id:A,geo:O,oauth:D,predictions:k,aws_cloud_logic_custom:K,Notifications:q,modelIntrospection:P}=e,_={};g&&(_.Analytics={Pinpoint:{appId:g,region:y}});const{InAppMessaging:L,Push:z}=q??{};if(L!=null&&L.AWSPinpoint||z!=null&&z.AWSPinpoint){if(L!=null&&L.AWSPinpoint){const{appId:W,region:ze}=L.AWSPinpoint;_.Notifications={InAppMessaging:{Pinpoint:{appId:W,region:ze}}}}if(z!=null&&z.AWSPinpoint){const{appId:W,region:ze}=z.AWSPinpoint;_.Notifications={..._.Notifications,PushNotification:{Pinpoint:{appId:W,region:ze}}}}}if(Array.isArray(s)&&(_.Interactions={LexV1:Object.fromEntries(s.map(W=>[W.name,W]))}),i){const W=aa[n];W||ra.debug(`Invalid authentication type ${n}. Falling back to IAM.`),_.API={GraphQL:{endpoint:i,apiKey:t,region:o,defaultAuthMode:W??"iam"}},P&&(_.API.GraphQL.modelIntrospection=P)}const re=c?{status:c&&c.toLowerCase(),totpEnabled:(u==null?void 0:u.includes("TOTP"))??!1,smsEnabled:(u==null?void 0:u.includes("SMS"))??!1}:void 0,x=d?{minLength:d.passwordPolicyMinLength,requireLowercase:((Mi=d.passwordPolicyCharacters)==null?void 0:Mi.includes("REQUIRES_LOWERCASE"))??!1,requireUppercase:((Fi=d.passwordPolicyCharacters)==null?void 0:Fi.includes("REQUIRES_UPPERCASE"))??!1,requireNumbers:((Li=d.passwordPolicyCharacters)==null?void 0:Li.includes("REQUIRES_NUMBERS"))??!1,requireSpecialCharacters:((Ui=d.passwordPolicyCharacters)==null?void 0:Ui.includes("REQUIRES_SYMBOLS"))??!1}:void 0,M=Array.from(new Set([...l??[],...p??[]])).reduce((W,ze)=>({...W,[ze.toLowerCase()]:{required:!0}}),{}),U=(f==null?void 0:f.includes("EMAIL"))??!1,Le=(f==null?void 0:f.includes("PHONE_NUMBER"))??!1;(r||S)&&(_.Auth={Cognito:{identityPoolId:r,allowGuestAccess:E!=="enable",signUpVerificationMethod:a,userAttributes:M,userPoolClientId:A,userPoolId:S,mfa:re,passwordFormat:x,loginWith:{username:!(U||Le),email:U,phone:Le}}});const St=D?Object.keys(D).length>0:!1,kn=h?h.length>0:!1;if(_.Auth&&St&&(_.Auth.Cognito.loginWith={..._.Auth.Cognito.loginWith,oauth:{...ua(D),...kn&&{providers:da(h)}}}),I&&(_.Storage={S3:{bucket:I,region:T,dangerouslyConnectToHttpEndpointForTesting:v}}),O){const{amazon_location_service:W}=O;_.Geo={LocationService:{maps:W.maps,geofenceCollections:W.geofenceCollections,searchIndices:W.search_indices,region:W.region}}}if(K&&(_.API={..._.API,REST:K.reduce((W,ze)=>{const{name:Wr,endpoint:jr,region:Vi,service:$i}=ze;return{...W,[Wr]:{endpoint:jr,...$i?{service:$i}:void 0,...Vi?{region:Vi}:void 0}}},{})}),k){const{VoiceId:W}=((Bi=(Ki=k==null?void 0:k.convert)==null?void 0:Ki.speechGenerator)==null?void 0:Bi.defaults)??{};_.Predictions=W?{...k,convert:{...k.convert,speechGenerator:{...k.convert.speechGenerator,defaults:{voiceId:W}}}}:k}return _},Hi=e=>(e==null?void 0:e.split(","))??[],ua=({domain:e,scope:t,redirectSignIn:n,redirectSignOut:i,responseType:o})=>({domain:e,scopes:t,redirectSignIn:Hi(n),redirectSignOut:Hi(i),responseType:o}),da=e=>e.map(t=>{const n=t.toLowerCase();return n.charAt(0).toUpperCase()+n.slice(1)}),la=Symbol("oauth-listener");function pa(e){const{version:t}=e;return t?t.startsWith("1"):!1}function ha(e){if(!e)return;const{bucket_name:t,aws_region:n,buckets:i}=e;return{S3:{bucket:t,region:n,buckets:i&&Na(i)}}}function fa(e){if(!e)return;const{user_pool_id:t,user_pool_client_id:n,identity_pool_id:i,password_policy:o,mfa_configuration:s,mfa_methods:r,unauthenticated_identities_enabled:a,oauth:c,username_attributes:u,standard_required_attributes:d,groups:l}=e,p={Cognito:{userPoolId:t,userPoolClientId:n,groups:l}};return i&&(p.Cognito={...p.Cognito,identityPoolId:i}),o&&(p.Cognito.passwordFormat={requireLowercase:o.require_lowercase,requireNumbers:o.require_numbers,requireUppercase:o.require_uppercase,requireSpecialCharacters:o.require_symbols,minLength:o.min_length??6}),s&&(p.Cognito.mfa={status:wa(s),smsEnabled:r==null?void 0:r.includes("SMS"),totpEnabled:r==null?void 0:r.includes("TOTP")}),a&&(p.Cognito.allowGuestAccess=a),c&&(p.Cognito.loginWith={oauth:{domain:c.domain,redirectSignIn:c.redirect_sign_in_uri,redirectSignOut:c.redirect_sign_out_uri,responseType:c.response_type==="token"?"token":"code",scopes:c.scopes,providers:Ta(c.identity_providers)}}),u&&(p.Cognito.loginWith={...p.Cognito.loginWith,email:u.includes("email"),phone:u.includes("phone_number"),username:u.includes("username")}),d&&(p.Cognito.userAttributes=d.reduce((h,f)=>({...h,[f]:{required:!0}}),{})),p}function ma(e){if(!(e!=null&&e.amazon_pinpoint))return;const{amazon_pinpoint:t}=e;return{Pinpoint:{appId:t.app_id,region:t.aws_region}}}function Ea(e){if(!e)return;const{aws_region:t,geofence_collections:n,maps:i,search_indices:o}=e;return{LocationService:{region:t,searchIndices:o,geofenceCollections:n,maps:i}}}function ga(e){if(!e)return;const{aws_region:t,default_authorization_type:n,url:i,api_key:o,model_introspection:s}=e;return{GraphQL:{endpoint:i,defaultAuthMode:xs(n),region:t,apiKey:o,modelIntrospection:s}}}function ya(e){if(!(e!=null&&e.events))return;const{url:t,aws_region:n,api_key:i,default_authorization_type:o}=e.events;return{Events:{endpoint:t,defaultAuthMode:xs(o),region:n,apiKey:i}}}function Sa(e){if(!e)return;const{aws_region:t,channels:n,amazon_pinpoint_app_id:i}=e,o=n.includes("IN_APP_MESSAGING"),s=n.includes("APNS")||n.includes("FCM");if(!(o||s))return;const r={};return o&&(r.InAppMessaging={Pinpoint:{appId:i,region:t}}),s&&(r.PushNotification={Pinpoint:{appId:i,region:t}}),r}function Ia(e){const t={};if(e.storage&&(t.Storage=ha(e.storage)),e.auth&&(t.Auth=fa(e.auth)),e.analytics&&(t.Analytics=ma(e.analytics)),e.geo&&(t.Geo=Ea(e.geo)),e.data&&(t.API=ga(e.data)),e.custom){const n=ya(e.custom);n&&"Events"in n&&(t.API={...t.API,...n})}return e.notifications&&(t.Notifications=Sa(e.notifications)),t}const va={AMAZON_COGNITO_USER_POOLS:"userPool",API_KEY:"apiKey",AWS_IAM:"iam",AWS_LAMBDA:"lambda",OPENID_CONNECT:"oidc"};function xs(e){return va[e]}const Wi={GOOGLE:"Google",LOGIN_WITH_AMAZON:"Amazon",FACEBOOK:"Facebook",SIGN_IN_WITH_APPLE:"Apple"};function Ta(e=[]){return e.reduce((t,n)=>(Wi[n]!==void 0&&t.push(Wi[n]),t),[])}function wa(e){return e==="OPTIONAL"?"optional":e==="REQUIRED"?"on":"off"}function Na(e){const t={};return e.forEach(({name:n,bucket_name:i,aws_region:o,paths:s})=>{if(n in t)throw new Error(`Duplicate friendly name found: ${n}. Name must be unique.`);const r=s?Object.entries(s).reduce((a,[c,u])=>(u!==void 0&&(a[c]=u),a),{}):void 0;t[n]={bucketName:i,region:o,paths:r}}),t}const Os=e=>Object.keys(e).some(t=>t.startsWith("aws_"))?ca(e):pa(e)?Ia(e):e;var G;(function(e){e.WebUnknown="0",e.React="1",e.NextJs="2",e.Angular="3",e.VueJs="4",e.Nuxt="5",e.Svelte="6",e.ServerSideUnknown="100",e.ReactSSR="101",e.NextJsSSR="102",e.AngularSSR="103",e.VueJsSSR="104",e.NuxtSSR="105",e.SvelteSSR="106",e.ReactNative="201",e.Expo="202"})(G||(G={}));var ln;(function(e){e.AI="ai",e.API="api",e.Auth="auth",e.Analytics="analytics",e.DataStore="datastore",e.Geo="geo",e.InAppMessaging="inappmessaging",e.Interactions="interactions",e.Predictions="predictions",e.PubSub="pubsub",e.PushNotification="pushnotification",e.Storage="storage"})(ln||(ln={}));var ji;(function(e){e.CreateConversation="1",e.GetConversation="2",e.ListConversations="3",e.DeleteConversation="4",e.SendMessage="5",e.ListMessages="6",e.OnMessage="7",e.Generation="8",e.UpdateConversation="9"})(ji||(ji={}));var Gi;(function(e){e.Record="1",e.IdentifyUser="2"})(Gi||(Gi={}));var qn;(function(e){e.GraphQl="1",e.Get="2",e.Post="3",e.Put="4",e.Patch="5",e.Del="6",e.Head="7"})(qn||(qn={}));var se;(function(e){e.SignUp="1",e.ConfirmSignUp="2",e.ResendSignUpCode="3",e.SignIn="4",e.FetchMFAPreference="6",e.UpdateMFAPreference="7",e.SetUpTOTP="10",e.VerifyTOTPSetup="11",e.ConfirmSignIn="12",e.DeleteUserAttributes="15",e.DeleteUser="16",e.UpdateUserAttributes="17",e.FetchUserAttributes="18",e.ConfirmUserAttribute="22",e.SignOut="26",e.UpdatePassword="27",e.ResetPassword="28",e.ConfirmResetPassword="29",e.FederatedSignIn="30",e.RememberDevice="32",e.ForgetDevice="33",e.FetchDevices="34",e.SendUserAttributeVerificationCode="35",e.SignInWithRedirect="36",e.StartWebAuthnRegistration="37",e.CompleteWebAuthnRegistration="38",e.ListWebAuthnCredentials="39",e.DeleteWebAuthnCredential="40"})(se||(se={}));var zi;(function(e){e.Subscribe="1",e.GraphQl="2"})(zi||(zi={}));var Qi;(function(e){e.SearchByText="0",e.SearchByCoordinates="1",e.SearchForSuggestions="2",e.SearchByPlaceId="3",e.SaveGeofences="4",e.GetGeofence="5",e.ListGeofences="6",e.DeleteGeofences="7"})(Qi||(Qi={}));var Yi;(function(e){e.SyncMessages="1",e.IdentifyUser="2",e.NotifyMessageInteraction="3"})(Yi||(Yi={}));var Ji;(function(e){e.None="0"})(Ji||(Ji={}));var Xi;(function(e){e.Convert="1",e.Identify="2",e.Interpret="3"})(Xi||(Xi={}));var Zi;(function(e){e.Subscribe="1"})(Zi||(Zi={}));var eo;(function(e){e.InitializePushNotifications="1",e.IdentifyUser="2"})(eo||(eo={}));var to;(function(e){e.UploadData="1",e.DownloadData="2",e.List="3",e.Copy="4",e.Remove="5",e.GetProperties="6",e.GetUrl="7",e.GetDataAccess="8",e.ListCallerAccessGrants="9"})(to||(to={}));const Aa="6.15.1",In=()=>typeof global<"u",at=()=>typeof window<"u",Ps=()=>typeof document<"u",li=()=>typeof process<"u",Pt=(e,t)=>!!Object.keys(e).find(n=>n.startsWith(t));var no={};function Ca(){const e=i=>i.startsWith("_react")||i.startsWith("__react"),t=i=>Object.keys(i).find(e),n=()=>Array.from(document.querySelectorAll("[id]"));return Ps()&&n().some(t)}function Ra(){return li()&&typeof no<"u"&&!!Object.keys(no).find(e=>e.includes("react"))}function _a(){return at()&&Pt(window,"__VUE")}function ba(){return In()&&Pt(global,"__VUE")}var io={};function xa(){return at()&&Pt(window,"__SVELTE")}function Oa(){return li()&&typeof io<"u"&&!!Object.keys(io).find(e=>e.includes("svelte"))}function Pa(){return at()&&window.next&&typeof window.next=="object"}function Da(){return In()&&(Pt(global,"__next")||Pt(global,"__NEXT"))}function ka(){return at()&&(window.__NUXT__!==void 0||window.$nuxt!==void 0)}function Ma(){return In()&&typeof global.__NUXT_PATHS__<"u"}var oo={};function Fa(){const e=!!(Ps()&&document.querySelector("[ng-version]")),t=!!(at()&&typeof window.ng<"u");return e||t}function La(){var e;return li()&&typeof oo=="object"&&((e=oo.npm_lifecycle_script)==null?void 0:e.startsWith("ng "))||!1}function Ua(){return typeof navigator<"u"&&typeof navigator.product<"u"&&navigator.product==="ReactNative"}function Ka(){return In()&&typeof global.expo<"u"}function Ba(){return at()}const Va=[{platform:G.Expo,detectionMethod:Ka},{platform:G.ReactNative,detectionMethod:Ua},{platform:G.NextJs,detectionMethod:Pa},{platform:G.Nuxt,detectionMethod:ka},{platform:G.Angular,detectionMethod:Fa},{platform:G.React,detectionMethod:Ca},{platform:G.VueJs,detectionMethod:_a},{platform:G.Svelte,detectionMethod:xa},{platform:G.WebUnknown,detectionMethod:Ba},{platform:G.NextJsSSR,detectionMethod:Da},{platform:G.NuxtSSR,detectionMethod:Ma},{platform:G.ReactSSR,detectionMethod:Ra},{platform:G.VueJsSSR,detectionMethod:ba},{platform:G.AngularSSR,detectionMethod:La},{platform:G.SvelteSSR,detectionMethod:Oa}];function $a(){var e;return((e=Va.find(t=>t.detectionMethod()))==null?void 0:e.platform)||G.ServerSideUnknown}let _t;const Mn=[];let Hn=!1;const qa=10,Ha=10,Wa=1e3,Ds=()=>{var e;if(!_t){if(_t=$a(),Hn)for(;Mn.length;)(e=Mn.pop())==null||e();else Mn.forEach(t=>{t()});so(G.ServerSideUnknown,qa),so(G.WebUnknown,Ha)}return _t};function ja(){_t=void 0}function so(e,t){_t===e&&!Hn&&setTimeout(()=>{ja(),Hn=!0,setTimeout(Ds,Wa)},t)}const Ga={},za=(e,t)=>{var n,i;return(i=(n=Ga[e])==null?void 0:n[t])==null?void 0:i.additionalDetails},Qa="aws-amplify",Ya=e=>e.replace(/\+.*/,""),Ja=({category:e,action:t}={})=>{const n=[[Qa,Ya(Aa)]];if(e&&n.push([e,t]),n.push(["framework",Ds()]),e&&t){const i=za(e,t);i&&i.forEach(o=>{n.push(o)})}return n},ct=e=>Ja(e).map(([i,o])=>i&&o?`${i}/${o}`:i).join(" "),Xa=()=>{if(typeof self>"u")return!1;const e=self;return typeof e.WorkerGlobalScope<"u"&&self instanceof e.WorkerGlobalScope};class et{networkMonitor(t){const n=Xa()?self:typeof window<"u"&&window;return n?new xt(i=>{i.next({online:n.navigator.onLine});const o=()=>{i.next({online:!0})},s=()=>{i.next({online:!1})};return n.addEventListener("online",o),n.addEventListener("offline",s),et._observers.push(i),()=>{n.removeEventListener("online",o),n.removeEventListener("offline",s),et._observers=et._observers.filter(r=>r!==i)}}):Gr([{online:!0}])}static _observerOverride(t){for(const n of this._observers){if(n.closed){this._observers=this._observers.filter(i=>i!==n);continue}n!=null&&n.next&&n.next(t)}}}et._observers=[];const ks=()=>typeof window<"u"&&typeof window.document<"u",ro=new Y("Auth");class Za{configure(t,n){var i,o;this.authConfig=t,this.authOptions=n,t&&((i=t.Cognito)!=null&&i.userPoolEndpoint)&&ro.warn(ao("Amazon Cognito User Pool")),t&&((o=t.Cognito)!=null&&o.identityPoolEndpoint)&&ro.warn(ao("Amazon Cognito Identity Pool"))}async fetchAuthSession(t={}){var s,r,a,c,u,d;let n,i;const o=await this.getTokens(t);return o?(i=(r=(s=o.accessToken)==null?void 0:s.payload)==null?void 0:r.sub,n=await((c=(a=this.authOptions)==null?void 0:a.credentialsProvider)==null?void 0:c.getCredentialsAndIdentityId({authConfig:this.authConfig,tokens:o,authenticated:!0,forceRefresh:t.forceRefresh}))):n=await((d=(u=this.authOptions)==null?void 0:u.credentialsProvider)==null?void 0:d.getCredentialsAndIdentityId({authConfig:this.authConfig,authenticated:!1,forceRefresh:t.forceRefresh})),{tokens:o,credentials:n==null?void 0:n.credentials,identityId:n==null?void 0:n.identityId,userSub:i}}async clearCredentials(){var t,n;await((n=(t=this.authOptions)==null?void 0:t.credentialsProvider)==null?void 0:n.clearCredentialsAndIdentityId())}async getTokens(t){var n,i;return await((i=(n=this.authOptions)==null?void 0:n.tokenProvider)==null?void 0:i.getTokens(t))??void 0}}const ao=e=>`You are using a custom Amazon ${e} endpoint, ensure the endpoint is correct.`;class ec{constructor(){this.oAuthListener=void 0,this.resourcesConfig={},this.libraryOptions={},this.Auth=new Za}configure(t,n){const i=Os(t);this.resourcesConfig=i,n&&(this.libraryOptions=n),this.resourcesConfig=bs(this.resourcesConfig),this.Auth.configure(this.resourcesConfig.Auth,this.libraryOptions.Auth),He.dispatch("core",{event:"configure",data:this.resourcesConfig},"Configure",qe),this.notifyOAuthListener()}getConfig(){return this.resourcesConfig}[la](t){var n,i,o;(i=(n=this.resourcesConfig.Auth)==null?void 0:n.Cognito.loginWith)!=null&&i.oauth?t((o=this.resourcesConfig.Auth)==null?void 0:o.Cognito):this.oAuthListener=t}notifyOAuthListener(){var t,n,i;!((n=(t=this.resourcesConfig.Auth)==null?void 0:t.Cognito.loginWith)!=null&&n.oauth)||!this.oAuthListener||(this.oAuthListener((i=this.resourcesConfig.Auth)==null?void 0:i.Cognito),this.oAuthListener=void 0)}}const V=new ec,tc=(e,t)=>e.Auth.fetchAuthSession(t),pi=e=>tc(V,e);function Ms(){return V.Auth.clearCredentials()}const vn=e=>{const{headers:t,statusCode:n}=e;return{...nc(e)?e.$metadata:{},httpStatusCode:n,requestId:t["x-amzn-requestid"]??t["x-amzn-request-id"]??t["x-amz-request-id"],extendedRequestId:t["x-amz-id-2"],cfId:t["x-amz-cf-id"]}},nc=e=>typeof(e==null?void 0:e.$metadata)=="object",Je=async e=>{if(!e||e.statusCode<300)return;const t=await Lt(e),i=(r=>{const[a]=r.toString().split(/[,:]+/);return a.includes("#")?a.split("#")[1]:a})(e.headers["x-amzn-errortype"]??t.code??t.__type??"UnknownError"),o=t.message??t.Message??"Unknown error",s=new Error(o);return Object.assign(s,{name:i,$metadata:vn(e)})},Lt=async e=>{if(!e.body)throw new Error("Missing response payload");const t=await e.body.json();return Object.assign(t,{$metadata:vn(e)})},ge=(e,t,n,i)=>async(o,s)=>{const r={...i,...o},a=await r.endpointResolver(r,s),c=await t(s,a),u=await e(c,{...r});return n(u)},Fs=5*60*1e3;function Ls(e=Fs){return i=>{const o=2**i*100+100*Math.random();return o>e?!1:o}}const Us=3,co="amz-sdk-invocation-id",ic="amz-sdk-request",uo=5*60*1e3,hi=e=>{const n=Ls(uo)(e);return n===!1?uo:n},oc=["AuthFailure","InvalidSignatureException","RequestExpired","RequestInTheFuture","RequestTimeTooSkewed","SignatureDoesNotMatch","BadRequestException"],sc=e=>!!e&&oc.includes(e),fi=e=>async(t,n)=>{const i=n??await e(t)??void 0,o=(i==null?void 0:i.code)||(i==null?void 0:i.name),s=t==null?void 0:t.statusCode;return{retryable:uc(n)||cc(s,o)||sc(o)||dc(s,o)}},rc=["BandwidthLimitExceeded","EC2ThrottledException","LimitExceededException","PriorRequestNotComplete","ProvisionedThroughputExceededException","RequestLimitExceeded","RequestThrottled","RequestThrottledException","SlowDown","ThrottledException","Throttling","ThrottlingException","TooManyRequestsException"],ac=["TimeoutError","RequestTimeout","RequestTimeoutException"],cc=(e,t)=>e===429||!!t&&rc.includes(t),uc=e=>[$e.NetworkError,"ERR_NETWORK"].includes(e==null?void 0:e.name),dc=(e,t)=>!!e&&[500,502,503,504].includes(e)||!!t&&ac.includes(t),Ks="cognito-identity",Bs={service:Ks,retryDecider:fi(Je),computeDelay:hi,cache:"no-store"},mi=({maxAttempts:e=Us,retryDecider:t,computeDelay:n,abortSignal:i})=>{if(e<1)throw new Error("maxAttempts must be greater than 0");return(o,s)=>async function(a){let c,u=s.attemptsCount??0,d;const l=()=>{if(d)return lo(d,u),d;throw lo(c,u),c};for(;!(i!=null&&i.aborted)&&u<e;){try{d=await o(a),c=void 0}catch(f){c=f,d=void 0}u=(s.attemptsCount??0)>u?s.attemptsCount??0:u+1,s.attemptsCount=u;const{isCredentialsExpiredError:p,retryable:h}=await t(d,c,s);if(h){if(s.isCredentialsExpired=!!p,!(i!=null&&i.aborted)&&u<e){const f=n(u);await lc(f,i)}continue}else return l()}if(i!=null&&i.aborted)throw new Error("Request aborted.");return l()}},lc=(e,t)=>{if(t!=null&&t.aborted)return Promise.resolve();let n,i;const o=new Promise(s=>{i=s,n=setTimeout(s,e)});return t==null||t.addEventListener("abort",function s(r){clearTimeout(n),t==null||t.removeEventListener("abort",s),i()}),o},lo=(e,t)=>{Object.prototype.toString.call(e)==="[object Object]"&&(e.$metadata={...e.$metadata??{},attempts:t})},Wn=zr,pc=()=>e=>async function(n){return n.headers[co]||(n.headers[co]=Wn()),e(n)},hc=({maxAttempts:e=Us})=>(t,n)=>async function(o){const s=n.attemptsCount??0;return o.headers[ic]=`attempt=${s+1}; max=${e}`,t(o)},Ei=({userAgentHeader:e="x-amz-user-agent",userAgentValue:t=""})=>n=>async function(o){if(t.trim().length===0)return await n(o);{const s=e.toLowerCase();return o.headers[s]=o.headers[s]?`${o.headers[s]} ${t}`:t,await n(o)}},Ut=(e,t)=>(n,i)=>{const o={};let s=r=>e(r,i);for(let r=t.length-1;r>=0;r--){const a=t[r];s=a(i)(s,o)}return s(n)},Fn=e=>{let t;return()=>(t||(t=e()),t)},fc=e=>!["HEAD","GET","DELETE"].includes(e.toUpperCase()),gi=async({url:e,method:t,headers:n,body:i},{abortSignal:o,cache:s,withCrossDomainCredentials:r})=>{var l;let a;try{a=await fetch(e,{method:t,headers:n,body:fc(t)?i:void 0,signal:o,cache:s,credentials:r?"include":"same-origin"})}catch(p){throw p instanceof TypeError?new ee({name:$e.NetworkError,message:"A network error has occurred.",underlyingError:p}):p}const c={};(l=a.headers)==null||l.forEach((p,h)=>{c[h.toLowerCase()]=p});const u={statusCode:a.status,headers:c,body:null},d=Object.assign(a.body??{},{text:Fn(()=>a.text()),blob:Fn(()=>a.blob()),json:Fn(()=>a.json())});return{...u,body:d}},Vs=Ut(gi,[Ei,pc,mi,hc]),mc=()=>e=>async function(n){return n.headers["cache-control"]="no-store",e(n)},$s=Ut(Vs,[mc]),qs=e=>(t,n)=>{const i=Ec(e),o=JSON.stringify(t);return gc(n,i,o)},Ec=e=>({"content-type":"application/x-amz-json-1.1","x-amz-target":`AWSCognitoIdentityService.${e}`}),gc=({url:e},t,n)=>({headers:t,url:e,body:n,method:"POST"}),po=e=>ge($s,qs("GetCredentialsForIdentity"),yc,{...Bs,...e,userAgentValue:ct()}),yc=async e=>{if(e.statusCode>=300)throw await Je(e);const t=await Lt(e);return{IdentityId:t.IdentityId,Credentials:Sc(t.Credentials),$metadata:vn(e)}},Sc=({Expiration:e,...t}={})=>({...t,Expiration:e&&new Date(e*1e3)}),Ic=e=>ge($s,qs("GetId"),vc,{...Bs,...e,userAgentValue:ct()}),vc=async e=>{if(e.statusCode>=300)throw await Je(e);return{IdentityId:(await Lt(e)).IdentityId,$metadata:vn(e)}},Hs={id:"aws",outputs:{dnsSuffix:"amazonaws.com"},regionRegex:"^(us|eu|ap|sa|ca|me|af)\\-\\w+\\-\\d+$",regions:["aws-global"]},Tc={partitions:[Hs,{id:"aws-cn",outputs:{dnsSuffix:"amazonaws.com.cn"},regionRegex:"^cn\\-\\w+\\-\\d+$",regions:["aws-cn-global"]}]},Ws=e=>{const{partitions:t}=Tc;for(const{regions:n,outputs:i,regionRegex:o}of t){const s=new RegExp(o);if(n.includes(e)||s.test(e))return i.dnsSuffix}return Hs.outputs.dnsSuffix},we=URL,js=URLSearchParams,wc=({region:e})=>({url:new we(`https://${Ks}.${e}.${Ws(e)}`)});class Nt extends ee{constructor(){super({name:$e.PlatformNotSupported,message:"Function not supported on current platform"})}}class Gs{constructor(t){this.storage=t}async setItem(t,n){if(!this.storage)throw new Nt;this.storage.setItem(t,n)}async getItem(t){if(!this.storage)throw new Nt;return this.storage.getItem(t)}async removeItem(t){if(!this.storage)throw new Nt;this.storage.removeItem(t)}async clear(){if(!this.storage)throw new Nt;this.storage.clear()}}class zs{constructor(){this.storage=new Map}get length(){return this.storage.size}key(t){return t>this.length-1?null:Array.from(this.storage.keys())[t]}setItem(t,n){this.storage.set(t,n)}getItem(t){return this.storage.get(t)??null}removeItem(t){this.storage.delete(t)}clear(){this.storage.clear()}}const Qs=new Y("CoreStorageUtils"),Nc=()=>{try{if(typeof window<"u"&&window.localStorage)return window.localStorage}catch{Qs.info("localStorage not found. InMemoryStorage is used as a fallback.")}return new zs},Ys=()=>{try{if(typeof window<"u"&&window.sessionStorage)return window.sessionStorage.getItem("test"),window.sessionStorage;throw new Error("sessionStorage is not defined")}catch{return Qs.info("sessionStorage not found. InMemoryStorage is used as a fallback."),new zs}};class Ac extends Gs{constructor(){super(Nc())}}class Cc extends Gs{constructor(){super(Ys())}}class Rc{constructor(t){this._storage=t}get storage(){if(!this._storage)throw new Nt;return this._storage}setItem(t,n){this.storage.setItem(t,n)}getItem(t){return this.storage.getItem(t)}removeItem(t){this.storage.removeItem(t)}clear(){this.storage.clear()}}class _c extends Rc{constructor(){super(Ys())}}class bc{constructor(t={}){const{path:n,domain:i,expires:o,sameSite:s,secure:r}=t;if(this.domain=i,this.path=n||"/",this.expires=Object.prototype.hasOwnProperty.call(t,"expires")?o:365,this.secure=Object.prototype.hasOwnProperty.call(t,"secure")?r:!0,Object.prototype.hasOwnProperty.call(t,"sameSite")){if(!s||!["strict","lax","none"].includes(s))throw new Error('The sameSite value of cookieStorage must be "lax", "strict" or "none".');if(s==="none"&&!this.secure)throw new Error("sameSite = None requires the Secure attribute in latest browser versions.");this.sameSite=s}}async setItem(t,n){Wt.set(t,n,this.getData())}async getItem(t){return Wt.get(t)??null}async removeItem(t){Wt.remove(t,this.getData())}async clear(){const t=Wt.get(),n=Object.keys(t).map(i=>this.removeItem(i));await Promise.all(n)}getData(){return{path:this.path,expires:this.expires,domain:this.domain,secure:this.secure,...this.sameSite&&{sameSite:this.sameSite}}}}const Kt=new Ac;new Cc;const Re=new _c,Js=e=>Object.keys(e).map(t=>t.toLowerCase()).sort().join(";"),xc="X-Amz-Date",Oc="X-Amz-Security-Token",Pc="authorization",Dc="host",kc=xc.toLowerCase(),Mc=Oc.toLowerCase(),Xs="aws4_request",Zs="AWS4-HMAC-SHA256",Fc="AWS4",Lc="e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855",Uc="UNSIGNED-PAYLOAD",Kc=(e,t,n)=>`${e}/${t}/${n}/${Xs}`,Bc=e=>{const t=e.toISOString().replace(/[:-]|\.\d{3}/g,"");return{longDate:t,shortDate:t.slice(0,8)}},Vc=({credentials:e,signingDate:t=new Date,signingRegion:n,signingService:i,uriEscapePath:o=!0})=>{const{accessKeyId:s,secretAccessKey:r,sessionToken:a}=e,{longDate:c,shortDate:u}=Bc(t),d=Kc(u,n,i);return{accessKeyId:s,credentialScope:d,longDate:c,secretAccessKey:r,sessionToken:a,shortDate:u,signingRegion:n,signingService:i,uriEscapePath:o}},At=(e,t)=>{const n=new Ot(e??void 0);return n.update(t),n.digestSync()},jn=(e,t)=>{const n=At(e,t);return Qr(n)},$c=e=>Object.entries(e).map(([t,n])=>({key:t.toLowerCase(),value:(n==null?void 0:n.trim().replace(/\s+/g," "))??""})).sort((t,n)=>t.key<n.key?-1:1).map(t=>`${t.key}:${t.value}
`).join(""),qc=e=>Array.from(e).sort(([t,n],[i,o])=>t===i?n<o?-1:1:t<i?-1:1).map(([t,n])=>`${ho(t)}=${ho(n)}`).join("&"),ho=e=>encodeURIComponent(e).replace(/[!'()*]/g,Hc),Hc=e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`,Wc=(e,t=!0)=>e?t?encodeURIComponent(e).replace(/%2F/g,"/"):e:"/",jc=e=>e==null?Lc:Gc(e)?jn(null,e):Uc,Gc=e=>typeof e=="string"||ArrayBuffer.isView(e)||zc(e),zc=e=>typeof ArrayBuffer=="function"&&e instanceof ArrayBuffer||Object.prototype.toString.call(e)==="[object ArrayBuffer]",Qc=({body:e,headers:t,method:n,url:i},o=!0)=>[n,Wc(i.pathname,o),qc(i.searchParams),$c(t),Js(t),jc(e)].join(`
`),Yc=(e,t,n,i)=>{const o=`${Fc}${e}`,s=At(o,t),r=At(s,n),a=At(r,i);return At(a,Xs)},Jc=(e,t,n)=>[Zs,e,t,n].join(`
`),Xc=(e,{credentialScope:t,longDate:n,secretAccessKey:i,shortDate:o,signingRegion:s,signingService:r,uriEscapePath:a})=>{const c=Qc(e,a),u=jn(null,c),d=Jc(n,t,u);return jn(Yc(i,o,s,r),d)},er=(e,t)=>{const n=Vc(t),{accessKeyId:i,credentialScope:o,longDate:s,sessionToken:r}=n,a={...e.headers};a[Dc]=e.url.host,a[kc]=s,r&&(a[Mc]=r);const c={...e,headers:a},u=Xc(c,n),d=`Credential=${i}/${o}`,l=`SignedHeaders=${Js(a)}`,p=`Signature=${u}`;return a[Pc]=`${Zs} ${d}, ${l}, ${p}`,c},tr=e=>new Date(Date.now()+e),Zc=5*60*1e3,eu=(e,t)=>Math.abs(tr(t).getTime()-e)>=Zc,tu=(e,t)=>eu(e,t)?e-Date.now():t,nu=({credentials:e,region:t,service:n,uriEscapePath:i=!0})=>{let o;return(s,r)=>async function(c){o=o??0;const u={credentials:typeof e=="function"?await e({forceRefresh:!!(r!=null&&r.isCredentialsExpired)}):e,signingDate:tr(o),signingRegion:t,signingService:n,uriEscapePath:i},d=await er(c,u),l=await s(d),p=iu(l);return p&&(o=tu(Date.parse(p),o)),l}},iu=({headers:e}={})=>(e==null?void 0:e.date)??(e==null?void 0:e.Date)??(e==null?void 0:e["x-amz-date"]);class ou extends Error{constructor(){super(...arguments),this.nonRetryable=!0}}const su=(e,t,n=Fs,i)=>sa(e,t,Ls(n)),ru=e=>{let t;return async(...n)=>t||(t=new Promise((i,o)=>{e(...n).then(s=>{i(s)}).catch(s=>{o(s)}).finally(()=>{t=void 0})}),t)};function fo({expiresAt:e,clockDrift:t,tolerance:n=5e3}){return Date.now()+t+n>e}const au=async()=>{const{userAgentData:e}=navigator;if(!e)return navigator.userAgent;const{platform:t="",platformVersion:n="",model:i="",architecture:o="",fullVersionList:s=[]}=await e.getHighEntropyValues(["platform","platformVersion","architecture","model","fullVersionList"]),r=s.map(c=>`${c.brand}/${c.version}`).join(";");return[t,n,o,i,t,r].filter(c=>c).join(" ")||navigator.userAgent};class pn extends ee{get response(){return this._response?cu(this._response):void 0}constructor(t){super(t),this.constructor=pn,Object.setPrototypeOf(this,pn.prototype),t.response&&(this._response=t.response)}}const cu=e=>({...e,headers:{...e.headers}});function uu(e){return Array.from(e,t=>String.fromCodePoint(t)).join("")}const nt={convert(e,t={urlSafe:!1,skipPadding:!1}){const n=typeof e=="string"?e:uu(e);let i=na()(n);return t.urlSafe&&(i=i.replace(/\+/g,"-").replace(/\//g,"_")),t.skipPadding&&(i=i.replace(/=/g,"")),i}};function du(){return ta().getRandomValues(new Uint32Array(1))[0]}function lu(e){const{words:t}=e,{sigBytes:n}=e,i=[];for(let o=0;o<n;o++){const s=t[o>>>2]>>>24-o%4*8&255;i.push((s>>>4).toString(16)),i.push((s&15).toString(16))}return i.join("")}class yi{constructor(t,n){this.words=[];let i=t;i=this.words=i||[],n!==void 0?this.sigBytes=n:this.sigBytes=i.length*4}random(t){const n=[];for(let i=0;i<t;i+=4)n.push(du());return new yi(n,t)}toString(){return lu(this)}}var b;(function(e){e.EmptySignInUsername="EmptySignInUsername",e.EmptySignInPassword="EmptySignInPassword",e.CustomAuthSignInPassword="CustomAuthSignInPassword",e.EmptySignUpUsername="EmptySignUpUsername",e.EmptySignUpPassword="EmptySignUpPassword",e.EmptyConfirmSignUpUsername="EmptyConfirmSignUpUsername",e.EmptyConfirmSignUpCode="EmptyConfirmSignUpCode",e.EmptyResendSignUpCodeUsername="EmptyresendSignUpCodeUsername",e.EmptyChallengeResponse="EmptyChallengeResponse",e.EmptyConfirmResetPasswordUsername="EmptyConfirmResetPasswordUsername",e.EmptyConfirmResetPasswordNewPassword="EmptyConfirmResetPasswordNewPassword",e.EmptyConfirmResetPasswordConfirmationCode="EmptyConfirmResetPasswordConfirmationCode",e.EmptyResetPasswordUsername="EmptyResetPasswordUsername",e.EmptyVerifyTOTPSetupCode="EmptyVerifyTOTPSetupCode",e.EmptyConfirmUserAttributeCode="EmptyConfirmUserAttributeCode",e.IncorrectMFAMethod="IncorrectMFAMethod",e.EmptyUpdatePassword="EmptyUpdatePassword"})(b||(b={}));const nr={[b.EmptyChallengeResponse]:{message:"challengeResponse is required to confirmSignIn"},[b.EmptyConfirmResetPasswordUsername]:{message:"username is required to confirmResetPassword"},[b.EmptyConfirmSignUpCode]:{message:"code is required to confirmSignUp"},[b.EmptyConfirmSignUpUsername]:{message:"username is required to confirmSignUp"},[b.EmptyConfirmResetPasswordConfirmationCode]:{message:"confirmationCode is required to confirmResetPassword"},[b.EmptyConfirmResetPasswordNewPassword]:{message:"newPassword is required to confirmResetPassword"},[b.EmptyResendSignUpCodeUsername]:{message:"username is required to confirmSignUp"},[b.EmptyResetPasswordUsername]:{message:"username is required to resetPassword"},[b.EmptySignInPassword]:{message:"password is required to signIn"},[b.EmptySignInUsername]:{message:"username is required to signIn"},[b.EmptySignUpPassword]:{message:"password is required to signUp"},[b.EmptySignUpUsername]:{message:"username is required to signUp"},[b.CustomAuthSignInPassword]:{message:"A password is not needed when signing in with CUSTOM_WITHOUT_SRP",recoverySuggestion:"Do not include a password in your signIn call."},[b.IncorrectMFAMethod]:{message:"Incorrect MFA method was chosen. It should be either SMS, TOTP, or EMAIL",recoverySuggestion:"Try to pass SMS, TOTP, or EMAIL as the challengeResponse"},[b.EmptyVerifyTOTPSetupCode]:{message:"code is required to verifyTotpSetup"},[b.EmptyUpdatePassword]:{message:"oldPassword and newPassword are required to changePassword"},[b.EmptyConfirmUserAttributeCode]:{message:"confirmation code is required to confirmUserAttribute"}};var mo;(function(e){e.DEFAULT_MSG="Authentication Error",e.EMPTY_EMAIL="Email cannot be empty",e.EMPTY_PHONE="Phone number cannot be empty",e.EMPTY_USERNAME="Username cannot be empty",e.INVALID_USERNAME="The username should either be a string or one of the sign in types",e.EMPTY_PASSWORD="Password cannot be empty",e.EMPTY_CODE="Confirmation code cannot be empty",e.SIGN_UP_ERROR="Error creating account",e.NO_MFA="No valid MFA method provided",e.INVALID_MFA="Invalid MFA type",e.EMPTY_CHALLENGE="Challenge response cannot be empty",e.NO_USER_SESSION="Failed to get the session because the user is empty",e.NETWORK_ERROR="Network Error",e.DEVICE_CONFIG="Device tracking has not been configured in this User Pool",e.AUTOSIGNIN_ERROR="Please use your credentials to sign in",e.OAUTH_ERROR="Couldn't finish OAuth flow, check your User Pool HostedUI settings"})(mo||(mo={}));var it;(function(e){e.SignInException="SignInException",e.OAuthSignInError="OAuthSignInException"})(it||(it={}));class R extends ee{constructor(t){super(t),this.constructor=R,Object.setPrototypeOf(this,R.prototype)}}function J(e,t){const{message:n,recoverySuggestion:i}=nr[t];if(!e)throw new R({name:t,message:n,recoverySuggestion:i})}function X(e){const t=e==null?void 0:e.split("_")[0];if(!e||e.indexOf("_")<0||!t||typeof t!="string")throw new R({name:"InvalidUserPoolId",message:"Invalid user pool id provided."});return t}function Gn(e){if(!e||!e.includes(":"))throw new R({name:"InvalidIdentityPoolIdException",message:"Invalid identity pool id provided.",recoverySuggestion:"Make sure a valid identityPoolId is given in the config."});return e.split(":")[0]}function Eo(e){return Object.entries(e).map(([t,n])=>({Name:t,Value:n}))}var go;(function(e){e.ConcurrentModificationException="ConcurrentModificationException",e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidParameterException="InvalidParameterException",e.NotAuthorizedException="NotAuthorizedException",e.ResourceNotFoundException="ResourceNotFoundException",e.SoftwareTokenMFANotFoundException="SoftwareTokenMFANotFoundException"})(go||(go={}));var yo;(function(e){e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidParameterException="InvalidParameterException",e.InvalidPasswordException="InvalidPasswordException",e.LimitExceededException="LimitExceededException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"})(yo||(yo={}));var So;(function(e){e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidLambdaResponseException="InvalidLambdaResponseException",e.InvalidParameterException="InvalidParameterException",e.InvalidPasswordException="InvalidPasswordException",e.InvalidUserPoolConfigurationException="InvalidUserPoolConfigurationException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UsernameExistsException="UsernameExistsException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"})(So||(So={}));var Io;(function(e){e.CodeMismatchException="CodeMismatchException",e.ExpiredCodeException="ExpiredCodeException",e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidLambdaResponseException="InvalidLambdaResponseException",e.InvalidParameterException="InvalidParameterException",e.InvalidPasswordException="InvalidPasswordException",e.LimitExceededException="LimitExceededException",e.NotAuthorizedException="NotAuthorizedException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyFailedAttemptsException="TooManyFailedAttemptsException",e.TooManyRequestsException="TooManyRequestsException",e.UnexpectedLambdaException="UnexpectedLambdaException",e.UserLambdaValidationException="UserLambdaValidationException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"})(Io||(Io={}));var vo;(function(e){e.AliasExistsException="AliasExistsException",e.CodeMismatchException="CodeMismatchException",e.ExpiredCodeException="ExpiredCodeException",e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidLambdaResponseException="InvalidLambdaResponseException",e.InvalidParameterException="InvalidParameterException",e.LimitExceededException="LimitExceededException",e.NotAuthorizedException="NotAuthorizedException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyFailedAttemptsException="TooManyFailedAttemptsException",e.TooManyRequestsException="TooManyRequestsException",e.UnexpectedLambdaException="UnexpectedLambdaException",e.UserLambdaValidationException="UserLambdaValidationException",e.UserNotFoundException="UserNotFoundException"})(vo||(vo={}));var To;(function(e){e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidParameterException="InvalidParameterException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"})(To||(To={}));var wo;(function(e){e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidParameterException="InvalidParameterException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"})(wo||(wo={}));var No;(function(e){e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidParameterException="InvalidParameterException",e.InvalidUserPoolConfigurationException="InvalidUserPoolConfigurationException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"})(No||(No={}));var Ao;(function(e){e.CodeDeliveryFailureException="CodeDeliveryFailureException",e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidEmailRoleAccessPolicyException="InvalidEmailRoleAccessPolicyException",e.InvalidLambdaResponseException="InvalidLambdaResponseException",e.InvalidParameterException="InvalidParameterException",e.InvalidSmsRoleAccessPolicyException="InvalidSmsRoleAccessPolicyException",e.InvalidSmsRoleTrustRelationshipException="InvalidSmsRoleTrustRelationshipException",e.LimitExceededException="LimitExceededException",e.NotAuthorizedException="NotAuthorizedException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UnexpectedLambdaException="UnexpectedLambdaException",e.UserLambdaValidationException="UserLambdaValidationException",e.UserNotFoundException="UserNotFoundException"})(Ao||(Ao={}));var Co;(function(e){e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidParameterException="InvalidParameterException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"})(Co||(Co={}));var Ro;(function(e){e.ExternalServiceException="ExternalServiceException",e.InternalErrorException="InternalErrorException",e.InvalidParameterException="InvalidParameterException",e.LimitExceededException="LimitExceededException",e.NotAuthorizedException="NotAuthorizedException",e.ResourceConflictException="ResourceConflictException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException"})(Ro||(Ro={}));var _o;(function(e){e.ExternalServiceException="ExternalServiceException",e.InternalErrorException="InternalErrorException",e.InvalidIdentityPoolConfigurationException="InvalidIdentityPoolConfigurationException",e.InvalidParameterException="InvalidParameterException",e.NotAuthorizedException="NotAuthorizedException",e.ResourceConflictException="ResourceConflictException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException"})(_o||(_o={}));var bo;(function(e){e.CodeDeliveryFailureException="CodeDeliveryFailureException",e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidEmailRoleAccessPolicyException="InvalidEmailRoleAccessPolicyException",e.InvalidLambdaResponseException="InvalidLambdaResponseException",e.InvalidParameterException="InvalidParameterException",e.InvalidSmsRoleAccessPolicyException="InvalidSmsRoleAccessPolicyException",e.InvalidSmsRoleTrustRelationshipException="InvalidSmsRoleTrustRelationshipException",e.LimitExceededException="LimitExceededException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UnexpectedLambdaException="UnexpectedLambdaException",e.UserLambdaValidationException="UserLambdaValidationException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"})(bo||(bo={}));var xo;(function(e){e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidParameterException="InvalidParameterException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UserNotConfirmedException="UserNotConfirmedException"})(xo||(xo={}));var hn;(function(e){e.PasswordResetRequiredException="PasswordResetRequiredException",e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidLambdaResponseException="InvalidLambdaResponseException",e.InvalidParameterException="InvalidParameterException",e.InvalidSmsRoleAccessPolicyException="InvalidSmsRoleAccessPolicyException",e.InvalidSmsRoleTrustRelationshipException="InvalidSmsRoleTrustRelationshipException",e.InvalidUserPoolConfigurationException="InvalidUserPoolConfigurationException",e.NotAuthorizedException="NotAuthorizedException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UnexpectedLambdaException="UnexpectedLambdaException",e.UserLambdaValidationException="UserLambdaValidationException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"})(hn||(hn={}));var Oo;(function(e){e.CodeDeliveryFailureException="CodeDeliveryFailureException",e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidEmailRoleAccessPolicyException="InvalidEmailRoleAccessPolicyException",e.InvalidLambdaResponseException="InvalidLambdaResponseException",e.InvalidParameterException="InvalidParameterException",e.InvalidSmsRoleAccessPolicyException="InvalidSmsRoleAccessPolicyException",e.InvalidSmsRoleTrustRelationshipException="InvalidSmsRoleTrustRelationshipException",e.LimitExceededException="LimitExceededException",e.NotAuthorizedException="NotAuthorizedException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UnexpectedLambdaException="UnexpectedLambdaException",e.UserLambdaValidationException="UserLambdaValidationException",e.UserNotFoundException="UserNotFoundException"})(Oo||(Oo={}));var Po;(function(e){e.AliasExistsException="AliasExistsException",e.CodeMismatchException="CodeMismatchException",e.ExpiredCodeException="ExpiredCodeException",e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidLambdaResponseException="InvalidLambdaResponseException",e.InvalidParameterException="InvalidParameterException",e.InvalidPasswordException="InvalidPasswordException",e.InvalidSmsRoleAccessPolicyException="InvalidSmsRoleAccessPolicyException",e.InvalidSmsRoleTrustRelationshipException="InvalidSmsRoleTrustRelationshipException",e.InvalidUserPoolConfigurationException="InvalidUserPoolConfigurationException",e.MFAMethodNotFoundException="MFAMethodNotFoundException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.SoftwareTokenMFANotFoundException="SoftwareTokenMFANotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UnexpectedLambdaException="UnexpectedLambdaException",e.UserLambdaValidationException="UserLambdaValidationException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"})(Po||(Po={}));var Do;(function(e){e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidParameterException="InvalidParameterException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"})(Do||(Do={}));var zn;(function(e){e.CodeDeliveryFailureException="CodeDeliveryFailureException",e.InternalErrorException="InternalErrorException",e.InvalidEmailRoleAccessPolicyException="InvalidEmailRoleAccessPolicyException",e.InvalidLambdaResponseException="InvalidLambdaResponseException",e.InvalidParameterException="InvalidParameterException",e.InvalidPasswordException="InvalidPasswordException",e.InvalidSmsRoleAccessPolicyException="InvalidSmsRoleAccessPolicyException",e.InvalidSmsRoleTrustRelationshipException="InvalidSmsRoleTrustRelationshipException",e.NotAuthorizedException="NotAuthorizedException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UnexpectedLambdaException="UnexpectedLambdaException",e.UserLambdaValidationException="UserLambdaValidationException",e.UsernameExistsException="UsernameExistsException"})(zn||(zn={}));var ko;(function(e){e.AliasExistsException="AliasExistsException",e.CodeDeliveryFailureException="CodeDeliveryFailureException",e.CodeMismatchException="CodeMismatchException",e.ExpiredCodeException="ExpiredCodeException",e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidEmailRoleAccessPolicyException="InvalidEmailRoleAccessPolicyException",e.InvalidLambdaResponseException="InvalidLambdaResponseException",e.InvalidParameterException="InvalidParameterException",e.InvalidSmsRoleAccessPolicyException="InvalidSmsRoleAccessPolicyException",e.InvalidSmsRoleTrustRelationshipException="InvalidSmsRoleTrustRelationshipException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UnexpectedLambdaException="UnexpectedLambdaException",e.UserLambdaValidationException="UserLambdaValidationException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"})(ko||(ko={}));var Mo;(function(e){e.CodeMismatchException="CodeMismatchException",e.EnableSoftwareTokenMFAException="EnableSoftwareTokenMFAException",e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidParameterException="InvalidParameterException",e.InvalidUserPoolConfigurationException="InvalidUserPoolConfigurationException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.SoftwareTokenMFANotFoundException="SoftwareTokenMFANotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"})(Mo||(Mo={}));var Fo;(function(e){e.AliasExistsException="AliasExistsException",e.CodeMismatchException="CodeMismatchException",e.ExpiredCodeException="ExpiredCodeException",e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidParameterException="InvalidParameterException",e.LimitExceededException="LimitExceededException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"})(Fo||(Fo={}));var Lo;(function(e){e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidParameterException="InvalidParameterException",e.InvalidUserPoolConfigurationException="InvalidUserPoolConfigurationException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"})(Lo||(Lo={}));var Uo;(function(e){e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidParameterException="InvalidParameterException",e.InvalidUserPoolConfigurationException="InvalidUserPoolConfigurationException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"})(Uo||(Uo={}));const Tn="UserUnAuthenticatedException",pu="UserAlreadyAuthenticatedException",hu="DeviceMetadataNotFoundException",fu="InvalidRedirectException",mu="InvalidAppSchemeException",Eu="InvalidPreferredRedirectUrlException",gu=new R({name:fu,message:"signInRedirect or signOutRedirect had an invalid format or was not found.",recoverySuggestion:"Please make sure the signIn/Out redirect in your oauth config is valid."});new R({name:mu,message:"A valid non-http app scheme was not found in the config.",recoverySuggestion:"Please make sure a valid custom app scheme is present in the config."});new R({name:Eu,message:"The given preferredRedirectUrl does not match any items in the redirectSignOutUrls array from the config.",recoverySuggestion:"Please make sure a matching preferredRedirectUrl is provided."});const yu="InvalidOriginException",Su=new R({name:yu,message:"redirect is coming from a different origin. The oauth flow needs to be initiated from the same origin",recoverySuggestion:"Please call signInWithRedirect from the same origin."}),Iu="OAuthSignOutException",vu="TokenRefreshException",Tu="UnexpectedSignInInterruptionException";function wu(e){if(!e||!e.accessToken)throw new R({name:Tn,message:"User needs to be authenticated to call this API.",recoverySuggestion:"Sign in before calling this API again."})}function Nu(e){if(!e||!e.idToken)throw new R({name:Tn,message:"User needs to be authenticated to call this API.",recoverySuggestion:"Sign in before calling this API again."})}const Au=new R({name:vu,message:`Token refresh is not supported when authenticated with the 'implicit grant' (token) oauth flow. 
	Please change your oauth configuration to use 'code grant' flow.`,recoverySuggestion:`Please logout and change your Amplify configuration to use "code grant" flow. 
	E.g { responseType: 'code' }`}),Cu=new R({name:Tn,message:"User needs to be authenticated to call this API.",recoverySuggestion:"Sign in before calling this API again."});function ir(e){if(bu(e))throw Au;if(!_u(e))throw Cu}function or(e){if(!e||!e.deviceKey||!e.deviceGroupKey||!e.randomPassword)throw new R({name:hu,message:"Either deviceKey, deviceGroupKey or secretPassword were not found during the sign-in process.",recoverySuggestion:"Make sure to not clear storage after calling the signIn API."})}const Ru={inflightOAuth:"inflightOAuth",oauthSignIn:"oauthSignIn",oauthPKCE:"oauthPKCE",oauthState:"oauthState"};function sr(e){return(e==null?void 0:e.accessToken)||(e==null?void 0:e.idToken)}function _u(e){return sr(e)&&(e==null?void 0:e.refreshToken)}function bu(e){return sr(e)&&!(e!=null&&e.refreshToken)}const xu=async e=>{var a,c;const t=(a=e.getConfig().Auth)==null?void 0:a.Cognito;F(t);const n=await e.Auth.getTokens({forceRefresh:!1});wu(n);const{"cognito:username":i,sub:o}=((c=n.idToken)==null?void 0:c.payload)??{},s={username:i,userId:o},r=Ou(n);return r&&(s.signInDetails=r),s};function Ou(e){return e==null?void 0:e.signInDetails}const Si=async()=>xu(V),ye=(e,t)=>ct({category:ln.Auth,action:e,...t}),De=e=>(t,n)=>{const i=Pu(e),o=JSON.stringify(t);return Du(n,i,o)},Pu=e=>({"content-type":"application/x-amz-json-1.1","x-amz-target":`AWSCognitoIdentityProviderService.${e}`}),Du=({url:e},t,n)=>({headers:t,url:e,body:n,method:"POST"});function me(e){if(!e||e.name==="Error"||e instanceof TypeError)throw new R({name:$e.Unknown,message:"An unknown error has occurred.",underlyingError:e})}const Ge=()=>async e=>{if(e.statusCode>=300){const t=await Je(e);throw me(t),new R({name:t.name,message:t.message,metadata:t.$metadata})}return Lt(e)},ku=()=>(e,t)=>async function(i){return i.headers["cache-control"]="no-store",e(i)},ke=Ut(Vs,[ku]),rr="cognito-idp",Me={service:rr,retryDecider:fi(Je),computeDelay:hi,userAgentValue:ct(),cache:"no-store"},ut=e=>ge(ke,De("InitiateAuth"),Ge(),{...Me,...e}),wn=e=>ge(ke,De("RespondToAuthChallenge"),Ge(),{...Me,...e}),Mu=e=>ge(ke,De("AssociateSoftwareToken"),Ge(),{...Me,...e}),Fu=({region:e})=>({url:new we(`https://${rr}.${e}.${Ws(e)}`)}),Z=({endpointOverride:e})=>t=>e?{url:new we(e)}:Fu(t);function le({username:e,userPoolId:t,userPoolClientId:n}){if(typeof window>"u")return;const i=window.AmazonCognitoAdvancedSecurityData;if(typeof i>"u")return;const o=i.getData(e,t,n);return o?{EncodedData:o}:{}}const Lu=async({tokens:e,authConfig:t,username:n})=>{var g;F(t==null?void 0:t.Cognito);const{userPoolId:i,userPoolClientId:o,userPoolEndpoint:s}=t.Cognito,r=X(i);ir(e);const a=e.refreshToken,c={REFRESH_TOKEN:a};(g=e.deviceMetadata)!=null&&g.deviceKey&&(c.DEVICE_KEY=e.deviceMetadata.deviceKey);const u=le({username:n,userPoolId:i,userPoolClientId:o}),d=ut({endpointResolver:Z({endpointOverride:s})}),{AuthenticationResult:l}=await d({region:r},{ClientId:o,AuthFlow:"REFRESH_TOKEN_AUTH",AuthParameters:c,UserContextData:u}),p=We((l==null?void 0:l.AccessToken)??""),h=l!=null&&l.IdToken?We(l.IdToken):void 0,{iat:f}=p.payload;if(!f)throw new R({name:"iatNotFoundException",message:"iat not found in access token"});const E=f*1e3-new Date().getTime();return{accessToken:p,idToken:h,clockDrift:E,refreshToken:a,username:n}},Uu=ru(Lu),Ku={accessToken:"accessToken",idToken:"idToken",oidcProvider:"oidcProvider",clockDrift:"clockDrift",refreshToken:"refreshToken",deviceKey:"deviceKey",randomPasswordKey:"randomPasswordKey",deviceGroupKey:"deviceGroupKey",signInDetails:"signInDetails",oauthMetadata:"oauthMetadata"};var fn;(function(e){e.InvalidAuthTokens="InvalidAuthTokens"})(fn||(fn={}));const Bu={[fn.InvalidAuthTokens]:{message:"Invalid tokens.",recoverySuggestion:"Make sure the tokens are valid."}},Vu=ci(Bu),Ko="CognitoIdentityServiceProvider";class $u{getKeyValueStorage(){if(!this.keyValueStorage)throw new R({name:"KeyValueStorageNotFoundException",message:"KeyValueStorage was not found in TokenStore"});return this.keyValueStorage}setKeyValueStorage(t){this.keyValueStorage=t}setAuthConfig(t){this.authConfig=t}async loadTokens(){try{const t=await this.getAuthKeys(),n=await this.getKeyValueStorage().getItem(t.accessToken);if(!n)throw new R({name:"NoSessionFoundException",message:"Auth session was not found. Make sure to call signIn."});const i=We(n),o=await this.getKeyValueStorage().getItem(t.idToken),s=o?We(o):void 0,r=await this.getKeyValueStorage().getItem(t.refreshToken)??void 0,a=await this.getKeyValueStorage().getItem(t.clockDrift)??"0",c=Number.parseInt(a),u=await this.getKeyValueStorage().getItem(t.signInDetails),d={accessToken:i,idToken:s,refreshToken:r,deviceMetadata:await this.getDeviceMetadata()??void 0,clockDrift:c,username:await this.getLastAuthUser()};return u&&(d.signInDetails=JSON.parse(u)),d}catch{return null}}async storeTokens(t){Vu(t!==void 0,fn.InvalidAuthTokens);const n=t.username;await this.getKeyValueStorage().setItem(this.getLastAuthUserKey(),n);const i=await this.getAuthKeys();await this.getKeyValueStorage().setItem(i.accessToken,t.accessToken.toString()),t.idToken?await this.getKeyValueStorage().setItem(i.idToken,t.idToken.toString()):await this.getKeyValueStorage().removeItem(i.idToken),t.refreshToken?await this.getKeyValueStorage().setItem(i.refreshToken,t.refreshToken):await this.getKeyValueStorage().removeItem(i.refreshToken),t.deviceMetadata&&(t.deviceMetadata.deviceKey&&await this.getKeyValueStorage().setItem(i.deviceKey,t.deviceMetadata.deviceKey),t.deviceMetadata.deviceGroupKey&&await this.getKeyValueStorage().setItem(i.deviceGroupKey,t.deviceMetadata.deviceGroupKey),await this.getKeyValueStorage().setItem(i.randomPasswordKey,t.deviceMetadata.randomPassword)),t.signInDetails?await this.getKeyValueStorage().setItem(i.signInDetails,JSON.stringify(t.signInDetails)):await this.getKeyValueStorage().removeItem(i.signInDetails),await this.getKeyValueStorage().setItem(i.clockDrift,`${t.clockDrift}`)}async clearTokens(){const t=await this.getAuthKeys();await Promise.all([this.getKeyValueStorage().removeItem(t.accessToken),this.getKeyValueStorage().removeItem(t.idToken),this.getKeyValueStorage().removeItem(t.clockDrift),this.getKeyValueStorage().removeItem(t.refreshToken),this.getKeyValueStorage().removeItem(t.signInDetails),this.getKeyValueStorage().removeItem(this.getLastAuthUserKey()),this.getKeyValueStorage().removeItem(t.oauthMetadata)])}async getDeviceMetadata(t){const n=await this.getAuthKeys(t),i=await this.getKeyValueStorage().getItem(n.deviceKey),o=await this.getKeyValueStorage().getItem(n.deviceGroupKey),s=await this.getKeyValueStorage().getItem(n.randomPasswordKey);return s&&o&&i?{deviceKey:i,deviceGroupKey:o,randomPassword:s}:null}async clearDeviceMetadata(t){const n=await this.getAuthKeys(t);await Promise.all([this.getKeyValueStorage().removeItem(n.deviceKey),this.getKeyValueStorage().removeItem(n.deviceGroupKey),this.getKeyValueStorage().removeItem(n.randomPasswordKey)])}async getAuthKeys(t){var i;F((i=this.authConfig)==null?void 0:i.Cognito);const n=t??await this.getLastAuthUser();return qu(Ko,`${this.authConfig.Cognito.userPoolClientId}.${n}`)}getLastAuthUserKey(){var n;F((n=this.authConfig)==null?void 0:n.Cognito);const t=this.authConfig.Cognito.userPoolClientId;return`${Ko}.${t}.LastAuthUser`}async getLastAuthUser(){return await this.getKeyValueStorage().getItem(this.getLastAuthUserKey())??"username"}async setOAuthMetadata(t){const{oauthMetadata:n}=await this.getAuthKeys();await this.getKeyValueStorage().setItem(n,JSON.stringify(t))}async getOAuthMetadata(){const{oauthMetadata:t}=await this.getAuthKeys(),n=await this.getKeyValueStorage().getItem(t);return n&&JSON.parse(n)}}const qu=(e,t)=>Ii(Ku)(`${e}`,t);function Ii(e){const t=Object.values({...e});return(n,i)=>t.reduce((o,s)=>({...o,[s]:`${n}.${i}.${s}`}),{})}const Bo="amplify-signin-with-hostedUI",Se="CognitoIdentityServiceProvider";class ar{constructor(t){this.keyValueStorage=t}async clearOAuthInflightData(){F(this.cognitoConfig);const t=Ie(Se,this.cognitoConfig.userPoolClientId);await Promise.all([this.keyValueStorage.removeItem(t.inflightOAuth),this.keyValueStorage.removeItem(t.oauthPKCE),this.keyValueStorage.removeItem(t.oauthState)])}async clearOAuthData(){F(this.cognitoConfig);const t=Ie(Se,this.cognitoConfig.userPoolClientId);return await this.clearOAuthInflightData(),await this.keyValueStorage.removeItem(Bo),this.keyValueStorage.removeItem(t.oauthSignIn)}loadOAuthState(){F(this.cognitoConfig);const t=Ie(Se,this.cognitoConfig.userPoolClientId);return this.keyValueStorage.getItem(t.oauthState)}storeOAuthState(t){F(this.cognitoConfig);const n=Ie(Se,this.cognitoConfig.userPoolClientId);return this.keyValueStorage.setItem(n.oauthState,t)}loadPKCE(){F(this.cognitoConfig);const t=Ie(Se,this.cognitoConfig.userPoolClientId);return this.keyValueStorage.getItem(t.oauthPKCE)}storePKCE(t){F(this.cognitoConfig);const n=Ie(Se,this.cognitoConfig.userPoolClientId);return this.keyValueStorage.setItem(n.oauthPKCE,t)}setAuthConfig(t){this.cognitoConfig=t}async loadOAuthInFlight(){F(this.cognitoConfig);const t=Ie(Se,this.cognitoConfig.userPoolClientId);return await this.keyValueStorage.getItem(t.inflightOAuth)==="true"}async storeOAuthInFlight(t){F(this.cognitoConfig);const n=Ie(Se,this.cognitoConfig.userPoolClientId);await this.keyValueStorage.setItem(n.inflightOAuth,`${t}`)}async loadOAuthSignIn(){var s;F(this.cognitoConfig);const t=Ie(Se,this.cognitoConfig.userPoolClientId),n=await this.keyValueStorage.getItem(Bo),[i,o]=((s=await this.keyValueStorage.getItem(t.oauthSignIn))==null?void 0:s.split(","))??[];return{isOAuthSignIn:i==="true"||n==="true",preferPrivateSession:o==="true"}}async storeOAuthSignIn(t,n=!1){F(this.cognitoConfig);const i=Ie(Se,this.cognitoConfig.userPoolClientId);await this.keyValueStorage.setItem(i.oauthSignIn,`${t},${n}`)}}const Ie=(e,t)=>Ii(Ru)(e,t),Vo=new ar(Kt);class Hu{constructor(){this.waitForInflightOAuth=ks()?async()=>{if(await Vo.loadOAuthInFlight())return this.inflightPromise?this.inflightPromise:(this.inflightPromise=new Promise((t,n)=>{}),this.inflightPromise)}:async()=>{}}setAuthConfig(t){Vo.setAuthConfig(t.Cognito),this.authConfig=t}setTokenRefresher(t){this.tokenRefresher=t}setAuthTokenStore(t){this.tokenStore=t}getTokenStore(){if(!this.tokenStore)throw new R({name:"EmptyTokenStoreException",message:"TokenStore not set"});return this.tokenStore}getTokenRefresher(){if(!this.tokenRefresher)throw new R({name:"EmptyTokenRefresherException",message:"TokenRefresher not set"});return this.tokenRefresher}async getTokens(t){var r,a,c,u,d;let n;try{F((r=this.authConfig)==null?void 0:r.Cognito)}catch{return null}await this.waitForInflightOAuth(),this.inflightPromise=void 0,n=await this.getTokenStore().loadTokens();const i=await this.getTokenStore().getLastAuthUser();if(n===null)return null;const o=!!(n!=null&&n.idToken)&&fo({expiresAt:(((c=(a=n.idToken)==null?void 0:a.payload)==null?void 0:c.exp)??0)*1e3,clockDrift:n.clockDrift??0}),s=fo({expiresAt:(((d=(u=n.accessToken)==null?void 0:u.payload)==null?void 0:d.exp)??0)*1e3,clockDrift:n.clockDrift??0});return(t!=null&&t.forceRefresh||o||s)&&(n=await this.refreshTokens({tokens:n,username:i}),n===null)?null:{accessToken:n==null?void 0:n.accessToken,idToken:n==null?void 0:n.idToken,signInDetails:n==null?void 0:n.signInDetails}}async refreshTokens({tokens:t,username:n}){try{const{signInDetails:i}=t,o=await this.getTokenRefresher()({tokens:t,authConfig:this.authConfig,username:n});return o.signInDetails=i,await this.setTokens({tokens:o}),He.dispatch("auth",{event:"tokenRefresh"},"Auth",qe),o}catch(i){return this.handleErrors(i)}}handleErrors(t){if(me(t),t.name!==$e.NetworkError&&this.clearTokens(),He.dispatch("auth",{event:"tokenRefresh_failure",data:{error:t}},"Auth",qe),t.name.startsWith("NotAuthorizedException"))return null;throw t}async setTokens({tokens:t}){return this.getTokenStore().storeTokens(t)}async clearTokens(){return this.getTokenStore().clearTokens()}getDeviceMetadata(t){return this.getTokenStore().getDeviceMetadata(t)}clearDeviceMetadata(t){return this.getTokenStore().clearDeviceMetadata(t)}setOAuthMetadata(t){return this.getTokenStore().setOAuthMetadata(t)}getOAuthMetadata(){return this.getTokenStore().getOAuthMetadata()}}class Wu{constructor(){this.authTokenStore=new $u,this.authTokenStore.setKeyValueStorage(Kt),this.tokenOrchestrator=new Hu,this.tokenOrchestrator.setAuthTokenStore(this.authTokenStore),this.tokenOrchestrator.setTokenRefresher(Uu)}getTokens({forceRefresh:t}={forceRefresh:!1}){return this.tokenOrchestrator.getTokens({forceRefresh:t})}setKeyValueStorage(t){this.authTokenStore.setKeyValueStorage(t)}setAuthConfig(t){this.authTokenStore.setAuthConfig(t),this.tokenOrchestrator.setAuthConfig(t)}}const Ct=new Wu,{tokenOrchestrator:de}=Ct;async function dt(e){if(e.AccessToken){const t=We(e.AccessToken),n=(t.payload.iat||0)*1e3,i=new Date().getTime(),o=n>0?n-i:0;let s,r,a;e.RefreshToken&&(r=e.RefreshToken),e.IdToken&&(s=We(e.IdToken)),e!=null&&e.NewDeviceMetadata&&(a=e.NewDeviceMetadata);const c={accessToken:t,idToken:s,refreshToken:r,clockDrift:o,deviceMetadata:a,username:e.username};e!=null&&e.signInDetails&&(c.signInDetails=e.signInDetails),await de.setTokens({tokens:c})}else throw new ee({message:"Invalid tokens",name:"InvalidTokens",recoverySuggestion:"Check Cognito UserPool settings"})}const ju="Unable to get user session following successful sign-in.",lt=async()=>{try{He.dispatch("auth",{event:"signedIn",data:await Si()},"Auth",qe)}catch(e){throw e.name===Tn?new R({name:Tu,message:ju,recoverySuggestion:"This most likely is due to auth tokens not being persisted. If you are using cookie store, please ensure cookies can be correctly set from your server."}):e}};function cr(){return{active:!1}}const Gu=(e,t)=>{switch(t.type){case"SET_USERNAME":return{...e,username:t.value};case"SET_SESSION":return{...e,session:t.value};case"START":return{...e,active:!0};case"RESET":return cr();default:return e}},zu=e=>{let t=e(cr(),{type:"RESET"});return{getState:()=>t,dispatch:n=>{t=e(t,n)}}},Ue=zu(Gu),Qu=3*60*1e3,Gt="CognitoSignInState",_e={username:`${Gt}.username`,challengeName:`${Gt}.challengeName`,signInSession:`${Gt}.signInSession`,expiry:`${Gt}.expiry`},Yu=(e,t)=>{switch(t.type){case"SET_SIGN_IN_SESSION":return zt({signInSession:t.value}),{...e,signInSession:t.value};case"SET_SIGN_IN_STATE":return zt(t.value),{...t.value};case"SET_CHALLENGE_NAME":return zt({challengeName:t.value}),{...e,challengeName:t.value};case"SET_USERNAME":return zt({username:t.value}),{...e,username:t.value};case"SET_INITIAL_STATE":return Xu();case"RESET_STATE":return ur(),vi();default:return e}},Ju=e=>{const t=Number(e),n=Date.now();return t<=n},Ne=()=>{je.dispatch({type:"RESET_STATE"})},ur=()=>{for(const e of Object.values(_e))Re.removeItem(e)},vi=()=>({username:void 0,challengeName:void 0,signInSession:void 0}),Xu=()=>{const e=Re.getItem(_e.expiry);if(!e||Ju(e))return ur(),vi();const t=Re.getItem(_e.username)??void 0,n=Re.getItem(_e.challengeName)??void 0,i=Re.getItem(_e.signInSession)??void 0;return{username:t,challengeName:n,signInSession:i}},Zu=e=>{let t=e(vi(),{type:"SET_INITIAL_STATE"});return{getState:()=>t,dispatch:n=>{t=e(t,n)}}},je=Zu(Yu);function pt(e){je.dispatch({type:"SET_SIGN_IN_STATE",value:e})}const zt=({challengeName:e,signInSession:t,username:n})=>{n&&Re.setItem(_e.username,n),e&&Re.setItem(_e.challengeName,e),t&&(Re.setItem(_e.signInSession,t),Re.setItem(_e.expiry,String(Date.now()+Qu)))};class be extends ee{constructor(t){super(t),this.constructor=be,Object.setPrototypeOf(this,be.prototype)}}var j;(function(e){e.PasskeyNotSupported="PasskeyNotSupported",e.PasskeyAlreadyExists="PasskeyAlreadyExists",e.InvalidPasskeyRegistrationOptions="InvalidPasskeyRegistrationOptions",e.InvalidPasskeyAuthenticationOptions="InvalidPasskeyAuthenticationOptions",e.RelyingPartyMismatch="RelyingPartyMismatch",e.PasskeyRegistrationFailed="PasskeyRegistrationFailed",e.PasskeyRetrievalFailed="PasskeyRetrievalFailed",e.PasskeyRegistrationCanceled="PasskeyRegistrationCanceled",e.PasskeyAuthenticationCanceled="PasskeyAuthenticationCanceled",e.PasskeyOperationAborted="PasskeyOperationAborted"})(j||(j={}));const $o="Passkeys may not be supported on this device. Ensure your application is running in a secure context (HTTPS) and Web Authentication API is supported.",Ln="User may have canceled the ceremony or another interruption has occurred. Check underlying error for details.",qo="Ensure your user pool is configured to support the WEB_AUTHN as an authentication factor.",mn={[j.PasskeyNotSupported]:{message:"Passkeys may not be supported on this device.",recoverySuggestion:$o},[j.InvalidPasskeyRegistrationOptions]:{message:"Invalid passkey registration options.",recoverySuggestion:qo},[j.InvalidPasskeyAuthenticationOptions]:{message:"Invalid passkey authentication options.",recoverySuggestion:qo},[j.PasskeyRegistrationFailed]:{message:"Device failed to create passkey.",recoverySuggestion:$o},[j.PasskeyRetrievalFailed]:{message:"Device failed to retrieve passkey.",recoverySuggestion:"Passkeys may not be available on this device. Try an alternative authentication factor like PASSWORD, EMAIL_OTP, or SMS_OTP."},[j.PasskeyAlreadyExists]:{message:"Passkey already exists in authenticator.",recoverySuggestion:"Proceed with existing passkey or try again after deleting the credential."},[j.PasskeyRegistrationCanceled]:{message:"Passkey registration ceremony has been canceled.",recoverySuggestion:Ln},[j.PasskeyAuthenticationCanceled]:{message:"Passkey authentication ceremony has been canceled.",recoverySuggestion:Ln},[j.PasskeyOperationAborted]:{message:"Passkey operation has been aborted.",recoverySuggestion:Ln},[j.RelyingPartyMismatch]:{message:"Relying party does not match current domain.",recoverySuggestion:"Ensure relying party identifier matches current domain."}},Ti=ci(mn,be),ed=e=>{if(e instanceof be)return e;if(e instanceof Error&&e.name==="NotAllowedError"){const{message:t,recoverySuggestion:n}=mn[j.PasskeyAuthenticationCanceled];return new be({name:j.PasskeyAuthenticationCanceled,message:t,recoverySuggestion:n,underlyingError:e})}return td(e)},td=e=>{if(e instanceof Error){if(e.name==="AbortError"){const{message:t,recoverySuggestion:n}=mn[j.PasskeyOperationAborted];return new be({name:j.PasskeyOperationAborted,message:t,recoverySuggestion:n,underlyingError:e})}if(e.name==="SecurityError"){const{message:t,recoverySuggestion:n}=mn[j.RelyingPartyMismatch];return new be({name:j.RelyingPartyMismatch,message:t,recoverySuggestion:n,underlyingError:e})}}return new be({name:$e.Unknown,message:"An unknown error has occurred.",underlyingError:e})},nd=()=>ks()&&window.isSecureContext&&"credentials"in navigator&&typeof window.PublicKeyCredential=="function",vt=e=>nt.convert(new Uint8Array(e),{urlSafe:!0,skipPadding:!0}),Ho=e=>Uint8Array.from(ui.convert(e,{urlSafe:!0}),t=>t.charCodeAt(0)).buffer,id=e=>{const t=Ho(e.challenge),n=(e.allowCredentials||[]).map(i=>({...i,id:Ho(i.id)}));return{...e,challenge:t,allowCredentials:n}},od=e=>{const t={clientDataJSON:vt(e.response.clientDataJSON),authenticatorData:vt(e.response.authenticatorData),signature:vt(e.response.signature)};e.response.userHandle&&(t.userHandle=vt(e.response.userHandle));const n={id:e.id,rawId:vt(e.rawId),type:e.type,clientExtensionResults:e.getClientExtensionResults(),response:t};return e.authenticatorAttachment&&(n.authenticatorAttachment=e.authenticatorAttachment),n};function sd(e){Ti(e&&e instanceof PublicKeyCredential&&e.response instanceof AuthenticatorAssertionResponse,j.PasskeyRetrievalFailed)}const rd=async e=>{try{const t=nd();Ti(t,j.PasskeyNotSupported);const n=id(e),i=await navigator.credentials.get({publicKey:n});return sd(i),od(i)}catch(t){throw ed(t)}},ad=e=>ge(ke,De("ConfirmDevice"),Ge(),{...Me,...e}),Xt={convert(e){return new TextEncoder().encode(e)}};function w(e,t){e!=null&&this.fromString(e,t)}function ne(){return new w(null,null)}let Ve;const cd=0xdeadbeefcafe,Wo=(cd&16777215)===15715070;function ud(e,t,n,i,o,s){for(;--s>=0;){const r=t*this[e++]+n[i]+o;o=Math.floor(r/67108864),n[i++]=r&67108863}return o}function dd(e,t,n,i,o,s){const r=t&32767,a=t>>15;for(;--s>=0;){let c=this[e]&32767;const u=this[e++]>>15,d=a*c+u*r;c=r*c+((d&32767)<<15)+n[i]+(o&1073741823),o=(c>>>30)+(d>>>15)+a*u+(o>>>30),n[i++]=c&1073741823}return o}function ld(e,t,n,i,o,s){const r=t&16383,a=t>>14;for(;--s>=0;){let c=this[e]&16383;const u=this[e++]>>14,d=a*c+u*r;c=r*c+((d&16383)<<14)+n[i]+o,o=(c>>28)+(d>>14)+a*u,n[i++]=c&268435455}return o}const jo=typeof navigator<"u";jo&&Wo&&navigator.appName==="Microsoft Internet Explorer"?(w.prototype.am=dd,Ve=30):jo&&Wo&&navigator.appName!=="Netscape"?(w.prototype.am=ud,Ve=26):(w.prototype.am=ld,Ve=28);w.prototype.DB=Ve;w.prototype.DM=(1<<Ve)-1;w.prototype.DV=1<<Ve;const wi=52;w.prototype.FV=Math.pow(2,wi);w.prototype.F1=wi-Ve;w.prototype.F2=2*Ve-wi;const pd="0123456789abcdefghijklmnopqrstuvwxyz",Nn=[];let ht,ue;ht=48;for(ue=0;ue<=9;++ue)Nn[ht++]=ue;ht=97;for(ue=10;ue<36;++ue)Nn[ht++]=ue;ht=65;for(ue=10;ue<36;++ue)Nn[ht++]=ue;function Go(e){return pd.charAt(e)}function hd(e,t){const n=Nn[e.charCodeAt(t)];return n??-1}function fd(e){for(let t=this.t-1;t>=0;--t)e[t]=this[t];e.t=this.t,e.s=this.s}function md(e){this.t=1,this.s=e<0?-1:0,e>0?this[0]=e:e<-1?this[0]=e+this.DV:this.t=0}function Ni(e){const t=ne();return t.fromInt(e),t}function Ed(e,t){let n;if(t===16)n=4;else if(t===8)n=3;else if(t===2)n=1;else if(t===32)n=5;else if(t===4)n=2;else throw new Error("Only radix 2, 4, 8, 16, 32 are supported");this.t=0,this.s=0;let i=e.length,o=!1,s=0;for(;--i>=0;){const r=hd(e,i);if(r<0){e.charAt(i)==="-"&&(o=!0);continue}o=!1,s===0?this[this.t++]=r:s+n>this.DB?(this[this.t-1]|=(r&(1<<this.DB-s)-1)<<s,this[this.t++]=r>>this.DB-s):this[this.t-1]|=r<<s,s+=n,s>=this.DB&&(s-=this.DB)}this.clamp(),o&&w.ZERO.subTo(this,this)}function gd(){const e=this.s&this.DM;for(;this.t>0&&this[this.t-1]==e;)--this.t}function yd(e){if(this.s<0)return"-"+this.negate().toString(e);let t;if(e==16)t=4;else if(e===8)t=3;else if(e===2)t=1;else if(e===32)t=5;else if(e===4)t=2;else throw new Error("Only radix 2, 4, 8, 16, 32 are supported");const n=(1<<t)-1;let i,o=!1,s="",r=this.t,a=this.DB-r*this.DB%t;if(r-- >0)for(a<this.DB&&(i=this[r]>>a)>0&&(o=!0,s=Go(i));r>=0;)a<t?(i=(this[r]&(1<<a)-1)<<t-a,i|=this[--r]>>(a+=this.DB-t)):(i=this[r]>>(a-=t)&n,a<=0&&(a+=this.DB,--r)),i>0&&(o=!0),o&&(s+=Go(i));return o?s:"0"}function Sd(){const e=ne();return w.ZERO.subTo(this,e),e}function Id(){return this.s<0?this.negate():this}function vd(e){let t=this.s-e.s;if(t!=0)return t;let n=this.t;if(t=n-e.t,t!=0)return this.s<0?-t:t;for(;--n>=0;)if((t=this[n]-e[n])!=0)return t;return 0}function Ai(e){let t=1,n;return(n=e>>>16)!==0&&(e=n,t+=16),(n=e>>8)!==0&&(e=n,t+=8),(n=e>>4)!==0&&(e=n,t+=4),(n=e>>2)!==0&&(e=n,t+=2),(n=e>>1)!==0&&(e=n,t+=1),t}function Td(){return this.t<=0?0:this.DB*(this.t-1)+Ai(this[this.t-1]^this.s&this.DM)}function wd(e,t){let n;for(n=this.t-1;n>=0;--n)t[n+e]=this[n];for(n=e-1;n>=0;--n)t[n]=0;t.t=this.t+e,t.s=this.s}function Nd(e,t){for(let n=e;n<this.t;++n)t[n-e]=this[n];t.t=Math.max(this.t-e,0),t.s=this.s}function Ad(e,t){const n=e%this.DB,i=this.DB-n,o=(1<<i)-1,s=Math.floor(e/this.DB);let r=this.s<<n&this.DM,a;for(a=this.t-1;a>=0;--a)t[a+s+1]=this[a]>>i|r,r=(this[a]&o)<<n;for(a=s-1;a>=0;--a)t[a]=0;t[s]=r,t.t=this.t+s+1,t.s=this.s,t.clamp()}function Cd(e,t){t.s=this.s;const n=Math.floor(e/this.DB);if(n>=this.t){t.t=0;return}const i=e%this.DB,o=this.DB-i,s=(1<<i)-1;t[0]=this[n]>>i;for(let r=n+1;r<this.t;++r)t[r-n-1]|=(this[r]&s)<<o,t[r-n]=this[r]>>i;i>0&&(t[this.t-n-1]|=(this.s&s)<<o),t.t=this.t-n,t.clamp()}function Rd(e,t){let n=0,i=0;const o=Math.min(e.t,this.t);for(;n<o;)i+=this[n]-e[n],t[n++]=i&this.DM,i>>=this.DB;if(e.t<this.t){for(i-=e.s;n<this.t;)i+=this[n],t[n++]=i&this.DM,i>>=this.DB;i+=this.s}else{for(i+=this.s;n<e.t;)i-=e[n],t[n++]=i&this.DM,i>>=this.DB;i-=e.s}t.s=i<0?-1:0,i<-1?t[n++]=this.DV+i:i>0&&(t[n++]=i),t.t=n,t.clamp()}function _d(e,t){const n=this.abs(),i=e.abs();let o=n.t;for(t.t=o+i.t;--o>=0;)t[o]=0;for(o=0;o<i.t;++o)t[o+n.t]=n.am(0,i[o],t,o,0,n.t);t.s=0,t.clamp(),this.s!==e.s&&w.ZERO.subTo(t,t)}function bd(e){const t=this.abs();let n=e.t=2*t.t;for(;--n>=0;)e[n]=0;for(n=0;n<t.t-1;++n){const i=t.am(n,t[n],e,2*n,0,1);(e[n+t.t]+=t.am(n+1,2*t[n],e,2*n+1,i,t.t-n-1))>=t.DV&&(e[n+t.t]-=t.DV,e[n+t.t+1]=1)}e.t>0&&(e[e.t-1]+=t.am(n,t[n],e,2*n,0,1)),e.s=0,e.clamp()}function xd(e,t,n){const i=e.abs();if(i.t<=0)return;const o=this.abs();if(o.t<i.t){t!=null&&t.fromInt(0),n!=null&&this.copyTo(n);return}n===null&&(n=ne());const s=ne(),r=this.s,a=e.s,c=this.DB-Ai(i[i.t-1]);c>0?(i.lShiftTo(c,s),o.lShiftTo(c,n)):(i.copyTo(s),o.copyTo(n));const u=s.t,d=s[u-1];if(d===0)return;const l=d*(1<<this.F1)+(u>1?s[u-2]>>this.F2:0),p=this.FV/l,h=(1<<this.F1)/l,f=1<<this.F2;let E=n.t,g=E-u;const y=t===null?ne():t;for(s.dlShiftTo(g,y),n.compareTo(y)>=0&&(n[n.t++]=1,n.subTo(y,n)),w.ONE.dlShiftTo(u,y),y.subTo(s,s);s.t<u;)s[s.t++]=0;for(;--g>=0;){let I=n[--E]===d?this.DM:Math.floor(n[E]*p+(n[E-1]+f)*h);if((n[E]+=s.am(0,I,n,g,0,u))<I)for(s.dlShiftTo(g,y),n.subTo(y,n);n[E]<--I;)n.subTo(y,n)}t!==null&&(n.drShiftTo(u,t),r!==a&&w.ZERO.subTo(t,t)),n.t=u,n.clamp(),c>0&&n.rShiftTo(c,n),r<0&&w.ZERO.subTo(n,n)}function Od(e){const t=ne();return this.abs().divRemTo(e,null,t),this.s<0&&t.compareTo(w.ZERO)>0&&e.subTo(t,t),t}function Pd(){if(this.t<1)return 0;const e=this[0];if((e&1)===0)return 0;let t=e&3;return t=t*(2-(e&15)*t)&15,t=t*(2-(e&255)*t)&255,t=t*(2-((e&65535)*t&65535))&65535,t=t*(2-e*t%this.DV)%this.DV,t>0?this.DV-t:-t}function Dd(e){return this.compareTo(e)===0}function kd(e,t){let n=0,i=0;const o=Math.min(e.t,this.t);for(;n<o;)i+=this[n]+e[n],t[n++]=i&this.DM,i>>=this.DB;if(e.t<this.t){for(i+=e.s;n<this.t;)i+=this[n],t[n++]=i&this.DM,i>>=this.DB;i+=this.s}else{for(i+=this.s;n<e.t;)i+=e[n],t[n++]=i&this.DM,i>>=this.DB;i+=e.s}t.s=i<0?-1:0,i>0?t[n++]=i:i<-1&&(t[n++]=this.DV+i),t.t=n,t.clamp()}function Md(e){const t=ne();return this.addTo(e,t),t}function Fd(e){const t=ne();return this.subTo(e,t),t}function Ld(e){const t=ne();return this.multiplyTo(e,t),t}function Ud(e){const t=ne();return this.divRemTo(e,t,null),t}function ft(e){this.m=e,this.mp=e.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<e.DB-15)-1,this.mt2=2*e.t}function Kd(e){const t=ne();return e.abs().dlShiftTo(this.m.t,t),t.divRemTo(this.m,null,t),e.s<0&&t.compareTo(w.ZERO)>0&&this.m.subTo(t,t),t}function Bd(e){const t=ne();return e.copyTo(t),this.reduce(t),t}function Vd(e){for(;e.t<=this.mt2;)e[e.t++]=0;for(let t=0;t<this.m.t;++t){let n=e[t]&32767;const i=n*this.mpl+((n*this.mph+(e[t]>>15)*this.mpl&this.um)<<15)&e.DM;for(n=t+this.m.t,e[n]+=this.m.am(0,i,e,t,0,this.m.t);e[n]>=e.DV;)e[n]-=e.DV,e[++n]++}e.clamp(),e.drShiftTo(this.m.t,e),e.compareTo(this.m)>=0&&e.subTo(this.m,e)}function $d(e,t){e.squareTo(t),this.reduce(t)}function qd(e,t,n){e.multiplyTo(t,n),this.reduce(n)}ft.prototype.convert=Kd;ft.prototype.revert=Bd;ft.prototype.reduce=Vd;ft.prototype.mulTo=qd;ft.prototype.sqrTo=$d;function Hd(e,t,n){let i=e.bitLength(),o,s=Ni(1);const r=new ft(t);if(i<=0)return s;i<18?o=1:i<48?o=3:i<144?o=4:i<768?o=5:o=6;const a=[];let c=3;const u=o-1,d=(1<<o)-1;if(a[1]=r.convert(this),o>1){const y=ne();for(r.sqrTo(a[1],y);c<=d;)a[c]=ne(),r.mulTo(y,a[c-2],a[c]),c+=2}let l=e.t-1,p,h=!0,f=ne(),E;for(i=Ai(e[l])-1;l>=0;){for(i>=u?p=e[l]>>i-u&d:(p=(e[l]&(1<<i+1)-1)<<u-i,l>0&&(p|=e[l-1]>>this.DB+i-u)),c=o;(p&1)===0;)p>>=1,--c;if((i-=c)<0&&(i+=this.DB,--l),h)a[p].copyTo(s),h=!1;else{for(;c>1;)r.sqrTo(s,f),r.sqrTo(f,s),c-=2;c>0?r.sqrTo(s,f):(E=s,s=f,f=E),r.mulTo(f,a[p],s)}for(;l>=0&&(e[l]&1<<i)===0;)r.sqrTo(s,f),E=s,s=f,f=E,--i<0&&(i=this.DB-1,--l)}const g=r.revert(s);return n(null,g),g}w.prototype.copyTo=fd;w.prototype.fromInt=md;w.prototype.fromString=Ed;w.prototype.clamp=gd;w.prototype.dlShiftTo=wd;w.prototype.drShiftTo=Nd;w.prototype.lShiftTo=Ad;w.prototype.rShiftTo=Cd;w.prototype.subTo=Rd;w.prototype.multiplyTo=_d;w.prototype.squareTo=bd;w.prototype.divRemTo=xd;w.prototype.invDigit=Pd;w.prototype.addTo=kd;w.prototype.toString=yd;w.prototype.negate=Sd;w.prototype.abs=Id;w.prototype.compareTo=vd;w.prototype.bitLength=Td;w.prototype.mod=Od;w.prototype.equals=Dd;w.prototype.add=Md;w.prototype.subtract=Fd;w.prototype.multiply=Ld;w.prototype.divide=Ud;w.prototype.modPow=Hd;w.ZERO=Ni(0);w.ONE=Ni(1);const Wd=async({a:e,g:t,k:n,x:i,B:o,N:s,U:r})=>new Promise((a,c)=>{t.modPow(i,s,(u,d)=>{if(u){c(u);return}o.subtract(n.multiply(d)).modPow(e.add(r.multiply(i)),s,(l,p)=>{if(l){c(l);return}a(p.mod(s))})})}),jd="FFFFFFFFFFFFFFFFC90FDAA22168C234C4C6628B80DC1CD129024E088A67CC74020BBEA63B139B22514A08798E3404DDEF9519B3CD3A431B302B0A6DF25F14374FE1356D6D51C245E485B576625E7EC6F44C42E9A637ED6B0BFF5CB6F406B7EDEE386BFB5A899FA5AE9F24117C4B1FE649286651ECE45B3DC2007CB8A163BF0598DA48361C55D39A69163FA8FD24CF5F83655D23DCA3AD961C62F356208552BB9ED529077096966D670C354E4ABC9804F1746C08CA18217C32905E462E36CE3BE39E772C180E86039B2783A2EC07A28FB5C55DF06F4C52C9DE2BCBF6955817183995497CEA956AE515D2261898FA051015728E5A8AAAC42DAD33170D04507A33A85521ABDF1CBA64ECFB850458DBEF0A8AEA71575D060C7DB3970F85A6E1E4C7ABF5AE8CDB0933D71E8C94E04A25619DCEE3D2261AD2EE6BF12FFA06D98A0864D87602733EC86A64521F2B18177B200CBBE117577A615D6C770988C0BAD946E208E24FA074E5AB3143DB5BFCE0FD108E4B82D120A93AD2CAFFFFFFFFFFFFFFFF",dr={},Qn={};for(let e=0;e<256;e++){let t=e.toString(16).toLowerCase();t.length===1&&(t=`0${t}`),dr[e]=t,Qn[t]=e}const ot=e=>{if(e.length%2!==0)throw new Error("Hex encoded strings must have an even number length");const t=new Uint8Array(e.length/2);for(let n=0;n<e.length;n+=2){const i=e.slice(n,n+2).toLowerCase();if(i in Qn)t[n/2]=Qn[i];else throw new Error(`Cannot decode unrecognized sequence ${i} as hexadecimal`)}return t},Ci=e=>{let t="";for(let n=0;n<e.byteLength;n++)t+=dr[e[n]];return t},Yn=e=>{const t=new Ot;t.update(e);const n=t.digestSync(),i=Ci(n);return new Array(64-i.length).join("0")+i},Zt=e=>Yn(ot(e)),Gd=/^[89a-f]/i,Ae=e=>{if(!(e instanceof w))throw new Error("Not a BigInteger");const t=e.compareTo(w.ZERO)<0;let n=e.abs().toString(16);if(n=n.length%2!==0?`0${n}`:n,n=Gd.test(n)?`00${n}`:n,t){const i=n.split("").map(s=>{const r=~parseInt(s,16)&15;return"0123456789ABCDEF".charAt(r)}).join("");n=new w(i,16).add(w.ONE).toString(16),n.toUpperCase().startsWith("FF8")&&(n=n.substring(2))}return n},zd=({A:e,B:t})=>{const n=new w(Zt(Ae(e)+Ae(t)),16);if(n.equals(w.ZERO))throw new Error("U cannot be zero.");return n},Qd=(e,t,n)=>{const i=new Ot(t);i.update(e);const o=i.digestSync(),s=new Ot(o);return s.update(n),s.digestSync().slice(0,16)},Ri=e=>{const t=new yi().random(e).toString();return ot(t)},Yd=()=>nt.convert(Ri(40));class Jd{constructor({userPoolName:t,a:n,g:i,A:o,N:s}){this.encoder=Xt,this.userPoolName=t,this.a=n,this.g=i,this.A=o,this.N=s,this.k=new w(Zt(`${Ae(s)}${Ae(i)}`),16)}getRandomPassword(){if(!this.randomPassword)throw new R({name:"EmptyBigIntegerRandomPassword",message:"random password is empty"});return this.randomPassword}getSaltToHashDevices(){if(!this.saltToHashDevices)throw new R({name:"EmptyBigIntegersaltToHashDevices",message:"saltToHashDevices is empty"});return this.saltToHashDevices}getVerifierDevices(){if(!this.verifierDevices)throw new R({name:"EmptyBigIntegerVerifierDevices",message:"verifyDevices is empty"});return this.verifierDevices}async generateHashDevice(t,n){this.randomPassword=Yd();const i=`${t}${n}:${this.randomPassword}`,o=Yn(i),s=Ci(Ri(16));return this.saltToHashDevices=Ae(new w(s,16)),new Promise((r,a)=>{this.g.modPow(new w(Zt(this.saltToHashDevices+o),16),this.N,(c,u)=>{if(c){a(c);return}this.verifierDevices=Ae(u),r()})})}async getPasswordAuthenticationKey({username:t,password:n,serverBValue:i,salt:o}){if(i.mod(this.N).equals(w.ZERO))throw new Error("B cannot be zero.");const s=zd({A:this.A,B:i}),r=`${this.userPoolName}${t}:${n}`,a=Yn(r),c=new w(Zt(Ae(o)+a),16),u=await Wd({a:this.a,g:this.g,k:this.k,x:c,B:i,N:this.N,U:s}),d=this.encoder.convert("Caldera Derived Key"),l=this.encoder.convert(""),p=new Uint8Array(d.byteLength+l.byteLength);return p.set(d,0),p.set(l,d.byteLength),Qd(ot(Ae(u)),ot(Ae(s)),p)}}const Xd=async({a:e,g:t,N:n})=>new Promise((i,o)=>{t.modPow(e,n,(s,r)=>{if(s){o(s);return}if(r.mod(n).equals(w.ZERO)){o(new Error("Illegal parameter. A mod N cannot be 0."));return}i(r)})}),An=async e=>{const t=new w(jd,16),n=new w("2",16),i=Zd(),o=await Xd({a:i,g:n,N:t});return new Jd({userPoolName:e,a:i,g:n,A:o,N:t})},Zd=()=>{const e=Ci(Ri(128));return new w(e,16)};async function mt({userPoolId:e,userPoolEndpoint:t,newDeviceMetadata:n,accessToken:i}){if(!n)return;const o=e.split("_")[1]||"",s=await An(o),r=n==null?void 0:n.DeviceKey,a=n==null?void 0:n.DeviceGroupKey;try{await s.generateHashDevice(a??"",r??"")}catch{return}const c={Salt:nt.convert(ot(s.getSaltToHashDevices())),PasswordVerifier:nt.convert(ot(s.getVerifierDevices()))},u=s.getRandomPassword();try{return await ad({endpointResolver:Z({endpointOverride:t})})({region:X(e)},{AccessToken:i,DeviceName:await au(),DeviceKey:n==null?void 0:n.DeviceKey,DeviceSecretVerifierConfig:c}),{deviceKey:r,deviceGroupKey:a,randomPassword:u}}catch{return}}async function el(e){var h;const t=(h=V.getConfig().Auth)==null?void 0:h.Cognito;F(t);const{username:n,signInSession:i,signInDetails:o,challengeName:s}=je.getState();if(s!=="WEB_AUTHN"||!n)throw new R({name:it.SignInException,message:"Unable to proceed due to invalid sign in state."});const{CREDENTIAL_REQUEST_OPTIONS:r}=e;Ti(!!r,j.InvalidPasskeyAuthenticationOptions);const a=await rd(JSON.parse(r)),c=wn({endpointResolver:Z({endpointOverride:t.userPoolEndpoint})}),{ChallengeName:u,ChallengeParameters:d,AuthenticationResult:l,Session:p}=await c({region:X(t.userPoolId),userAgentValue:ye(se.ConfirmSignIn)},{ChallengeName:"WEB_AUTHN",ChallengeResponses:{USERNAME:n,CREDENTIAL:JSON.stringify(a)},ClientId:t.userPoolClientId,Session:i});if(pt({signInSession:p,username:n,challengeName:u,signInDetails:o}),l)return await dt({...l,username:n,NewDeviceMetadata:await mt({userPoolId:t.userPoolId,userPoolEndpoint:t.userPoolEndpoint,newDeviceMetadata:l.NewDeviceMetadata,accessToken:l.AccessToken}),signInDetails:o}),je.dispatch({type:"RESET_STATE"}),await lt(),{isSignedIn:!0,nextStep:{signInStep:"DONE"}};if(u==="WEB_AUTHN")throw new R({name:it.SignInException,message:"Sequential WEB_AUTHN challenges returned from underlying service cannot be handled."});return{challengeName:u,challengeParameters:d}}const tl=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],nl=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],lr=()=>{const e=new Date,t=nl[e.getUTCDay()],n=tl[e.getUTCMonth()],i=e.getUTCDate();let o=e.getUTCHours();o<10&&(o=`0${o}`);let s=e.getUTCMinutes();s<10&&(s=`0${s}`);let r=e.getUTCSeconds();r<10&&(r=`0${r}`);const a=e.getUTCFullYear();return`${t} ${n} ${i} ${o}:${s}:${r} UTC ${a}`},pr=({userPoolName:e,username:t,challengeParameters:n,dateNow:i,hkdf:o})=>{const s=Xt.convert(e),r=Xt.convert(t),a=il(n.SECRET_BLOCK),c=Xt.convert(i),u=new Uint8Array(s.byteLength+r.byteLength+a.byteLength+c.byteLength);u.set(s,0),u.set(r,s.byteLength),u.set(a,s.byteLength+r.byteLength),u.set(c,s.byteLength+r.byteLength+a.byteLength);const d=new Ot(o);d.update(u);const l=d.digestSync();return nt.convert(l)},il=e=>{const t="=".repeat((4-e.length%4)%4),n=(e+t).replace(/-/g,"+").replace(/_/g,"/"),i=ui.convert(n),o=new Uint8Array(i.length);for(let s=0;s<i.length;++s)o[s]=i.charCodeAt(s);return o};async function _i({username:e,config:t,clientMetadata:n,session:i,tokenOrchestrator:o}){const{userPoolId:s,userPoolEndpoint:r}=t,a=t.userPoolClientId,c=await(o==null?void 0:o.getDeviceMetadata(e));or(c);const u=await An(c.deviceGroupKey),d={USERNAME:e,SRP_A:u.A.toString(16),DEVICE_KEY:c.deviceKey},l={ChallengeName:"DEVICE_SRP_AUTH",ClientId:a,ChallengeResponses:d,ClientMetadata:n,Session:i},p=wn({endpointResolver:Z({endpointOverride:r})}),{ChallengeParameters:h,Session:f}=await p({region:X(s)},l);return ol(e,h,n,f,u,t,o)}async function ol(e,t,n,i,o,{userPoolId:s,userPoolClientId:r,userPoolEndpoint:a},c){const u=await(c==null?void 0:c.getDeviceMetadata(e));or(u);const d=new w(t==null?void 0:t.SRP_B,16),l=new w(t==null?void 0:t.SALT,16),{deviceKey:p}=u,{deviceGroupKey:h}=u,f=await o.getPasswordAuthenticationKey({username:u.deviceKey,password:u.randomPassword,serverBValue:d,salt:l}),E=lr(),g={USERNAME:(t==null?void 0:t.USERNAME)??e,PASSWORD_CLAIM_SECRET_BLOCK:t==null?void 0:t.SECRET_BLOCK,TIMESTAMP:E,PASSWORD_CLAIM_SIGNATURE:pr({username:p,userPoolName:h,challengeParameters:t,dateNow:E,hkdf:f}),DEVICE_KEY:p},y=le({username:e,userPoolId:s,userPoolClientId:r}),I={ChallengeName:"DEVICE_PASSWORD_VERIFIER",ClientId:r,ChallengeResponses:g,Session:i,ClientMetadata:n,UserContextData:y};return wn({endpointResolver:Z({endpointOverride:a})})({region:X(s)},I)}async function hr(e,t,n,i,o,s,r){const{userPoolId:a,userPoolClientId:c,userPoolEndpoint:u}=s,d=(a==null?void 0:a.split("_")[1])||"",l=new w(t==null?void 0:t.SRP_B,16),p=new w(t==null?void 0:t.SALT,16),h=t==null?void 0:t.USER_ID_FOR_SRP;if(!h)throw new R({name:"EmptyUserIdForSRPException",message:"USER_ID_FOR_SRP was not found in challengeParameters"});const f=await o.getPasswordAuthenticationKey({username:h,password:e,serverBValue:l,salt:p}),E=lr(),g={USERNAME:h,PASSWORD_CLAIM_SECRET_BLOCK:t==null?void 0:t.SECRET_BLOCK,TIMESTAMP:E,PASSWORD_CLAIM_SIGNATURE:pr({username:h,userPoolName:d,challengeParameters:t,dateNow:E,hkdf:f})},y=await r.getDeviceMetadata(h);y&&y.deviceKey&&(g.DEVICE_KEY=y.deviceKey);const I=le({username:h,userPoolId:a,userPoolClientId:c}),T={ChallengeName:"PASSWORD_VERIFIER",ChallengeResponses:g,ClientMetadata:n,Session:i,ClientId:c,UserContextData:I},S=await wn({endpointResolver:Z({endpointOverride:u})})({region:X(a)},T);return S.ChallengeName==="DEVICE_SRP_AUTH"?_i({username:h,config:s,clientMetadata:n,session:S.Session,tokenOrchestrator:r}):S}async function Cn(e,t,n,i){try{return await e(...t)}catch(o){if(o instanceof R&&o.name==="ResourceNotFoundException"&&o.message.includes("Device does not exist."))return await i.clearDeviceMetadata(n),e(...t);throw o}}function Bt(e){const{dispatch:t}=je;t({type:"SET_USERNAME",value:e})}async function fr({username:e,password:t,clientMetadata:n,config:i,tokenOrchestrator:o,authFlow:s,preferredChallenge:r}){const{userPoolId:a,userPoolClientId:c,userPoolEndpoint:u}=i,d=(a==null?void 0:a.split("_")[1])||"",l=await An(d),p={USERNAME:e,SRP_A:l.A.toString(16)};s==="USER_AUTH"&&r&&(p.PREFERRED_CHALLENGE=r);const h=le({username:e,userPoolId:a,userPoolClientId:c}),f={AuthFlow:s,AuthParameters:p,ClientMetadata:n,ClientId:c,UserContextData:h},g=await ut({endpointResolver:Z({endpointOverride:u})})({region:X(a),userAgentValue:ye(se.SignIn)},f),{ChallengeParameters:y,Session:I}=g,T=(y==null?void 0:y.USERNAME)??e;return Bt(T),g.ChallengeName==="PASSWORD_VERIFIER"?Cn(hr,[t,y,n,I,l,i,o],T,o):g}const zo="userAttributes.";function sl(e){return"isSignedIn"in e&&"nextStep"in e}async function rl(e,t,n,i,o){var E,g;const{userPoolClientId:s,userPoolId:r,userPoolEndpoint:a}=i,c={USERNAME:e,PASSWORD:t},u=await o.getDeviceMetadata(e);u&&u.deviceKey&&(c.DEVICE_KEY=u.deviceKey);const d=le({username:e,userPoolId:r,userPoolClientId:s}),l={AuthFlow:"USER_PASSWORD_AUTH",AuthParameters:c,ClientMetadata:n,ClientId:s,UserContextData:d},h=await ut({endpointResolver:Z({endpointOverride:a})})({region:X(r),userAgentValue:ye(se.SignIn)},l),f=((E=h.ChallengeParameters)==null?void 0:E.USERNAME)??((g=h.ChallengeParameters)==null?void 0:g.USER_ID_FOR_SRP)??e;return Bt(f),h.ChallengeName==="DEVICE_SRP_AUTH"?_i({username:f,config:i,clientMetadata:n,session:h.Session,tokenOrchestrator:o}):h}async function al(e,t,n,i,o){return fr({username:e,password:t,clientMetadata:n,config:i,tokenOrchestrator:o,authFlow:"USER_SRP_AUTH"})}async function cl(e,t,n,i){var f;const{userPoolClientId:o,userPoolId:s,userPoolEndpoint:r}=n,a={USERNAME:e},c=await i.getDeviceMetadata(e);c&&c.deviceKey&&(a.DEVICE_KEY=c.deviceKey);const u=le({username:e,userPoolId:s,userPoolClientId:o}),d={AuthFlow:"CUSTOM_AUTH",AuthParameters:a,ClientMetadata:t,ClientId:o,UserContextData:u},p=await ut({endpointResolver:Z({endpointOverride:r})})({region:X(s),userAgentValue:ye(se.SignIn)},d),h=((f=p.ChallengeParameters)==null?void 0:f.USERNAME)??e;return Bt(h),p.ChallengeName==="DEVICE_SRP_AUTH"?_i({username:h,config:n,clientMetadata:t,session:p.Session,tokenOrchestrator:i}):p}async function ul(e,t,n,i,o){F(i);const{userPoolId:s,userPoolClientId:r,userPoolEndpoint:a}=i,c=(s==null?void 0:s.split("_")[1])||"",u=await An(c),d={USERNAME:e,SRP_A:u.A.toString(16),CHALLENGE_NAME:"SRP_A"},l=le({username:e,userPoolId:s,userPoolClientId:r}),p={AuthFlow:"CUSTOM_AUTH",AuthParameters:d,ClientMetadata:n,ClientId:r,UserContextData:l},h=ut({endpointResolver:Z({endpointOverride:a})}),{ChallengeParameters:f,Session:E}=await h({region:X(s),userAgentValue:ye(se.SignIn)},p),g=(f==null?void 0:f.USERNAME)??e;return Bt(g),Cn(hr,[t,f,n,E,u,i,o],g,o)}async function Et(e){var s;const{challengeName:t,challengeParameters:n,availableChallenges:i}=e,o=(s=V.getConfig().Auth)==null?void 0:s.Cognito;switch(F(o),t){case"CUSTOM_CHALLENGE":return{isSignedIn:!1,nextStep:{signInStep:"CONFIRM_SIGN_IN_WITH_CUSTOM_CHALLENGE",additionalInfo:n}};case"MFA_SETUP":{const{signInSession:r,username:a}=je.getState(),c=Qo(Yo(n.MFAS_CAN_SETUP))||[],u=hl(c),d=u.includes("TOTP"),l=u.includes("EMAIL");if(d&&l)return{isSignedIn:!1,nextStep:{signInStep:"CONTINUE_SIGN_IN_WITH_MFA_SETUP_SELECTION",allowedMFATypes:u}};if(l)return{isSignedIn:!1,nextStep:{signInStep:"CONTINUE_SIGN_IN_WITH_EMAIL_SETUP"}};if(d){const p=Mu({endpointResolver:Z({endpointOverride:o.userPoolEndpoint})}),{Session:h,SecretCode:f}=await p({region:X(o.userPoolId)},{Session:r});return je.dispatch({type:"SET_SIGN_IN_SESSION",value:h}),{isSignedIn:!1,nextStep:{signInStep:"CONTINUE_SIGN_IN_WITH_TOTP_SETUP",totpSetupDetails:dl(f,a)}}}throw new R({name:it.SignInException,message:`Cannot initiate MFA setup from available types: ${c}`})}case"NEW_PASSWORD_REQUIRED":return{isSignedIn:!1,nextStep:{signInStep:"CONFIRM_SIGN_IN_WITH_NEW_PASSWORD_REQUIRED",missingAttributes:ll(n.requiredAttributes)}};case"SELECT_MFA_TYPE":return{isSignedIn:!1,nextStep:{signInStep:"CONTINUE_SIGN_IN_WITH_MFA_SELECTION",allowedMFATypes:Qo(Yo(n.MFAS_CAN_CHOOSE))}};case"SMS_OTP":case"SMS_MFA":return{isSignedIn:!1,nextStep:{signInStep:"CONFIRM_SIGN_IN_WITH_SMS_CODE",codeDeliveryDetails:{deliveryMedium:n.CODE_DELIVERY_DELIVERY_MEDIUM,destination:n.CODE_DELIVERY_DESTINATION}}};case"SOFTWARE_TOKEN_MFA":return{isSignedIn:!1,nextStep:{signInStep:"CONFIRM_SIGN_IN_WITH_TOTP_CODE"}};case"EMAIL_OTP":return{isSignedIn:!1,nextStep:{signInStep:"CONFIRM_SIGN_IN_WITH_EMAIL_CODE",codeDeliveryDetails:{deliveryMedium:n.CODE_DELIVERY_DELIVERY_MEDIUM,destination:n.CODE_DELIVERY_DESTINATION}}};case"WEB_AUTHN":{const r=await el(n);return sl(r)?r:Et(r)}case"PASSWORD":case"PASSWORD_SRP":return{isSignedIn:!1,nextStep:{signInStep:"CONFIRM_SIGN_IN_WITH_PASSWORD"}};case"SELECT_CHALLENGE":return{isSignedIn:!1,nextStep:{signInStep:"CONTINUE_SIGN_IN_WITH_FIRST_FACTOR_SELECTION",availableChallenges:i}}}throw new R({name:it.SignInException,message:`An error occurred during the sign in process. ${t} challengeName returned by the underlying service was not addressed.`})}function dl(e,t){return{sharedSecret:e,getSetupUri:(n,i)=>{const o=`otpauth://totp/${n}:${i??t}?secret=${e}&issuer=${n}`;return new we(o)}}}function Vt(e){if(e===hn.PasswordResetRequiredException)return{isSignedIn:!1,nextStep:{signInStep:"RESET_PASSWORD"}};if(e===hn.UserNotConfirmedException)return{isSignedIn:!1,nextStep:{signInStep:"CONFIRM_SIGN_UP"}}}function ll(e){return e?JSON.parse(e).map(n=>n.includes(zo)?n.replace(zo,""):n):[]}function pl(e){if(e==="SMS_MFA")return"SMS";if(e==="SOFTWARE_TOKEN_MFA")return"TOTP";if(e==="EMAIL_OTP")return"EMAIL"}function Qo(e){if(e)return e.map(pl).filter(Boolean)}function Yo(e){return e?JSON.parse(e):[]}function hl(e){return e.filter(t=>t==="EMAIL"||t==="TOTP")}async function fl(){let e;try{e=await Si()}catch{}if(e&&e.userId&&e.username)throw new R({name:pu,message:"There is already a signed in user.",recoverySuggestion:"Call signOut before calling signIn again."})}function $t(e){return je.getState().username??e}async function ml(e){var a;const t=(a=V.getConfig().Auth)==null?void 0:a.Cognito;F(t);const{username:n,password:i,options:o}=e,s={loginId:n,authFlowType:"CUSTOM_WITHOUT_SRP"},r=o==null?void 0:o.clientMetadata;J(!!n,b.EmptySignInUsername),J(!i,b.CustomAuthSignInPassword);try{const{ChallengeName:c,ChallengeParameters:u,AuthenticationResult:d,Session:l}=await Cn(cl,[n,r,t,de],n,de),p=$t(n);return pt({signInSession:l,username:p,challengeName:c,signInDetails:s}),d?(await dt({username:p,...d,NewDeviceMetadata:await mt({userPoolId:t.userPoolId,userPoolEndpoint:t.userPoolEndpoint,newDeviceMetadata:d.NewDeviceMetadata,accessToken:d.AccessToken}),signInDetails:s}),Ne(),await lt(),{isSignedIn:!0,nextStep:{signInStep:"DONE"}}):Et({challengeName:c,challengeParameters:u})}catch(c){Ne(),me(c);const u=Vt(c.name);if(u)return u;throw c}}async function El(e){var a;const{username:t,password:n,options:i}=e,o={loginId:t,authFlowType:"CUSTOM_WITH_SRP"},s=(a=V.getConfig().Auth)==null?void 0:a.Cognito;F(s);const r=i==null?void 0:i.clientMetadata;J(!!t,b.EmptySignInUsername),J(!!n,b.EmptySignInPassword);try{const{ChallengeName:c,ChallengeParameters:u,AuthenticationResult:d,Session:l}=await ul(t,n,r,s,de),p=$t(t);return pt({signInSession:l,username:p,challengeName:c,signInDetails:o}),d?(await dt({username:p,...d,NewDeviceMetadata:await mt({userPoolId:s.userPoolId,userPoolEndpoint:s.userPoolEndpoint,newDeviceMetadata:d.NewDeviceMetadata,accessToken:d.AccessToken}),signInDetails:o}),Ne(),await lt(),{isSignedIn:!0,nextStep:{signInStep:"DONE"}}):Et({challengeName:c,challengeParameters:u})}catch(c){Ne(),me(c);const u=Vt(c.name);if(u)return u;throw c}}function xe(e=!0){Ue.dispatch({type:"RESET"})}async function Jo(e){var r,a;const{username:t,password:n}=e,i=(r=V.getConfig().Auth)==null?void 0:r.Cognito,o={loginId:t,authFlowType:"USER_SRP_AUTH"};F(i);const s=(a=e.options)==null?void 0:a.clientMetadata;J(!!t,b.EmptySignInUsername),J(!!n,b.EmptySignInPassword);try{const{ChallengeName:c,ChallengeParameters:u,AuthenticationResult:d,Session:l}=await al(t,n,s,i,de),p=$t(t);return pt({signInSession:l,username:p,challengeName:c,signInDetails:o}),d?(await dt({username:p,...d,NewDeviceMetadata:await mt({userPoolId:i.userPoolId,userPoolEndpoint:i.userPoolEndpoint,newDeviceMetadata:d.NewDeviceMetadata,accessToken:d.AccessToken}),signInDetails:o}),Ne(),await lt(),xe(),{isSignedIn:!0,nextStep:{signInStep:"DONE"}}):Et({challengeName:c,challengeParameters:u})}catch(c){Ne(),xe(),me(c);const u=Vt(c.name);if(u)return u;throw c}}async function gl(e){var a;const{username:t,password:n,options:i}=e,o=(a=V.getConfig().Auth)==null?void 0:a.Cognito,s={loginId:t,authFlowType:"USER_PASSWORD_AUTH"};F(o);const r=i==null?void 0:i.clientMetadata;J(!!t,b.EmptySignInUsername),J(!!n,b.EmptySignInPassword);try{const{ChallengeName:c,ChallengeParameters:u,AuthenticationResult:d,Session:l}=await Cn(rl,[t,n,r,o,de],t,de),p=$t(t);return pt({signInSession:l,username:p,challengeName:c,signInDetails:s}),d?(await dt({...d,username:p,NewDeviceMetadata:await mt({userPoolId:o.userPoolId,userPoolEndpoint:o.userPoolEndpoint,newDeviceMetadata:d.NewDeviceMetadata,accessToken:d.AccessToken}),signInDetails:s}),Ne(),await lt(),xe(),{isSignedIn:!0,nextStep:{signInStep:"DONE"}}):Et({challengeName:c,challengeParameters:u})}catch(c){Ne(),xe(),me(c);const u=Vt(c.name);if(u)return u;throw c}}async function yl({username:e,clientMetadata:t,config:n,tokenOrchestrator:i,preferredChallenge:o,password:s,session:r}){const{userPoolId:a,userPoolClientId:c,userPoolEndpoint:u}=n,d=le({username:e,userPoolId:a,userPoolClientId:c}),l={USERNAME:e};if(o){if(o==="PASSWORD_SRP")return J(!!s,b.EmptySignInPassword),fr({username:e,password:s,clientMetadata:t,config:n,tokenOrchestrator:i,authFlow:"USER_AUTH",preferredChallenge:o});o==="PASSWORD"&&(J(!!s,b.EmptySignInPassword),l.PASSWORD=s),l.PREFERRED_CHALLENGE=o}const p={AuthFlow:"USER_AUTH",AuthParameters:l,ClientMetadata:t,ClientId:c,UserContextData:d};r&&(p.Session=r);const f=await ut({endpointResolver:Z({endpointOverride:u})})({region:X(a),userAgentValue:ye(se.SignIn)},p);return Bt(e),f}async function Sl(e){var c;const{username:t,password:n,options:i}=e,o=(c=V.getConfig().Auth)==null?void 0:c.Cognito,s={loginId:t,authFlowType:"USER_AUTH"};F(o);const r=i==null?void 0:i.clientMetadata,a=i==null?void 0:i.preferredChallenge;J(!!t,b.EmptySignInUsername);try{const u={username:t,config:o,tokenOrchestrator:de,clientMetadata:r,preferredChallenge:a,password:n},d=Ue.getState();d.active&&d.username===t&&(u.session=d.session);const l=await yl(u),p=$t(t);return pt({signInSession:l.Session,username:p,challengeName:l.ChallengeName,signInDetails:s}),l.AuthenticationResult?(await dt({username:p,...l.AuthenticationResult,NewDeviceMetadata:await mt({userPoolId:o.userPoolId,userPoolEndpoint:o.userPoolEndpoint,newDeviceMetadata:l.AuthenticationResult.NewDeviceMetadata,accessToken:l.AuthenticationResult.AccessToken}),signInDetails:s}),Ne(),await lt(),xe(),{isSignedIn:!0,nextStep:{signInStep:"DONE"}}):Et({challengeName:l.ChallengeName,challengeParameters:l.ChallengeParameters,availableChallenges:"AvailableChallenges"in l?l.AvailableChallenges:void 0})}catch(u){Ne(),xe(),me(u);const d=Vt(u.name);if(d)return d;throw u}}async function Il(e){var n;xe(!1);const t=(n=e.options)==null?void 0:n.authFlowType;switch(await fl(),t){case"USER_SRP_AUTH":return Jo(e);case"USER_PASSWORD_AUTH":return gl(e);case"CUSTOM_WITHOUT_SRP":return ml(e);case"CUSTOM_WITH_SRP":return El(e);case"USER_AUTH":return Sl(e);default:return Jo(e)}}const vl=3*60*1e3;function Tl(e){const t=dn.listen("auth-internal",async({payload:i})=>{switch(i.event){case"confirmSignUp":{const o=i.data;o!=null&&o.isSignUpComplete&&(dn.dispatch("auth-internal",{event:"autoSignIn"}),t())}}}),n=setTimeout(()=>{t(),clearTimeout(n),xe()},vl)}const wl=()=>async e=>{if(e.statusCode>=300){const t=await Je(e);if(me(t),t.name===zn.InvalidParameterException&&/'password'/.test(t.message)&&/Member must not be null/.test(t.message)){const n=b.EmptySignUpPassword,{message:i,recoverySuggestion:o}=nr[n];throw new R({name:n,message:i,recoverySuggestion:o})}throw new R({name:t.name,message:t.message})}return Lt(e)},Nl=e=>ge(ke,De("SignUp"),wl(),{...Me,...e});async function Al(e){var A;const{username:t,password:n,options:i}=e,o=(A=V.getConfig().Auth)==null?void 0:A.Cognito,s=(o==null?void 0:o.signUpVerificationMethod)??"code",{clientMetadata:r,validationData:a,autoSignIn:c}=e.options??{};F(o),J(!!t,b.EmptySignUpUsername);const u=typeof c!="boolean"?c:void 0;u==null||u.authFlowType;const{userPoolId:d,userPoolClientId:l,userPoolEndpoint:p}=o,h=Nl({endpointResolver:Z({endpointOverride:p})}),f={Username:t,Password:void 0,UserAttributes:(i==null?void 0:i.userAttributes)&&Eo(i==null?void 0:i.userAttributes),ClientMetadata:r,ValidationData:a&&Eo(a),ClientId:l,UserContextData:le({username:t,userPoolId:d,userPoolClientId:l})};n&&(f.Password=n);const{UserSub:E,CodeDeliveryDetails:g,UserConfirmed:y,Session:I}=await h({region:X(d),userAgentValue:ye(se.SignUp)},f);(u||c===!0)&&(Ue.dispatch({type:"START"}),Ue.dispatch({type:"SET_USERNAME",value:t}),Ue.dispatch({type:"SET_SESSION",value:I}));const T={destination:g==null?void 0:g.Destination,deliveryMedium:g==null?void 0:g.DeliveryMedium,attributeName:g==null?void 0:g.AttributeName},v=!!y,S=Ue.getState().active;if(v)return S?{isSignUpComplete:!0,nextStep:{signUpStep:"COMPLETE_AUTO_SIGN_IN"},userId:E}:{isSignUpComplete:!0,nextStep:{signUpStep:"DONE"},userId:E};if(S){if(s==="link")return{isSignUpComplete:!1,nextStep:{signUpStep:"COMPLETE_AUTO_SIGN_IN",codeDeliveryDetails:T},userId:E};Tl()}return{isSignUpComplete:!1,nextStep:{signUpStep:"CONFIRM_SIGN_UP",codeDeliveryDetails:T},userId:E}}const Cl=e=>ge(ke,De("ForgotPassword"),Ge(),{...Me,...e});async function Rl(e){var l,p;const{username:t}=e;J(!!t,b.EmptyResetPasswordUsername);const n=(l=V.getConfig().Auth)==null?void 0:l.Cognito;F(n);const{userPoolClientId:i,userPoolId:o,userPoolEndpoint:s}=n,r=(p=e.options)==null?void 0:p.clientMetadata,a=le({username:t,userPoolId:o,userPoolClientId:i}),d=(await Cl({endpointResolver:Z({endpointOverride:s})})({region:X(o),userAgentValue:ye(se.ResetPassword)},{Username:t,ClientMetadata:r,ClientId:i,UserContextData:a})).CodeDeliveryDetails;return{isPasswordReset:!1,nextStep:{resetPasswordStep:"CONFIRM_RESET_PASSWORD_WITH_CODE",codeDeliveryDetails:{deliveryMedium:d==null?void 0:d.DeliveryMedium,destination:d==null?void 0:d.Destination,attributeName:d==null?void 0:d.AttributeName}}}}const _l=e=>ge(ke,De("ConfirmForgotPassword"),Ge(),{...Me,...e});async function bl(e){var l,p;const t=(l=V.getConfig().Auth)==null?void 0:l.Cognito;F(t);const{userPoolClientId:n,userPoolId:i,userPoolEndpoint:o}=t,{username:s,newPassword:r}=e;J(!!s,b.EmptyConfirmResetPasswordUsername),J(!!r,b.EmptyConfirmResetPasswordNewPassword);const a=e.confirmationCode;J(!!a,b.EmptyConfirmResetPasswordConfirmationCode);const c=(p=e.options)==null?void 0:p.clientMetadata,u=le({username:s,userPoolId:i,userPoolClientId:n});await _l({endpointResolver:Z({endpointOverride:o})})({region:X(t.userPoolId),userAgentValue:ye(se.ConfirmResetPassword)},{Username:s,ConfirmationCode:a,Password:r,ClientMetadata:c,ClientId:t.userPoolClientId,UserContextData:u})}const xl=e=>ge(ke,De("ConfirmSignUp"),Ge(),{...Me,...e});async function Ol(e){var p;const{username:t,confirmationCode:n,options:i}=e,o=(p=V.getConfig().Auth)==null?void 0:p.Cognito;F(o);const{userPoolId:s,userPoolClientId:r,userPoolEndpoint:a}=o,c=i==null?void 0:i.clientMetadata;J(!!t,b.EmptyConfirmSignUpUsername),J(!!n,b.EmptyConfirmSignUpCode);const u=le({username:t,userPoolId:s,userPoolClientId:r}),d=xl({endpointResolver:Z({endpointOverride:a})}),{Session:l}=await d({region:X(o.userPoolId),userAgentValue:ye(se.ConfirmSignUp)},{Username:t,ConfirmationCode:n,ClientMetadata:c,ForceAliasCreation:i==null?void 0:i.forceAliasCreation,ClientId:o.userPoolClientId,UserContextData:u});return new Promise((h,f)=>{try{const E={isSignUpComplete:!0,nextStep:{signUpStep:"DONE"}},g=Ue.getState();if(!g.active||g.username!==t){h(E),xe();return}Ue.dispatch({type:"SET_SESSION",value:l});const y=dn.listen("auth-internal",({payload:I})=>{switch(I.event){case"autoSignIn":h({isSignUpComplete:!0,nextStep:{signUpStep:"COMPLETE_AUTO_SIGN_IN"}}),y()}});dn.dispatch("auth-internal",{event:"confirmSignUp",data:E})}catch(E){f(E)}})}function Pl(e,t){{const n=(e==null?void 0:e.find(Dl))??(e==null?void 0:e.find(kl)),i=(e==null?void 0:e.find(Fl))??(e==null?void 0:e.find(Ml));if(n)return n;throw i?Su:gu}}const Dl=e=>e.startsWith(String(window.location.origin+(window.location.pathname||"/"))),kl=e=>e.includes(String(window.location.hostname)),Ml=e=>e.startsWith("http://"),Fl=e=>e.startsWith("https://"),Ll=async e=>{window!=null&&window.location&&(window.location.href=e.replace("http://","https://"))},Ul=async e=>{await e.clearOAuthData(),de.clearTokens(),await Ms(),He.dispatch("auth",{event:"signedOut"},"Auth",qe)},Kl=async(e,t=!1,n)=>{Rs(e);const{loginWith:i,userPoolClientId:o}=e,{domain:s,redirectSignOut:r}=i.oauth,a=Pl(r),c=`https://${s}/logout?${Object.entries({client_id:o,logout_uri:encodeURIComponent(a)}).map(([u,d])=>`${u}=${d}`).join("&")}`;return Ll(c)},Bl=async(e,t,n,i)=>{const{isOAuthSignIn:o}=await t.loadOAuthSignIn(),s=await n.getOAuthMetadata();if(await Ul(t),o||s!=null&&s.oauthSignIn)return Kl(e,!1)},Vl=e=>ge(ke,De("RevokeToken"),Ge(),{...Me,...e}),$l=new Y("Auth");async function ql(e){var i;const t=(i=V.getConfig().Auth)==null?void 0:i.Cognito;F(t),await Hl(t);let n;try{Rs(t),n=!0}catch{n=!1}if(n){const o=new ar(Kt);o.setAuthConfig(t);const{type:s}=await Bl(t,o,de)??{};if(s==="error")throw new R({name:Iu,message:"An error occurred when attempting to log out from OAuth provider."})}else de.clearTokens(),await Ms(),He.dispatch("auth",{event:"signedOut"},"Auth",qe)}async function Hl(e){try{const{userPoolEndpoint:t,userPoolId:n,userPoolClientId:i}=e,o=await de.getTokenStore().loadTokens();ir(o),Wl(o.accessToken)&&await Vl({endpointResolver:Z({endpointOverride:t})})({region:X(n),userAgentValue:ye(se.SignOut)},{ClientId:i,Token:o.refreshToken})}catch{$l.debug("Client signOut error caught but will proceed with token removal")}}const Wl=e=>{var t;return!!((t=e==null?void 0:e.payload)!=null&&t.origin_jti)},jl={identityId:"identityId"},Gl=new Y("DefaultIdentityIdStore");class mr{setAuthConfig(t){Jt(t.Cognito),this.authConfig=t,this._authKeys=zl("Cognito",t.Cognito.identityPoolId)}constructor(t){this._authKeys={},this._hasGuestIdentityId=!1,this.keyValueStorage=t}async loadIdentityId(){var t;Jt((t=this.authConfig)==null?void 0:t.Cognito);try{if(this._primaryIdentityId)return{id:this._primaryIdentityId,type:"primary"};{const n=await this.keyValueStorage.getItem(this._authKeys.identityId);return n?(this._hasGuestIdentityId=!0,{id:n,type:"guest"}):null}}catch(n){return Gl.log("Error getting stored IdentityId.",n),null}}async storeIdentityId(t){var n;Jt((n=this.authConfig)==null?void 0:n.Cognito),t.type==="guest"?(this.keyValueStorage.setItem(this._authKeys.identityId,t.id),this._primaryIdentityId=void 0,this._hasGuestIdentityId=!0):(this._primaryIdentityId=t.id,this._hasGuestIdentityId&&(this.keyValueStorage.removeItem(this._authKeys.identityId),this._hasGuestIdentityId=!1))}async clearIdentityId(){this._primaryIdentityId=void 0,await this.keyValueStorage.removeItem(this._authKeys.identityId)}}const zl=(e,t)=>Ii(jl)(`com.amplify.${e}`,t),Jn=({endpointOverride:e})=>t=>e?{url:new we(e)}:wc(t);function Er(e){const t=We(e).payload.iss,n={};if(!t)throw new R({name:"InvalidIdTokenException",message:"Invalid Idtoken."});const i=t.replace(/(^\w+:|^)\/\//,"");return n[i]=e,n}async function Ql({tokens:e,authConfig:t,identityIdStore:n}){n.setAuthConfig({Cognito:t});const i=await n.loadIdentityId();if(i)return i.id;const o=e!=null&&e.idToken?Er(e.idToken.toString()):{},s=await Yl(o,t);return n.storeIdentityId({id:s,type:e?"primary":"guest"}),s}async function Yl(e,t){const n=t==null?void 0:t.identityPoolId,i=Gn(n),o=Ic({endpointResolver:Jn({endpointOverride:t.identityPoolEndpoint})});let s;try{s=(await o({region:i},{IdentityPoolId:n,Logins:e})).IdentityId}catch(r){throw me(r),new R(r)}if(!s)throw new R({name:"GetIdResponseException",message:"Received undefined response from getId operation",recoverySuggestion:"Make sure to pass a valid identityPoolId in the configuration."});return s}const Qt=new Y("CognitoCredentialsProvider"),Xo=50*60*1e3;class gr{constructor(t){this._nextCredentialsRefresh=0,this._identityIdStore=t}async clearCredentialsAndIdentityId(){Qt.debug("Clearing out credentials and identityId"),this._credentialsAndIdentityId=void 0,await this._identityIdStore.clearIdentityId()}async clearCredentials(){Qt.debug("Clearing out in-memory credentials"),this._credentialsAndIdentityId=void 0}async getCredentialsAndIdentityId(t){const n=t.authenticated,{tokens:i}=t,{authConfig:o}=t;try{Jt(o==null?void 0:o.Cognito)}catch{return}if(!n&&!o.Cognito.allowGuestAccess)return;const{forceRefresh:s}=t,r=this.hasTokenChanged(i),a=await Ql({tokens:i,authConfig:o.Cognito,identityIdStore:this._identityIdStore});return(s||r)&&this.clearCredentials(),n?(Nu(i),this.credsForOIDCTokens(o.Cognito,i,a)):this.getGuestCredentials(a,o.Cognito)}async getGuestCredentials(t,n){var r,a;if(this._credentialsAndIdentityId&&!this.isPastTTL()&&this._credentialsAndIdentityId.isAuthenticatedCreds===!1)return Qt.info("returning stored credentials as they neither past TTL nor expired."),this._credentialsAndIdentityId;this.clearCredentials();const i=Gn(n.identityPoolId),o=po({endpointResolver:Jn({endpointOverride:n.identityPoolEndpoint})});let s;try{s=await o({region:i},{IdentityId:t})}catch(c){throw me(c),new R(c)}if((r=s==null?void 0:s.Credentials)!=null&&r.AccessKeyId&&((a=s==null?void 0:s.Credentials)!=null&&a.SecretKey)){this._nextCredentialsRefresh=new Date().getTime()+Xo;const c={credentials:{accessKeyId:s.Credentials.AccessKeyId,secretAccessKey:s.Credentials.SecretKey,sessionToken:s.Credentials.SessionToken,expiration:s.Credentials.Expiration},identityId:t};return s.IdentityId&&(c.identityId=s.IdentityId,this._identityIdStore.storeIdentityId({id:s.IdentityId,type:"guest"})),this._credentialsAndIdentityId={...c,isAuthenticatedCreds:!1},c}else throw new R({name:"CredentialsNotFoundException",message:"Cognito did not respond with either Credentials, AccessKeyId or SecretKey."})}async credsForOIDCTokens(t,n,i){var c,u,d;if(this._credentialsAndIdentityId&&!this.isPastTTL()&&this._credentialsAndIdentityId.isAuthenticatedCreds===!0)return Qt.debug("returning stored credentials as they neither past TTL nor expired."),this._credentialsAndIdentityId;this.clearCredentials();const o=n.idToken?Er(n.idToken.toString()):{},s=Gn(t.identityPoolId),r=po({endpointResolver:Jn({endpointOverride:t.identityPoolEndpoint})});let a;try{a=await r({region:s},{IdentityId:i,Logins:o})}catch(l){throw me(l),new R(l)}if((c=a==null?void 0:a.Credentials)!=null&&c.AccessKeyId&&((u=a==null?void 0:a.Credentials)!=null&&u.SecretKey)){this._nextCredentialsRefresh=new Date().getTime()+Xo;const l={credentials:{accessKeyId:a.Credentials.AccessKeyId,secretAccessKey:a.Credentials.SecretKey,sessionToken:a.Credentials.SessionToken,expiration:a.Credentials.Expiration},identityId:i};return a.IdentityId&&(l.identityId=a.IdentityId,this._identityIdStore.storeIdentityId({id:a.IdentityId,type:"primary"})),this._credentialsAndIdentityId={...l,isAuthenticatedCreds:!0,associatedIdToken:(d=n.idToken)==null?void 0:d.toString()},l}else throw new R({name:"CredentialsException",message:"Cognito did not respond with either Credentials, AccessKeyId or SecretKey."})}isPastTTL(){return this._nextCredentialsRefresh===void 0?!0:this._nextCredentialsRefresh<=Date.now()}hasTokenChanged(t){var n,i;return!!t&&!!((n=this._credentialsAndIdentityId)!=null&&n.associatedIdToken)&&((i=t.idToken)==null?void 0:i.toString())!==this._credentialsAndIdentityId.associatedIdToken}}const Jl=new gr(new mr(Kt)),im={configure(e,t){const n=Os(e),i=new bc({sameSite:"lax"}),o=t!=null&&t.ssr?i:Kt,s=t!=null&&t.ssr?new gr(new mr(i)):Jl;if(!n.Auth){V.configure(n,t);return}if(t!=null&&t.Auth){V.configure(n,t);return}if(!V.libraryOptions.Auth){Ct.setAuthConfig(n.Auth),Ct.setKeyValueStorage(o),V.configure(n,{...t,Auth:{tokenProvider:Ct,credentialsProvider:s}});return}if(t){const r=V.libraryOptions.Auth;t.ssr!==void 0&&(Ct.setKeyValueStorage(o),r.credentialsProvider=s),V.configure(n,{Auth:r,...t});return}V.configure(n)},getConfig(){return V.getConfig()}},om=Object.freeze(Object.defineProperty({__proto__:null,AuthError:R,confirmResetPassword:bl,confirmSignUp:Ol,decodeJWT:We,fetchAuthSession:pi,getCurrentUser:Si,resetPassword:Rl,signIn:Il,signOut:ql,signUp:Al},Symbol.toStringTag,{value:"Module"}));function en(e){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?en=function(n){return typeof n}:en=function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},en(e)}function Xl(e){return en(e)=="object"&&e!==null}var yr=typeof Symbol=="function"&&Symbol.toStringTag!=null?Symbol.toStringTag:"@@toStringTag";function Xn(e,t){for(var n=/\r\n|[\n\r]/g,i=1,o=t+1,s;(s=n.exec(e.body))&&s.index<t;)i+=1,o=t+1-(s.index+s[0].length);return{line:i,column:o}}function Zl(e){return Sr(e.source,Xn(e.source,e.start))}function Sr(e,t){var n=e.locationOffset.column-1,i=tn(n)+e.body,o=t.line-1,s=e.locationOffset.line-1,r=t.line+s,a=t.line===1?n:0,c=t.column+a,u="".concat(e.name,":").concat(r,":").concat(c,`
`),d=i.split(/\r\n|[\n\r]/g),l=d[o];if(l.length>120){for(var p=Math.floor(c/80),h=c%80,f=[],E=0;E<l.length;E+=80)f.push(l.slice(E,E+80));return u+Zo([["".concat(r),f[0]]].concat(f.slice(1,p+1).map(function(g){return["",g]}),[[" ",tn(h-1)+"^"],["",f[p+1]]]))}return u+Zo([["".concat(r-1),d[o-1]],["".concat(r),l],["",tn(c-1)+"^"],["".concat(r+1),d[o+1]]])}function Zo(e){var t=e.filter(function(i){i[0];var o=i[1];return o!==void 0}),n=Math.max.apply(Math,t.map(function(i){var o=i[0];return o.length}));return t.map(function(i){var o=i[0],s=i[1];return ep(n,o)+(s?" | "+s:" |")}).join(`
`)}function tn(e){return Array(e+1).join(" ")}function ep(e,t){return tn(e-t.length)+t}function nn(e){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?nn=function(n){return typeof n}:nn=function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},nn(e)}function es(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,i)}return n}function tp(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?es(Object(n),!0).forEach(function(i){np(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):es(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function np(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ip(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function op(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function sp(e,t,n){return t&&op(e.prototype,t),e}function rp(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Dt(e,t)}function ap(e){var t=vr();return function(){var i=kt(e),o;if(t){var s=kt(this).constructor;o=Reflect.construct(i,arguments,s)}else o=i.apply(this,arguments);return Ir(this,o)}}function Ir(e,t){return t&&(nn(t)==="object"||typeof t=="function")?t:Rt(e)}function Rt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Zn(e){var t=typeof Map=="function"?new Map:void 0;return Zn=function(i){if(i===null||!cp(i))return i;if(typeof i!="function")throw new TypeError("Super expression must either be null or a function");if(typeof t<"u"){if(t.has(i))return t.get(i);t.set(i,o)}function o(){return on(i,arguments,kt(this).constructor)}return o.prototype=Object.create(i.prototype,{constructor:{value:o,enumerable:!1,writable:!0,configurable:!0}}),Dt(o,i)},Zn(e)}function on(e,t,n){return vr()?on=Reflect.construct:on=function(o,s,r){var a=[null];a.push.apply(a,s);var c=Function.bind.apply(o,a),u=new c;return r&&Dt(u,r.prototype),u},on.apply(null,arguments)}function vr(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}function cp(e){return Function.toString.call(e).indexOf("[native code]")!==-1}function Dt(e,t){return Dt=Object.setPrototypeOf||function(i,o){return i.__proto__=o,i},Dt(e,t)}function kt(e){return kt=Object.setPrototypeOf?Object.getPrototypeOf:function(n){return n.__proto__||Object.getPrototypeOf(n)},kt(e)}var bt=function(e){rp(n,e);var t=ap(n);function n(i,o,s,r,a,c,u){var d,l,p,h;ip(this,n),h=t.call(this,i),h.name="GraphQLError",h.originalError=c??void 0,h.nodes=ts(Array.isArray(o)?o:o?[o]:void 0);for(var f=[],E=0,g=(y=h.nodes)!==null&&y!==void 0?y:[];E<g.length;E++){var y,I=g[E],T=I.loc;T!=null&&f.push(T)}f=ts(f),h.source=s??((d=f)===null||d===void 0?void 0:d[0].source),h.positions=r??((l=f)===null||l===void 0?void 0:l.map(function(S){return S.start})),h.locations=r&&s?r.map(function(S){return Xn(s,S)}):(p=f)===null||p===void 0?void 0:p.map(function(S){return Xn(S.source,S.start)}),h.path=a??void 0;var v=c==null?void 0:c.extensions;return u==null&&Xl(v)?h.extensions=tp({},v):h.extensions=u??{},Object.defineProperties(Rt(h),{message:{enumerable:!0},locations:{enumerable:h.locations!=null},path:{enumerable:h.path!=null},extensions:{enumerable:h.extensions!=null&&Object.keys(h.extensions).length>0},name:{enumerable:!1},nodes:{enumerable:!1},source:{enumerable:!1},positions:{enumerable:!1},originalError:{enumerable:!1}}),c!=null&&c.stack?(Object.defineProperty(Rt(h),"stack",{value:c.stack,writable:!0,configurable:!0}),Ir(h)):(Error.captureStackTrace?Error.captureStackTrace(Rt(h),n):Object.defineProperty(Rt(h),"stack",{value:Error().stack,writable:!0,configurable:!0}),h)}return sp(n,[{key:"toString",value:function(){return up(this)}},{key:yr,get:function(){return"Object"}}]),n}(Zn(Error));function ts(e){return e===void 0||e.length===0?void 0:e}function up(e){var t=e.message;if(e.nodes)for(var n=0,i=e.nodes;n<i.length;n++){var o=i[n];o.loc&&(t+=`

`+Zl(o.loc))}else if(e.source&&e.locations)for(var s=0,r=e.locations;s<r.length;s++){var a=r[s];t+=`

`+Sr(e.source,a)}return t}function oe(e,t,n){return new bt("Syntax Error: ".concat(n),void 0,e,[t])}var C=Object.freeze({NAME:"Name",DOCUMENT:"Document",OPERATION_DEFINITION:"OperationDefinition",VARIABLE_DEFINITION:"VariableDefinition",SELECTION_SET:"SelectionSet",FIELD:"Field",ARGUMENT:"Argument",FRAGMENT_SPREAD:"FragmentSpread",INLINE_FRAGMENT:"InlineFragment",FRAGMENT_DEFINITION:"FragmentDefinition",VARIABLE:"Variable",INT:"IntValue",FLOAT:"FloatValue",STRING:"StringValue",BOOLEAN:"BooleanValue",NULL:"NullValue",ENUM:"EnumValue",LIST:"ListValue",OBJECT:"ObjectValue",OBJECT_FIELD:"ObjectField",DIRECTIVE:"Directive",NAMED_TYPE:"NamedType",LIST_TYPE:"ListType",NON_NULL_TYPE:"NonNullType",SCHEMA_DEFINITION:"SchemaDefinition",OPERATION_TYPE_DEFINITION:"OperationTypeDefinition",SCALAR_TYPE_DEFINITION:"ScalarTypeDefinition",OBJECT_TYPE_DEFINITION:"ObjectTypeDefinition",FIELD_DEFINITION:"FieldDefinition",INPUT_VALUE_DEFINITION:"InputValueDefinition",INTERFACE_TYPE_DEFINITION:"InterfaceTypeDefinition",UNION_TYPE_DEFINITION:"UnionTypeDefinition",ENUM_TYPE_DEFINITION:"EnumTypeDefinition",ENUM_VALUE_DEFINITION:"EnumValueDefinition",INPUT_OBJECT_TYPE_DEFINITION:"InputObjectTypeDefinition",DIRECTIVE_DEFINITION:"DirectiveDefinition",SCHEMA_EXTENSION:"SchemaExtension",SCALAR_TYPE_EXTENSION:"ScalarTypeExtension",OBJECT_TYPE_EXTENSION:"ObjectTypeExtension",INTERFACE_TYPE_EXTENSION:"InterfaceTypeExtension",UNION_TYPE_EXTENSION:"UnionTypeExtension",ENUM_TYPE_EXTENSION:"EnumTypeExtension",INPUT_OBJECT_TYPE_EXTENSION:"InputObjectTypeExtension"});function dp(e,t){var n=!!e;if(!n)throw new Error("Unexpected invariant triggered.")}var ei=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):void 0;function Tr(e){var t=e.prototype.toJSON;typeof t=="function"||dp(0),e.prototype.inspect=t,ei&&(e.prototype[ei]=t)}var wr=function(){function e(n,i,o){this.start=n.start,this.end=i.end,this.startToken=n,this.endToken=i,this.source=o}var t=e.prototype;return t.toJSON=function(){return{start:this.start,end:this.end}},e}();Tr(wr);var H=function(){function e(n,i,o,s,r,a,c){this.kind=n,this.start=i,this.end=o,this.line=s,this.column=r,this.value=c,this.prev=a,this.next=null}var t=e.prototype;return t.toJSON=function(){return{kind:this.kind,value:this.value,line:this.line,column:this.column}},e}();Tr(H);function ns(e){return e!=null&&typeof e.kind=="string"}var m=Object.freeze({SOF:"<SOF>",EOF:"<EOF>",BANG:"!",DOLLAR:"$",AMP:"&",PAREN_L:"(",PAREN_R:")",SPREAD:"...",COLON:":",EQUALS:"=",AT:"@",BRACKET_L:"[",BRACKET_R:"]",BRACE_L:"{",PIPE:"|",BRACE_R:"}",NAME:"Name",INT:"Int",FLOAT:"Float",STRING:"String",BLOCK_STRING:"BlockString",COMMENT:"Comment"});function sn(e){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?sn=function(n){return typeof n}:sn=function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},sn(e)}var lp=10,Nr=2;function Ar(e){return Rn(e,[])}function Rn(e,t){switch(sn(e)){case"string":return JSON.stringify(e);case"function":return e.name?"[function ".concat(e.name,"]"):"[function]";case"object":return e===null?"null":pp(e,t);default:return String(e)}}function pp(e,t){if(t.indexOf(e)!==-1)return"[Circular]";var n=[].concat(t,[e]),i=mp(e);if(i!==void 0){var o=i.call(e);if(o!==e)return typeof o=="string"?o:Rn(o,n)}else if(Array.isArray(e))return fp(e,n);return hp(e,n)}function hp(e,t){var n=Object.keys(e);if(n.length===0)return"{}";if(t.length>Nr)return"["+Ep(e)+"]";var i=n.map(function(o){var s=Rn(e[o],t);return o+": "+s});return"{ "+i.join(", ")+" }"}function fp(e,t){if(e.length===0)return"[]";if(t.length>Nr)return"[Array]";for(var n=Math.min(lp,e.length),i=e.length-n,o=[],s=0;s<n;++s)o.push(Rn(e[s],t));return i===1?o.push("... 1 more item"):i>1&&o.push("... ".concat(i," more items")),"["+o.join(", ")+"]"}function mp(e){var t=e[String(ei)];if(typeof t=="function")return t;if(typeof e.inspect=="function")return e.inspect}function Ep(e){var t=Object.prototype.toString.call(e).replace(/^\[object /,"").replace(/]$/,"");if(t==="Object"&&typeof e.constructor=="function"){var n=e.constructor.name;if(typeof n=="string"&&n!=="")return n}return t}function Un(e,t){var n=!!e;if(!n)throw new Error(t)}const gp=function(t,n){return t instanceof n};function yp(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Sp(e,t,n){return t&&yp(e.prototype,t),e}var Cr=function(){function e(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"GraphQL request",i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{line:1,column:1};typeof t=="string"||Un(0,"Body must be a string. Received: ".concat(Ar(t),".")),this.body=t,this.name=n,this.locationOffset=i,this.locationOffset.line>0||Un(0,"line in locationOffset is 1-indexed and must be positive."),this.locationOffset.column>0||Un(0,"column in locationOffset is 1-indexed and must be positive.")}return Sp(e,[{key:yr,get:function(){return"Source"}}]),e}();function Ip(e){return gp(e,Cr)}var vp=Object.freeze({QUERY:"QUERY",MUTATION:"MUTATION",SUBSCRIPTION:"SUBSCRIPTION",FIELD:"FIELD",FRAGMENT_DEFINITION:"FRAGMENT_DEFINITION",FRAGMENT_SPREAD:"FRAGMENT_SPREAD",INLINE_FRAGMENT:"INLINE_FRAGMENT",VARIABLE_DEFINITION:"VARIABLE_DEFINITION",SCHEMA:"SCHEMA",SCALAR:"SCALAR",OBJECT:"OBJECT",FIELD_DEFINITION:"FIELD_DEFINITION",ARGUMENT_DEFINITION:"ARGUMENT_DEFINITION",INTERFACE:"INTERFACE",UNION:"UNION",ENUM:"ENUM",ENUM_VALUE:"ENUM_VALUE",INPUT_OBJECT:"INPUT_OBJECT",INPUT_FIELD_DEFINITION:"INPUT_FIELD_DEFINITION"});function Tp(e){var t=e.split(/\r\n|[\n\r]/g),n=wp(e);if(n!==0)for(var i=1;i<t.length;i++)t[i]=t[i].slice(n);for(var o=0;o<t.length&&is(t[o]);)++o;for(var s=t.length;s>o&&is(t[s-1]);)--s;return t.slice(o,s).join(`
`)}function is(e){for(var t=0;t<e.length;++t)if(e[t]!==" "&&e[t]!=="	")return!1;return!0}function wp(e){for(var t,n=!0,i=!0,o=0,s=null,r=0;r<e.length;++r)switch(e.charCodeAt(r)){case 13:e.charCodeAt(r+1)===10&&++r;case 10:n=!1,i=!0,o=0;break;case 9:case 32:++o;break;default:i&&!n&&(s===null||o<s)&&(s=o),i=!1}return(t=s)!==null&&t!==void 0?t:0}function Np(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=e.indexOf(`
`)===-1,o=e[0]===" "||e[0]==="	",s=e[e.length-1]==='"',r=e[e.length-1]==="\\",a=!i||s||r||n,c="";return a&&!(i&&o)&&(c+=`
`+t),c+=t?e.replace(/\n/g,`
`+t):e,a&&(c+=`
`),'"""'+c.replace(/"""/g,'\\"""')+'"""'}var Ap=function(){function e(n){var i=new H(m.SOF,0,0,0,0,null);this.source=n,this.lastToken=i,this.token=i,this.line=1,this.lineStart=0}var t=e.prototype;return t.advance=function(){this.lastToken=this.token;var i=this.token=this.lookahead();return i},t.lookahead=function(){var i=this.token;if(i.kind!==m.EOF)do{var o;i=(o=i.next)!==null&&o!==void 0?o:i.next=Rp(this,i)}while(i.kind===m.COMMENT);return i},e}();function Cp(e){return e===m.BANG||e===m.DOLLAR||e===m.AMP||e===m.PAREN_L||e===m.PAREN_R||e===m.SPREAD||e===m.COLON||e===m.EQUALS||e===m.AT||e===m.BRACKET_L||e===m.BRACKET_R||e===m.BRACE_L||e===m.PIPE||e===m.BRACE_R}function Qe(e){return isNaN(e)?m.EOF:e<127?JSON.stringify(String.fromCharCode(e)):'"\\u'.concat(("00"+e.toString(16).toUpperCase()).slice(-4),'"')}function Rp(e,t){for(var n=e.source,i=n.body,o=i.length,s=t.end;s<o;){var r=i.charCodeAt(s),a=e.line,c=1+s-e.lineStart;switch(r){case 65279:case 9:case 32:case 44:++s;continue;case 10:++s,++e.line,e.lineStart=s;continue;case 13:i.charCodeAt(s+1)===10?s+=2:++s,++e.line,e.lineStart=s;continue;case 33:return new H(m.BANG,s,s+1,a,c,t);case 35:return bp(n,s,a,c,t);case 36:return new H(m.DOLLAR,s,s+1,a,c,t);case 38:return new H(m.AMP,s,s+1,a,c,t);case 40:return new H(m.PAREN_L,s,s+1,a,c,t);case 41:return new H(m.PAREN_R,s,s+1,a,c,t);case 46:if(i.charCodeAt(s+1)===46&&i.charCodeAt(s+2)===46)return new H(m.SPREAD,s,s+3,a,c,t);break;case 58:return new H(m.COLON,s,s+1,a,c,t);case 61:return new H(m.EQUALS,s,s+1,a,c,t);case 64:return new H(m.AT,s,s+1,a,c,t);case 91:return new H(m.BRACKET_L,s,s+1,a,c,t);case 93:return new H(m.BRACKET_R,s,s+1,a,c,t);case 123:return new H(m.BRACE_L,s,s+1,a,c,t);case 124:return new H(m.PIPE,s,s+1,a,c,t);case 125:return new H(m.BRACE_R,s,s+1,a,c,t);case 34:return i.charCodeAt(s+1)===34&&i.charCodeAt(s+2)===34?Pp(n,s,a,c,t,e):Op(n,s,a,c,t);case 45:case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return xp(n,s,r,a,c,t);case 65:case 66:case 67:case 68:case 69:case 70:case 71:case 72:case 73:case 74:case 75:case 76:case 77:case 78:case 79:case 80:case 81:case 82:case 83:case 84:case 85:case 86:case 87:case 88:case 89:case 90:case 95:case 97:case 98:case 99:case 100:case 101:case 102:case 103:case 104:case 105:case 106:case 107:case 108:case 109:case 110:case 111:case 112:case 113:case 114:case 115:case 116:case 117:case 118:case 119:case 120:case 121:case 122:return kp(n,s,a,c,t)}throw oe(n,s,_p(r))}var u=e.line,d=1+s-e.lineStart;return new H(m.EOF,o,o,u,d,t)}function _p(e){return e<32&&e!==9&&e!==10&&e!==13?"Cannot contain the invalid character ".concat(Qe(e),"."):e===39?`Unexpected single quote character ('), did you mean to use a double quote (")?`:"Cannot parse the unexpected character ".concat(Qe(e),".")}function bp(e,t,n,i,o){var s=e.body,r,a=t;do r=s.charCodeAt(++a);while(!isNaN(r)&&(r>31||r===9));return new H(m.COMMENT,t,a,n,i,o,s.slice(t+1,a))}function xp(e,t,n,i,o,s){var r=e.body,a=n,c=t,u=!1;if(a===45&&(a=r.charCodeAt(++c)),a===48){if(a=r.charCodeAt(++c),a>=48&&a<=57)throw oe(e,c,"Invalid number, unexpected digit after 0: ".concat(Qe(a),"."))}else c=Kn(e,c,a),a=r.charCodeAt(c);if(a===46&&(u=!0,a=r.charCodeAt(++c),c=Kn(e,c,a),a=r.charCodeAt(c)),(a===69||a===101)&&(u=!0,a=r.charCodeAt(++c),(a===43||a===45)&&(a=r.charCodeAt(++c)),c=Kn(e,c,a),a=r.charCodeAt(c)),a===46||Mp(a))throw oe(e,c,"Invalid number, expected digit but got: ".concat(Qe(a),"."));return new H(u?m.FLOAT:m.INT,t,c,i,o,s,r.slice(t,c))}function Kn(e,t,n){var i=e.body,o=t,s=n;if(s>=48&&s<=57){do s=i.charCodeAt(++o);while(s>=48&&s<=57);return o}throw oe(e,o,"Invalid number, expected digit but got: ".concat(Qe(s),"."))}function Op(e,t,n,i,o){for(var s=e.body,r=t+1,a=r,c=0,u="";r<s.length&&!isNaN(c=s.charCodeAt(r))&&c!==10&&c!==13;){if(c===34)return u+=s.slice(a,r),new H(m.STRING,t,r+1,n,i,o,u);if(c<32&&c!==9)throw oe(e,r,"Invalid character within String: ".concat(Qe(c),"."));if(++r,c===92){switch(u+=s.slice(a,r-1),c=s.charCodeAt(r),c){case 34:u+='"';break;case 47:u+="/";break;case 92:u+="\\";break;case 98:u+="\b";break;case 102:u+="\f";break;case 110:u+=`
`;break;case 114:u+="\r";break;case 116:u+="	";break;case 117:{var d=Dp(s.charCodeAt(r+1),s.charCodeAt(r+2),s.charCodeAt(r+3),s.charCodeAt(r+4));if(d<0){var l=s.slice(r+1,r+5);throw oe(e,r,"Invalid character escape sequence: \\u".concat(l,"."))}u+=String.fromCharCode(d),r+=4;break}default:throw oe(e,r,"Invalid character escape sequence: \\".concat(String.fromCharCode(c),"."))}++r,a=r}}throw oe(e,r,"Unterminated string.")}function Pp(e,t,n,i,o,s){for(var r=e.body,a=t+3,c=a,u=0,d="";a<r.length&&!isNaN(u=r.charCodeAt(a));){if(u===34&&r.charCodeAt(a+1)===34&&r.charCodeAt(a+2)===34)return d+=r.slice(c,a),new H(m.BLOCK_STRING,t,a+3,n,i,o,Tp(d));if(u<32&&u!==9&&u!==10&&u!==13)throw oe(e,a,"Invalid character within String: ".concat(Qe(u),"."));u===10?(++a,++s.line,s.lineStart=a):u===13?(r.charCodeAt(a+1)===10?a+=2:++a,++s.line,s.lineStart=a):u===92&&r.charCodeAt(a+1)===34&&r.charCodeAt(a+2)===34&&r.charCodeAt(a+3)===34?(d+=r.slice(c,a)+'"""',a+=4,c=a):++a}throw oe(e,a,"Unterminated string.")}function Dp(e,t,n,i){return Yt(e)<<12|Yt(t)<<8|Yt(n)<<4|Yt(i)}function Yt(e){return e>=48&&e<=57?e-48:e>=65&&e<=70?e-55:e>=97&&e<=102?e-87:-1}function kp(e,t,n,i,o){for(var s=e.body,r=s.length,a=t+1,c=0;a!==r&&!isNaN(c=s.charCodeAt(a))&&(c===95||c>=48&&c<=57||c>=65&&c<=90||c>=97&&c<=122);)++a;return new H(m.NAME,t,a,n,i,o,s.slice(t,a))}function Mp(e){return e===95||e>=65&&e<=90||e>=97&&e<=122}function Bn(e,t){var n=new Fp(e,t);return n.parseDocument()}var Fp=function(){function e(n,i){var o=Ip(n)?n:new Cr(n);this._lexer=new Ap(o),this._options=i}var t=e.prototype;return t.parseName=function(){var i=this.expectToken(m.NAME);return{kind:C.NAME,value:i.value,loc:this.loc(i)}},t.parseDocument=function(){var i=this._lexer.token;return{kind:C.DOCUMENT,definitions:this.many(m.SOF,this.parseDefinition,m.EOF),loc:this.loc(i)}},t.parseDefinition=function(){if(this.peek(m.NAME))switch(this._lexer.token.value){case"query":case"mutation":case"subscription":return this.parseOperationDefinition();case"fragment":return this.parseFragmentDefinition();case"schema":case"scalar":case"type":case"interface":case"union":case"enum":case"input":case"directive":return this.parseTypeSystemDefinition();case"extend":return this.parseTypeSystemExtension()}else{if(this.peek(m.BRACE_L))return this.parseOperationDefinition();if(this.peekDescription())return this.parseTypeSystemDefinition()}throw this.unexpected()},t.parseOperationDefinition=function(){var i=this._lexer.token;if(this.peek(m.BRACE_L))return{kind:C.OPERATION_DEFINITION,operation:"query",name:void 0,variableDefinitions:[],directives:[],selectionSet:this.parseSelectionSet(),loc:this.loc(i)};var o=this.parseOperationType(),s;return this.peek(m.NAME)&&(s=this.parseName()),{kind:C.OPERATION_DEFINITION,operation:o,name:s,variableDefinitions:this.parseVariableDefinitions(),directives:this.parseDirectives(!1),selectionSet:this.parseSelectionSet(),loc:this.loc(i)}},t.parseOperationType=function(){var i=this.expectToken(m.NAME);switch(i.value){case"query":return"query";case"mutation":return"mutation";case"subscription":return"subscription"}throw this.unexpected(i)},t.parseVariableDefinitions=function(){return this.optionalMany(m.PAREN_L,this.parseVariableDefinition,m.PAREN_R)},t.parseVariableDefinition=function(){var i=this._lexer.token;return{kind:C.VARIABLE_DEFINITION,variable:this.parseVariable(),type:(this.expectToken(m.COLON),this.parseTypeReference()),defaultValue:this.expectOptionalToken(m.EQUALS)?this.parseValueLiteral(!0):void 0,directives:this.parseDirectives(!0),loc:this.loc(i)}},t.parseVariable=function(){var i=this._lexer.token;return this.expectToken(m.DOLLAR),{kind:C.VARIABLE,name:this.parseName(),loc:this.loc(i)}},t.parseSelectionSet=function(){var i=this._lexer.token;return{kind:C.SELECTION_SET,selections:this.many(m.BRACE_L,this.parseSelection,m.BRACE_R),loc:this.loc(i)}},t.parseSelection=function(){return this.peek(m.SPREAD)?this.parseFragment():this.parseField()},t.parseField=function(){var i=this._lexer.token,o=this.parseName(),s,r;return this.expectOptionalToken(m.COLON)?(s=o,r=this.parseName()):r=o,{kind:C.FIELD,alias:s,name:r,arguments:this.parseArguments(!1),directives:this.parseDirectives(!1),selectionSet:this.peek(m.BRACE_L)?this.parseSelectionSet():void 0,loc:this.loc(i)}},t.parseArguments=function(i){var o=i?this.parseConstArgument:this.parseArgument;return this.optionalMany(m.PAREN_L,o,m.PAREN_R)},t.parseArgument=function(){var i=this._lexer.token,o=this.parseName();return this.expectToken(m.COLON),{kind:C.ARGUMENT,name:o,value:this.parseValueLiteral(!1),loc:this.loc(i)}},t.parseConstArgument=function(){var i=this._lexer.token;return{kind:C.ARGUMENT,name:this.parseName(),value:(this.expectToken(m.COLON),this.parseValueLiteral(!0)),loc:this.loc(i)}},t.parseFragment=function(){var i=this._lexer.token;this.expectToken(m.SPREAD);var o=this.expectOptionalKeyword("on");return!o&&this.peek(m.NAME)?{kind:C.FRAGMENT_SPREAD,name:this.parseFragmentName(),directives:this.parseDirectives(!1),loc:this.loc(i)}:{kind:C.INLINE_FRAGMENT,typeCondition:o?this.parseNamedType():void 0,directives:this.parseDirectives(!1),selectionSet:this.parseSelectionSet(),loc:this.loc(i)}},t.parseFragmentDefinition=function(){var i,o=this._lexer.token;return this.expectKeyword("fragment"),((i=this._options)===null||i===void 0?void 0:i.experimentalFragmentVariables)===!0?{kind:C.FRAGMENT_DEFINITION,name:this.parseFragmentName(),variableDefinitions:this.parseVariableDefinitions(),typeCondition:(this.expectKeyword("on"),this.parseNamedType()),directives:this.parseDirectives(!1),selectionSet:this.parseSelectionSet(),loc:this.loc(o)}:{kind:C.FRAGMENT_DEFINITION,name:this.parseFragmentName(),typeCondition:(this.expectKeyword("on"),this.parseNamedType()),directives:this.parseDirectives(!1),selectionSet:this.parseSelectionSet(),loc:this.loc(o)}},t.parseFragmentName=function(){if(this._lexer.token.value==="on")throw this.unexpected();return this.parseName()},t.parseValueLiteral=function(i){var o=this._lexer.token;switch(o.kind){case m.BRACKET_L:return this.parseList(i);case m.BRACE_L:return this.parseObject(i);case m.INT:return this._lexer.advance(),{kind:C.INT,value:o.value,loc:this.loc(o)};case m.FLOAT:return this._lexer.advance(),{kind:C.FLOAT,value:o.value,loc:this.loc(o)};case m.STRING:case m.BLOCK_STRING:return this.parseStringLiteral();case m.NAME:switch(this._lexer.advance(),o.value){case"true":return{kind:C.BOOLEAN,value:!0,loc:this.loc(o)};case"false":return{kind:C.BOOLEAN,value:!1,loc:this.loc(o)};case"null":return{kind:C.NULL,loc:this.loc(o)};default:return{kind:C.ENUM,value:o.value,loc:this.loc(o)}}case m.DOLLAR:if(!i)return this.parseVariable();break}throw this.unexpected()},t.parseStringLiteral=function(){var i=this._lexer.token;return this._lexer.advance(),{kind:C.STRING,value:i.value,block:i.kind===m.BLOCK_STRING,loc:this.loc(i)}},t.parseList=function(i){var o=this,s=this._lexer.token,r=function(){return o.parseValueLiteral(i)};return{kind:C.LIST,values:this.any(m.BRACKET_L,r,m.BRACKET_R),loc:this.loc(s)}},t.parseObject=function(i){var o=this,s=this._lexer.token,r=function(){return o.parseObjectField(i)};return{kind:C.OBJECT,fields:this.any(m.BRACE_L,r,m.BRACE_R),loc:this.loc(s)}},t.parseObjectField=function(i){var o=this._lexer.token,s=this.parseName();return this.expectToken(m.COLON),{kind:C.OBJECT_FIELD,name:s,value:this.parseValueLiteral(i),loc:this.loc(o)}},t.parseDirectives=function(i){for(var o=[];this.peek(m.AT);)o.push(this.parseDirective(i));return o},t.parseDirective=function(i){var o=this._lexer.token;return this.expectToken(m.AT),{kind:C.DIRECTIVE,name:this.parseName(),arguments:this.parseArguments(i),loc:this.loc(o)}},t.parseTypeReference=function(){var i=this._lexer.token,o;return this.expectOptionalToken(m.BRACKET_L)?(o=this.parseTypeReference(),this.expectToken(m.BRACKET_R),o={kind:C.LIST_TYPE,type:o,loc:this.loc(i)}):o=this.parseNamedType(),this.expectOptionalToken(m.BANG)?{kind:C.NON_NULL_TYPE,type:o,loc:this.loc(i)}:o},t.parseNamedType=function(){var i=this._lexer.token;return{kind:C.NAMED_TYPE,name:this.parseName(),loc:this.loc(i)}},t.parseTypeSystemDefinition=function(){var i=this.peekDescription()?this._lexer.lookahead():this._lexer.token;if(i.kind===m.NAME)switch(i.value){case"schema":return this.parseSchemaDefinition();case"scalar":return this.parseScalarTypeDefinition();case"type":return this.parseObjectTypeDefinition();case"interface":return this.parseInterfaceTypeDefinition();case"union":return this.parseUnionTypeDefinition();case"enum":return this.parseEnumTypeDefinition();case"input":return this.parseInputObjectTypeDefinition();case"directive":return this.parseDirectiveDefinition()}throw this.unexpected(i)},t.peekDescription=function(){return this.peek(m.STRING)||this.peek(m.BLOCK_STRING)},t.parseDescription=function(){if(this.peekDescription())return this.parseStringLiteral()},t.parseSchemaDefinition=function(){var i=this._lexer.token,o=this.parseDescription();this.expectKeyword("schema");var s=this.parseDirectives(!0),r=this.many(m.BRACE_L,this.parseOperationTypeDefinition,m.BRACE_R);return{kind:C.SCHEMA_DEFINITION,description:o,directives:s,operationTypes:r,loc:this.loc(i)}},t.parseOperationTypeDefinition=function(){var i=this._lexer.token,o=this.parseOperationType();this.expectToken(m.COLON);var s=this.parseNamedType();return{kind:C.OPERATION_TYPE_DEFINITION,operation:o,type:s,loc:this.loc(i)}},t.parseScalarTypeDefinition=function(){var i=this._lexer.token,o=this.parseDescription();this.expectKeyword("scalar");var s=this.parseName(),r=this.parseDirectives(!0);return{kind:C.SCALAR_TYPE_DEFINITION,description:o,name:s,directives:r,loc:this.loc(i)}},t.parseObjectTypeDefinition=function(){var i=this._lexer.token,o=this.parseDescription();this.expectKeyword("type");var s=this.parseName(),r=this.parseImplementsInterfaces(),a=this.parseDirectives(!0),c=this.parseFieldsDefinition();return{kind:C.OBJECT_TYPE_DEFINITION,description:o,name:s,interfaces:r,directives:a,fields:c,loc:this.loc(i)}},t.parseImplementsInterfaces=function(){var i;if(!this.expectOptionalKeyword("implements"))return[];if(((i=this._options)===null||i===void 0?void 0:i.allowLegacySDLImplementsInterfaces)===!0){var o=[];this.expectOptionalToken(m.AMP);do o.push(this.parseNamedType());while(this.expectOptionalToken(m.AMP)||this.peek(m.NAME));return o}return this.delimitedMany(m.AMP,this.parseNamedType)},t.parseFieldsDefinition=function(){var i;return((i=this._options)===null||i===void 0?void 0:i.allowLegacySDLEmptyFields)===!0&&this.peek(m.BRACE_L)&&this._lexer.lookahead().kind===m.BRACE_R?(this._lexer.advance(),this._lexer.advance(),[]):this.optionalMany(m.BRACE_L,this.parseFieldDefinition,m.BRACE_R)},t.parseFieldDefinition=function(){var i=this._lexer.token,o=this.parseDescription(),s=this.parseName(),r=this.parseArgumentDefs();this.expectToken(m.COLON);var a=this.parseTypeReference(),c=this.parseDirectives(!0);return{kind:C.FIELD_DEFINITION,description:o,name:s,arguments:r,type:a,directives:c,loc:this.loc(i)}},t.parseArgumentDefs=function(){return this.optionalMany(m.PAREN_L,this.parseInputValueDef,m.PAREN_R)},t.parseInputValueDef=function(){var i=this._lexer.token,o=this.parseDescription(),s=this.parseName();this.expectToken(m.COLON);var r=this.parseTypeReference(),a;this.expectOptionalToken(m.EQUALS)&&(a=this.parseValueLiteral(!0));var c=this.parseDirectives(!0);return{kind:C.INPUT_VALUE_DEFINITION,description:o,name:s,type:r,defaultValue:a,directives:c,loc:this.loc(i)}},t.parseInterfaceTypeDefinition=function(){var i=this._lexer.token,o=this.parseDescription();this.expectKeyword("interface");var s=this.parseName(),r=this.parseImplementsInterfaces(),a=this.parseDirectives(!0),c=this.parseFieldsDefinition();return{kind:C.INTERFACE_TYPE_DEFINITION,description:o,name:s,interfaces:r,directives:a,fields:c,loc:this.loc(i)}},t.parseUnionTypeDefinition=function(){var i=this._lexer.token,o=this.parseDescription();this.expectKeyword("union");var s=this.parseName(),r=this.parseDirectives(!0),a=this.parseUnionMemberTypes();return{kind:C.UNION_TYPE_DEFINITION,description:o,name:s,directives:r,types:a,loc:this.loc(i)}},t.parseUnionMemberTypes=function(){return this.expectOptionalToken(m.EQUALS)?this.delimitedMany(m.PIPE,this.parseNamedType):[]},t.parseEnumTypeDefinition=function(){var i=this._lexer.token,o=this.parseDescription();this.expectKeyword("enum");var s=this.parseName(),r=this.parseDirectives(!0),a=this.parseEnumValuesDefinition();return{kind:C.ENUM_TYPE_DEFINITION,description:o,name:s,directives:r,values:a,loc:this.loc(i)}},t.parseEnumValuesDefinition=function(){return this.optionalMany(m.BRACE_L,this.parseEnumValueDefinition,m.BRACE_R)},t.parseEnumValueDefinition=function(){var i=this._lexer.token,o=this.parseDescription(),s=this.parseName(),r=this.parseDirectives(!0);return{kind:C.ENUM_VALUE_DEFINITION,description:o,name:s,directives:r,loc:this.loc(i)}},t.parseInputObjectTypeDefinition=function(){var i=this._lexer.token,o=this.parseDescription();this.expectKeyword("input");var s=this.parseName(),r=this.parseDirectives(!0),a=this.parseInputFieldsDefinition();return{kind:C.INPUT_OBJECT_TYPE_DEFINITION,description:o,name:s,directives:r,fields:a,loc:this.loc(i)}},t.parseInputFieldsDefinition=function(){return this.optionalMany(m.BRACE_L,this.parseInputValueDef,m.BRACE_R)},t.parseTypeSystemExtension=function(){var i=this._lexer.lookahead();if(i.kind===m.NAME)switch(i.value){case"schema":return this.parseSchemaExtension();case"scalar":return this.parseScalarTypeExtension();case"type":return this.parseObjectTypeExtension();case"interface":return this.parseInterfaceTypeExtension();case"union":return this.parseUnionTypeExtension();case"enum":return this.parseEnumTypeExtension();case"input":return this.parseInputObjectTypeExtension()}throw this.unexpected(i)},t.parseSchemaExtension=function(){var i=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("schema");var o=this.parseDirectives(!0),s=this.optionalMany(m.BRACE_L,this.parseOperationTypeDefinition,m.BRACE_R);if(o.length===0&&s.length===0)throw this.unexpected();return{kind:C.SCHEMA_EXTENSION,directives:o,operationTypes:s,loc:this.loc(i)}},t.parseScalarTypeExtension=function(){var i=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("scalar");var o=this.parseName(),s=this.parseDirectives(!0);if(s.length===0)throw this.unexpected();return{kind:C.SCALAR_TYPE_EXTENSION,name:o,directives:s,loc:this.loc(i)}},t.parseObjectTypeExtension=function(){var i=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("type");var o=this.parseName(),s=this.parseImplementsInterfaces(),r=this.parseDirectives(!0),a=this.parseFieldsDefinition();if(s.length===0&&r.length===0&&a.length===0)throw this.unexpected();return{kind:C.OBJECT_TYPE_EXTENSION,name:o,interfaces:s,directives:r,fields:a,loc:this.loc(i)}},t.parseInterfaceTypeExtension=function(){var i=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("interface");var o=this.parseName(),s=this.parseImplementsInterfaces(),r=this.parseDirectives(!0),a=this.parseFieldsDefinition();if(s.length===0&&r.length===0&&a.length===0)throw this.unexpected();return{kind:C.INTERFACE_TYPE_EXTENSION,name:o,interfaces:s,directives:r,fields:a,loc:this.loc(i)}},t.parseUnionTypeExtension=function(){var i=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("union");var o=this.parseName(),s=this.parseDirectives(!0),r=this.parseUnionMemberTypes();if(s.length===0&&r.length===0)throw this.unexpected();return{kind:C.UNION_TYPE_EXTENSION,name:o,directives:s,types:r,loc:this.loc(i)}},t.parseEnumTypeExtension=function(){var i=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("enum");var o=this.parseName(),s=this.parseDirectives(!0),r=this.parseEnumValuesDefinition();if(s.length===0&&r.length===0)throw this.unexpected();return{kind:C.ENUM_TYPE_EXTENSION,name:o,directives:s,values:r,loc:this.loc(i)}},t.parseInputObjectTypeExtension=function(){var i=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("input");var o=this.parseName(),s=this.parseDirectives(!0),r=this.parseInputFieldsDefinition();if(s.length===0&&r.length===0)throw this.unexpected();return{kind:C.INPUT_OBJECT_TYPE_EXTENSION,name:o,directives:s,fields:r,loc:this.loc(i)}},t.parseDirectiveDefinition=function(){var i=this._lexer.token,o=this.parseDescription();this.expectKeyword("directive"),this.expectToken(m.AT);var s=this.parseName(),r=this.parseArgumentDefs(),a=this.expectOptionalKeyword("repeatable");this.expectKeyword("on");var c=this.parseDirectiveLocations();return{kind:C.DIRECTIVE_DEFINITION,description:o,name:s,arguments:r,repeatable:a,locations:c,loc:this.loc(i)}},t.parseDirectiveLocations=function(){return this.delimitedMany(m.PIPE,this.parseDirectiveLocation)},t.parseDirectiveLocation=function(){var i=this._lexer.token,o=this.parseName();if(vp[o.value]!==void 0)return o;throw this.unexpected(i)},t.loc=function(i){var o;if(((o=this._options)===null||o===void 0?void 0:o.noLocation)!==!0)return new wr(i,this._lexer.lastToken,this._lexer.source)},t.peek=function(i){return this._lexer.token.kind===i},t.expectToken=function(i){var o=this._lexer.token;if(o.kind===i)return this._lexer.advance(),o;throw oe(this._lexer.source,o.start,"Expected ".concat(Rr(i),", found ").concat(Vn(o),"."))},t.expectOptionalToken=function(i){var o=this._lexer.token;if(o.kind===i)return this._lexer.advance(),o},t.expectKeyword=function(i){var o=this._lexer.token;if(o.kind===m.NAME&&o.value===i)this._lexer.advance();else throw oe(this._lexer.source,o.start,'Expected "'.concat(i,'", found ').concat(Vn(o),"."))},t.expectOptionalKeyword=function(i){var o=this._lexer.token;return o.kind===m.NAME&&o.value===i?(this._lexer.advance(),!0):!1},t.unexpected=function(i){var o=i??this._lexer.token;return oe(this._lexer.source,o.start,"Unexpected ".concat(Vn(o),"."))},t.any=function(i,o,s){this.expectToken(i);for(var r=[];!this.expectOptionalToken(s);)r.push(o.call(this));return r},t.optionalMany=function(i,o,s){if(this.expectOptionalToken(i)){var r=[];do r.push(o.call(this));while(!this.expectOptionalToken(s));return r}return[]},t.many=function(i,o,s){this.expectToken(i);var r=[];do r.push(o.call(this));while(!this.expectOptionalToken(s));return r},t.delimitedMany=function(i,o){this.expectOptionalToken(i);var s=[];do s.push(o.call(this));while(this.expectOptionalToken(i));return s},e}();function Vn(e){var t=e.value;return Rr(e.kind)+(t!=null?' "'.concat(t,'"'):"")}function Rr(e){return Cp(e)?'"'.concat(e,'"'):e}var Lp={Name:[],Document:["definitions"],OperationDefinition:["name","variableDefinitions","directives","selectionSet"],VariableDefinition:["variable","type","defaultValue","directives"],Variable:["name"],SelectionSet:["selections"],Field:["alias","name","arguments","directives","selectionSet"],Argument:["name","value"],FragmentSpread:["name","directives"],InlineFragment:["typeCondition","directives","selectionSet"],FragmentDefinition:["name","variableDefinitions","typeCondition","directives","selectionSet"],IntValue:[],FloatValue:[],StringValue:[],BooleanValue:[],NullValue:[],EnumValue:[],ListValue:["values"],ObjectValue:["fields"],ObjectField:["name","value"],Directive:["name","arguments"],NamedType:["name"],ListType:["type"],NonNullType:["type"],SchemaDefinition:["description","directives","operationTypes"],OperationTypeDefinition:["type"],ScalarTypeDefinition:["description","name","directives"],ObjectTypeDefinition:["description","name","interfaces","directives","fields"],FieldDefinition:["description","name","arguments","type","directives"],InputValueDefinition:["description","name","type","defaultValue","directives"],InterfaceTypeDefinition:["description","name","interfaces","directives","fields"],UnionTypeDefinition:["description","name","directives","types"],EnumTypeDefinition:["description","name","directives","values"],EnumValueDefinition:["description","name","directives"],InputObjectTypeDefinition:["description","name","directives","fields"],DirectiveDefinition:["description","name","arguments","locations"],SchemaExtension:["directives","operationTypes"],ScalarTypeExtension:["name","directives"],ObjectTypeExtension:["name","interfaces","directives","fields"],InterfaceTypeExtension:["name","interfaces","directives","fields"],UnionTypeExtension:["name","directives","types"],EnumTypeExtension:["name","directives","values"],InputObjectTypeExtension:["name","directives","fields"]},Up=Object.freeze({});function Kp(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Lp,i=void 0,o=Array.isArray(e),s=[e],r=-1,a=[],c=void 0,u=void 0,d=void 0,l=[],p=[],h=e;do{r++;var f=r===s.length,E=f&&a.length!==0;if(f){if(u=p.length===0?void 0:l[l.length-1],c=d,d=p.pop(),E){if(o)c=c.slice();else{for(var g={},y=0,I=Object.keys(c);y<I.length;y++){var T=I[y];g[T]=c[T]}c=g}for(var v=0,S=0;S<a.length;S++){var A=a[S][0],O=a[S][1];o&&(A-=v),o&&O===null?(c.splice(A,1),v++):c[A]=O}}r=i.index,s=i.keys,a=i.edits,o=i.inArray,i=i.prev}else{if(u=d?o?r:s[r]:void 0,c=d?d[u]:h,c==null)continue;d&&l.push(u)}var D=void 0;if(!Array.isArray(c)){if(!ns(c))throw new Error("Invalid AST Node: ".concat(Ar(c),"."));var k=Bp(t,c.kind,f);if(k){if(D=k.call(t,c,u,d,l,p),D===Up)break;if(D===!1){if(!f){l.pop();continue}}else if(D!==void 0&&(a.push([u,D]),!f))if(ns(D))c=D;else{l.pop();continue}}}if(D===void 0&&E&&a.push([u,c]),f)l.pop();else{var K;i={inArray:o,index:r,keys:s,edits:a,prev:i},o=Array.isArray(c),s=o?c:(K=n[c.kind])!==null&&K!==void 0?K:[],r=-1,a=[],d&&p.push(d),d=c}}while(i!==void 0);return a.length!==0&&(h=a[a.length-1][1]),h}function Bp(e,t,n){var i=e[t];if(i){if(!n&&typeof i=="function")return i;var o=n?i.leave:i.enter;if(typeof o=="function")return o}else{var s=n?e.leave:e.enter;if(s){if(typeof s=="function")return s;var r=s[t];if(typeof r=="function")return r}}}function Tt(e){return Kp(e,{leave:$p})}var Vp=80,$p={Name:function(t){return t.value},Variable:function(t){return"$"+t.name},Document:function(t){return N(t.definitions,`

`)+`
`},OperationDefinition:function(t){var n=t.operation,i=t.name,o=$("(",N(t.variableDefinitions,", "),")"),s=N(t.directives," "),r=t.selectionSet;return!i&&!s&&!o&&n==="query"?r:N([n,N([i,o]),s,r]," ")},VariableDefinition:function(t){var n=t.variable,i=t.type,o=t.defaultValue,s=t.directives;return n+": "+i+$(" = ",o)+$(" ",N(s," "))},SelectionSet:function(t){var n=t.selections;return he(n)},Field:function(t){var n=t.alias,i=t.name,o=t.arguments,s=t.directives,r=t.selectionSet,a=$("",n,": ")+i,c=a+$("(",N(o,", "),")");return c.length>Vp&&(c=a+$(`(
`,rn(N(o,`
`)),`
)`)),N([c,N(s," "),r]," ")},Argument:function(t){var n=t.name,i=t.value;return n+": "+i},FragmentSpread:function(t){var n=t.name,i=t.directives;return"..."+n+$(" ",N(i," "))},InlineFragment:function(t){var n=t.typeCondition,i=t.directives,o=t.selectionSet;return N(["...",$("on ",n),N(i," "),o]," ")},FragmentDefinition:function(t){var n=t.name,i=t.typeCondition,o=t.variableDefinitions,s=t.directives,r=t.selectionSet;return"fragment ".concat(n).concat($("(",N(o,", "),")")," ")+"on ".concat(i," ").concat($("",N(s," ")," "))+r},IntValue:function(t){var n=t.value;return n},FloatValue:function(t){var n=t.value;return n},StringValue:function(t,n){var i=t.value,o=t.block;return o?Np(i,n==="description"?"":"  "):JSON.stringify(i)},BooleanValue:function(t){var n=t.value;return n?"true":"false"},NullValue:function(){return"null"},EnumValue:function(t){var n=t.value;return n},ListValue:function(t){var n=t.values;return"["+N(n,", ")+"]"},ObjectValue:function(t){var n=t.fields;return"{"+N(n,", ")+"}"},ObjectField:function(t){var n=t.name,i=t.value;return n+": "+i},Directive:function(t){var n=t.name,i=t.arguments;return"@"+n+$("(",N(i,", "),")")},NamedType:function(t){var n=t.name;return n},ListType:function(t){var n=t.type;return"["+n+"]"},NonNullType:function(t){var n=t.type;return n+"!"},SchemaDefinition:pe(function(e){var t=e.directives,n=e.operationTypes;return N(["schema",N(t," "),he(n)]," ")}),OperationTypeDefinition:function(t){var n=t.operation,i=t.type;return n+": "+i},ScalarTypeDefinition:pe(function(e){var t=e.name,n=e.directives;return N(["scalar",t,N(n," ")]," ")}),ObjectTypeDefinition:pe(function(e){var t=e.name,n=e.interfaces,i=e.directives,o=e.fields;return N(["type",t,$("implements ",N(n," & ")),N(i," "),he(o)]," ")}),FieldDefinition:pe(function(e){var t=e.name,n=e.arguments,i=e.type,o=e.directives;return t+(os(n)?$(`(
`,rn(N(n,`
`)),`
)`):$("(",N(n,", "),")"))+": "+i+$(" ",N(o," "))}),InputValueDefinition:pe(function(e){var t=e.name,n=e.type,i=e.defaultValue,o=e.directives;return N([t+": "+n,$("= ",i),N(o," ")]," ")}),InterfaceTypeDefinition:pe(function(e){var t=e.name,n=e.interfaces,i=e.directives,o=e.fields;return N(["interface",t,$("implements ",N(n," & ")),N(i," "),he(o)]," ")}),UnionTypeDefinition:pe(function(e){var t=e.name,n=e.directives,i=e.types;return N(["union",t,N(n," "),i&&i.length!==0?"= "+N(i," | "):""]," ")}),EnumTypeDefinition:pe(function(e){var t=e.name,n=e.directives,i=e.values;return N(["enum",t,N(n," "),he(i)]," ")}),EnumValueDefinition:pe(function(e){var t=e.name,n=e.directives;return N([t,N(n," ")]," ")}),InputObjectTypeDefinition:pe(function(e){var t=e.name,n=e.directives,i=e.fields;return N(["input",t,N(n," "),he(i)]," ")}),DirectiveDefinition:pe(function(e){var t=e.name,n=e.arguments,i=e.repeatable,o=e.locations;return"directive @"+t+(os(n)?$(`(
`,rn(N(n,`
`)),`
)`):$("(",N(n,", "),")"))+(i?" repeatable":"")+" on "+N(o," | ")}),SchemaExtension:function(t){var n=t.directives,i=t.operationTypes;return N(["extend schema",N(n," "),he(i)]," ")},ScalarTypeExtension:function(t){var n=t.name,i=t.directives;return N(["extend scalar",n,N(i," ")]," ")},ObjectTypeExtension:function(t){var n=t.name,i=t.interfaces,o=t.directives,s=t.fields;return N(["extend type",n,$("implements ",N(i," & ")),N(o," "),he(s)]," ")},InterfaceTypeExtension:function(t){var n=t.name,i=t.interfaces,o=t.directives,s=t.fields;return N(["extend interface",n,$("implements ",N(i," & ")),N(o," "),he(s)]," ")},UnionTypeExtension:function(t){var n=t.name,i=t.directives,o=t.types;return N(["extend union",n,N(i," "),o&&o.length!==0?"= "+N(o," | "):""]," ")},EnumTypeExtension:function(t){var n=t.name,i=t.directives,o=t.values;return N(["extend enum",n,N(i," "),he(o)]," ")},InputObjectTypeExtension:function(t){var n=t.name,i=t.directives,o=t.fields;return N(["extend input",n,N(i," "),he(o)]," ")}};function pe(e){return function(t){return N([t.description,e(t)],`
`)}}function N(e){var t,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";return(t=e==null?void 0:e.filter(function(i){return i}).join(n))!==null&&t!==void 0?t:""}function he(e){return $(`{
`,rn(N(e,`
`)),`
}`)}function $(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";return t!=null&&t!==""?e+t+n:""}function rn(e){return $("  ",e.replace(/\n/g,`
  `))}function qp(e){return e.indexOf(`
`)!==-1}function os(e){return e!=null&&e.some(qp)}class Mt extends pn{constructor(t){super(t),this.constructor=Mt,Object.setPrototypeOf(this,Mt.prototype)}}class Ft extends Mt{constructor(t={}){super({name:"CanceledError",message:"Request is canceled by user",...t}),this.constructor=Ft,Object.setPrototypeOf(this,Ft.prototype)}}const Hp=e=>!!e&&e instanceof Ft;var ti;(function(e){e.InvalidApiName="InvalidApiName"})(ti||(ti={}));ti.InvalidApiName+"";const _r=async e=>{var n;if(!e)return;const t=await Je(Wp(e));if(t){const i=await((n=e.body)==null?void 0:n.text());return jp(t,{statusCode:e.statusCode,headers:e.headers,body:i})}},Wp=e=>{let t;const n=new Proxy(e.body,{get(o,s,r){return s==="json"?async()=>{t||(t=o.text());try{return JSON.parse(await t)}catch{return{}}}:s==="text"?async()=>(t||(t=o.text()),t):Reflect.get(o,s,r)}});return new Proxy(e,{get(o,s,r){return s==="body"?n:Reflect.get(o,s,r)}})},jp=(e,t)=>{const n=new Mt({name:e==null?void 0:e.name,message:e.message,underlyingError:e,response:t});return Object.assign(n,{$metadata:e.$metadata})},ni=new Y("RestApis");function Gp(e,t){const n=c=>!!t,i=new AbortController,o=i.signal,s=t==null?void 0:t.signal;let r;const a=async()=>{try{const c=await(n(e)?e():e(o));if(c.statusCode>=300)throw await _r(c);return c}catch(c){const u=s??o,d=r??u.reason;if(c.name==="AbortError"||(u==null?void 0:u.aborted)===!0){const l=new Ft({...d&&{message:d},underlyingError:c,recoverySuggestion:"The API request was explicitly canceled. If this is not intended, validate if you called the `cancel()` function on the API request erroneously."});throw ni.debug(c),l}throw ni.debug(c),c}};if(n())return a();{const c=u=>{o.aborted!==!0&&(i.abort(u),u&&o.reason!==u&&(r=u))};return{response:a(),cancel:c}}}const ss="execute-api",zp="us-east-1",Qp=/^.+\.([a-z0-9-]+)\.([a-z0-9-]+)\.amazonaws\.com/,Yp=(e,t)=>{const{service:n=ss,region:i=zp}={},{hostname:o}=e,[,s,r]=Qp.exec(o)??[];return s===ss?{service:s,region:r??i}:s==="appsync-api"?{service:"appsync",region:r??i}:{service:n,region:i}},Jp=({headers:e},t)=>!e.authorization&&!e["x-api-key"]&&!!t,Xp=(e,t)=>{const n={};for(const i in e)n[i.toLowerCase()]=e[i];return t&&(n["content-type"]="application/json; charset=UTF-8",t instanceof FormData&&delete n["content-type"]),n},Zp=Ut(gi,[Ei,mi,nu]),eh=Ut(gi,[Ei,mi]),th=async(e,t,n,i)=>{var I,T,v;const{url:o,method:s,headers:r,body:a,withCredentials:c,abortSignal:u,retryStrategy:d}=t,l=a?a instanceof FormData?a:JSON.stringify(a??""):void 0,p=Xp(r,a),h={url:o,headers:p,method:s,body:l},f={retryDecider:nh(d??((v=(T=(I=e==null?void 0:e.libraryOptions)==null?void 0:I.API)==null?void 0:T.REST)==null?void 0:v.retryStrategy)),computeDelay:hi,withCrossDomainCredentials:c,abortSignal:u},E=n(h,i);let g;const y=await ih(e);if(E&&y){const S=Yp(o),A=(i==null?void 0:i.service)??S.service,O=(i==null?void 0:i.region)??S.region;g=await Zp(h,{...f,credentials:y,region:O,service:A})}else g=await eh(h,{...f});return{statusCode:g.statusCode,headers:g.headers,body:g.body}},nh=e=>(e==null?void 0:e.strategy)==="no-retry"?()=>Promise.resolve({retryable:!1}):fi(_r),ih=async e=>{try{const{credentials:t}=await e.Auth.fetchAuthSession();if(t)return t}catch{ni.debug("No credentials available, the request will be unsigned.")}return null},bi=new WeakMap,oh=(e,{url:t,options:n,abortController:i})=>{const o=i??new AbortController,r=Gp(async()=>th(e,{url:t,method:"POST",...n,abortSignal:o.signal,retryStrategy:{strategy:"jittered-exponential-backoff"}},Jp,n==null?void 0:n.signingServiceInfo),o).finally(()=>{bi.delete(r)});return r},sh=(e,t)=>{const n=bi.get(e);return n?(n.abort(t),t&&n.signal.reason!==t&&(n.signal.reason=t),!0):!1},rh=(e,t)=>{bi.set(e,t)},ah=5e3,ch=[400,401,403],uh=["BadRequestException","UnauthorizedException"],dh="ConnectionStateChange";var ce;(function(e){e.GQL_CONNECTION_INIT="connection_init",e.GQL_CONNECTION_ERROR="connection_error",e.GQL_CONNECTION_ACK="connection_ack",e.GQL_START="start",e.GQL_START_ACK="start_ack",e.DATA="data",e.GQL_CONNECTION_KEEP_ALIVE="ka",e.GQL_STOP="stop",e.GQL_COMPLETE="complete",e.GQL_ERROR="error",e.EVENT_SUBSCRIBE="subscribe",e.EVENT_PUBLISH="publish",e.EVENT_SUBSCRIBE_ACK="subscribe_success",e.EVENT_PUBLISH_ACK="publish_success",e.EVENT_STOP="unsubscribe",e.EVENT_COMPLETE="unsubscribe_success"})(ce||(ce={}));var Ce;(function(e){e[e.PENDING=0]="PENDING",e[e.CONNECTED=1]="CONNECTED",e[e.FAILED=2]="FAILED"})(Ce||(Ce={}));var te;(function(e){e[e.CLOSED=0]="CLOSED",e[e.READY=1]="READY",e[e.CONNECTING=2]="CONNECTING"})(te||(te={}));const lh={accept:"application/json, text/javascript","content-encoding":"amz-1.0","content-type":"application/json; charset=UTF-8"},rs=15e3,ph=15e3,hh=5*60*1e3,fh=5*1e3,mh=65*1e3,Eh=5*1e3,gh=60*1e3;var fe;(function(e){e.CONNECTION_CLOSED="Connection closed",e.CONNECTION_FAILED="Connection failed",e.REALTIME_SUBSCRIPTION_INIT_ERROR="AppSync Realtime subscription init error",e.SUBSCRIPTION_ACK="Subscription ack",e.TIMEOUT_DISCONNECT="Timeout disconnect"})(fe||(fe={}));var Q;(function(e){e.Connected="Connected",e.ConnectedPendingNetwork="ConnectedPendingNetwork",e.ConnectionDisrupted="ConnectionDisrupted",e.ConnectionDisruptedPendingNetwork="ConnectionDisruptedPendingNetwork",e.Connecting="Connecting",e.ConnectedPendingDisconnect="ConnectedPendingDisconnect",e.Disconnected="Disconnected",e.ConnectedPendingKeepAlive="ConnectedPendingKeepAlive"})(Q||(Q={}));const as=()=>new et().networkMonitor(),ae={KEEP_ALIVE_MISSED:{keepAliveState:"unhealthy"},KEEP_ALIVE:{keepAliveState:"healthy"},CONNECTION_ESTABLISHED:{connectionState:"connected"},CONNECTION_FAILED:{intendedConnectionState:"disconnected",connectionState:"disconnected"},CLOSING_CONNECTION:{intendedConnectionState:"disconnected"},OPENING_CONNECTION:{intendedConnectionState:"connected",connectionState:"connecting"},CLOSED:{connectionState:"disconnected"},ONLINE:{networkState:"connected"},OFFLINE:{networkState:"disconnected"}};class yh{constructor(){this._networkMonitoringSubscription=void 0,this._linkedConnectionState={networkState:"connected",connectionState:"disconnected",intendedConnectionState:"disconnected",keepAliveState:"healthy"},this._initialNetworkStateSubscription=as().subscribe(({online:t})=>{var n;this.record(t?ae.ONLINE:ae.OFFLINE),(n=this._initialNetworkStateSubscription)==null||n.unsubscribe()}),this._linkedConnectionStateObservable=new xt(t=>{t.next(this._linkedConnectionState),this._linkedConnectionStateObserver=t})}enableNetworkMonitoring(){var t;(t=this._initialNetworkStateSubscription)==null||t.unsubscribe(),this._networkMonitoringSubscription===void 0&&(this._networkMonitoringSubscription=as().subscribe(({online:n})=>{this.record(n?ae.ONLINE:ae.OFFLINE)}))}disableNetworkMonitoring(){var t;(t=this._networkMonitoringSubscription)==null||t.unsubscribe(),this._networkMonitoringSubscription=void 0}get connectionStateObservable(){let t;return this._linkedConnectionStateObservable.pipe(ai(n=>this.connectionStatesTranslator(n))).pipe(Yr(n=>{const i=n!==t;return t=n,i}))}record(t){var i;t.intendedConnectionState==="connected"?this.enableNetworkMonitoring():t.intendedConnectionState==="disconnected"&&this.disableNetworkMonitoring();const n={...this._linkedConnectionState,...t};this._linkedConnectionState={...n},(i=this._linkedConnectionStateObserver)==null||i.next(this._linkedConnectionState)}connectionStatesTranslator({connectionState:t,networkState:n,intendedConnectionState:i,keepAliveState:o}){return t==="connected"&&n==="disconnected"?Q.ConnectedPendingNetwork:t==="connected"&&i==="disconnected"?Q.ConnectedPendingDisconnect:t==="disconnected"&&i==="connected"&&n==="disconnected"?Q.ConnectionDisruptedPendingNetwork:t==="disconnected"&&i==="connected"?Q.ConnectionDisrupted:t==="connected"&&o==="unhealthy"?Q.ConnectedPendingKeepAlive:t==="connecting"?Q.Connecting:t==="disconnected"?Q.Disconnected:Q.Connected}}var st;(function(e){e.START_RECONNECT="START_RECONNECT",e.HALT_RECONNECT="HALT_RECONNECT"})(st||(st={}));class Sh{constructor(){this.reconnectObservers=[]}addObserver(t){this.reconnectObservers.push(t)}record(t){t===st.START_RECONNECT&&this.reconnectSetTimeoutId===void 0&&this.reconnectIntervalId===void 0&&(this.reconnectSetTimeoutId=setTimeout(()=>{this._triggerReconnect(),this.reconnectIntervalId=setInterval(()=>{this._triggerReconnect()},gh)},Eh)),t===st.HALT_RECONNECT&&(this.reconnectIntervalId&&(clearInterval(this.reconnectIntervalId),this.reconnectIntervalId=void 0),this.reconnectSetTimeoutId&&(clearTimeout(this.reconnectSetTimeoutId),this.reconnectSetTimeoutId=void 0))}close(){this.reconnectObservers.forEach(t=>{var n;(n=t.complete)==null||n.call(t)})}_triggerReconnect(){this.reconnectObservers.forEach(t=>{var n;(n=t.next)==null||n.call(t)})}}const cs="wss://",Ih=/^https:\/\/\w{26}\.appsync-api\.\w{2}(?:(?:-\w{2,})+)-\d\.amazonaws.com(?:\.cn)?\/graphql$/i,vh=/^https:\/\/\w{26}\.\w+-api\.\w{2}(?:(?:-\w{2,})+)-\d\.amazonaws.com(?:\.cn)?\/event$/i,us="/realtime",Th=e=>e.match(Ih)===null,wh=e=>e.match(vh)!==null,Nh=e=>{let t=e??"";return wh(t)?t=t.concat(us).replace("ddpg-api","grt-gamma").replace("appsync-api","appsync-realtime-api"):Th(t)?t=t.concat(us):t=t.replace("appsync-api","appsync-realtime-api").replace("gogi-beta","grt-beta").replace("ddpg-api","grt-gamma"),t=t.replace("https://",cs).replace("http://",cs),new we(t)},Ah=e=>{if(!e)return{};if("Authorization"in e){const{Authorization:t,...n}=e;return n}return e},Ch=e=>{const t=Ah(e),n=new js;return Object.entries(t).forEach(([i,o])=>{n.append(i,o)}),n},Rh=(e,t)=>{const n=Nh(e),i=new js(n.search);for(const[o,s]of t.entries())i.append(o,s);return n.search=i.toString(),n.toString()},$n=async e=>{const{appSyncGraphqlEndpoint:t,query:n,libraryConfigHeaders:i=()=>({}),additionalHeaders:o={},authToken:s}=e;let r={};const a=await i();return typeof o=="function"?r=await o({url:t||"",queryString:n||""}):r=o,s&&(r={...r,Authorization:s}),{additionalCustomHeaders:r,libraryConfigHeaders:a}},ds=new Y("AWSAppSyncRealTimeProvider Auth"),ls=async({host:e})=>{var n,i;const t=await pi();return{Authorization:(i=(n=t==null?void 0:t.tokens)==null?void 0:n.accessToken)==null?void 0:i.toString(),host:e}},_h=async({apiKey:e,host:t})=>{const i=new Date().toISOString().replace(/[:-]|\.\d{3}/g,"");return{host:t,"x-amz-date":i,"x-api-key":e}},bh=async({payload:e,canonicalUri:t,appSyncGraphqlEndpoint:n,region:i})=>{const o={region:i,service:"appsync"},s=(await pi()).credentials,r={url:`${n}${t}`,data:e,method:"POST",headers:{...lh}};return er({headers:r.headers,method:r.method,url:new we(r.url),body:r.data},{credentials:s,signingRegion:o.region,signingService:o.service}).headers},ps=async({host:e,additionalCustomHeaders:t})=>{if(!(t!=null&&t.Authorization))throw new Error("No auth token specified");return{Authorization:t.Authorization,host:e}},br=async({apiKey:e,authenticationType:t,canonicalUri:n,appSyncGraphqlEndpoint:i,region:o,additionalCustomHeaders:s,payload:r})=>{const a={apiKey:_h,iam:bh,oidc:ls,userPool:ls,lambda:ps,none:ps};if(!t||!a[t]){ds.debug(`Authentication type ${t} not supported`);return}else{const c=a[t],u=i?new we(i).host:void 0,d=t==="apiKey"?e:void 0;return ds.debug(`Authenticating with ${JSON.stringify(t)}`),await c({payload:r,canonicalUri:n,appSyncGraphqlEndpoint:i,apiKey:d,region:o,host:u,additionalCustomHeaders:s})}},hs=e=>{He.dispatch("api",e,"PubSub",qe)};class xh{constructor(t){this.subscriptionObserverMap=new Map,this.allowNoSubscriptions=!1,this.socketStatus=te.CLOSED,this.keepAliveTimestamp=Date.now(),this.promiseArray=[],this.connectionStateMonitor=new yh,this.reconnectionMonitor=new Sh,this._establishConnection=async(n,i)=>{this.logger.debug(`Establishing WebSocket connection to ${n}`);try{await this._openConnection(n,i),await this._initiateHandshake()}catch(o){const{errorType:s,errorCode:r}=o;throw ch.includes(r)||uh.includes(s)?new ou(s):s?new Error(s):o}},this.logger=new Y(t.providerName),this.wsProtocolName=t.wsProtocolName,this.wsConnectUri=t.connectUri,this.connectionStateMonitorSubscription=this._startConnectionStateMonitoring()}close(){return this.socketStatus=te.CLOSED,this.connectionStateMonitor.record(ae.CONNECTION_FAILED),this.connectionStateMonitorSubscription.unsubscribe(),this.reconnectionMonitor.close(),new Promise((t,n)=>{this.awsRealTimeSocket?(this.awsRealTimeSocket.onclose=i=>{this._closeSocket(),this.subscriptionObserverMap=new Map,this.awsRealTimeSocket=void 0,t()},this.awsRealTimeSocket.onerror=i=>{n(i)},this.awsRealTimeSocket.close()):t()})}subscribe(t,n){return new xt(i=>{if(!(t!=null&&t.appSyncGraphqlEndpoint)){i.error({errors:[{...new bt("Subscribe only available for AWS AppSync endpoint")}]}),i.complete();return}let o=!1;const s=Wn(),r=()=>{o||(o=!0,this._startSubscriptionWithAWSAppSyncRealTime({options:t,observer:i,subscriptionId:s,customUserAgentDetails:n}).catch(c=>{this.logger.debug(`${fe.REALTIME_SUBSCRIPTION_INIT_ERROR}: ${c}`),this._closeSocket()}).finally(()=>{o=!1}))},a=new xt(c=>{this.reconnectionMonitor.addObserver(c)}).subscribe(()=>{r()});return r(),async()=>{await this._cleanupSubscription(s,a)}})}async connect(t){this.socketStatus!==te.READY&&await this._connectWebSocket(t)}async publish(t,n){if(this.socketStatus!==te.READY)throw new Error("Subscription has not been initialized");return this._publishMessage(t,n)}async _connectWebSocket(t){const{apiKey:n,appSyncGraphqlEndpoint:i,authenticationType:o,region:s}=t,{additionalCustomHeaders:r}=await $n(t);this.connectionStateMonitor.record(ae.OPENING_CONNECTION),await this._initializeWebSocketConnection({apiKey:n,appSyncGraphqlEndpoint:i,authenticationType:o,region:s,additionalCustomHeaders:r})}async _publishMessage(t,n){const i=Wn(),{additionalCustomHeaders:o,libraryConfigHeaders:s}=await $n(t),r=await this._prepareSubscriptionPayload({options:t,subscriptionId:i,customUserAgentDetails:n,additionalCustomHeaders:o,libraryConfigHeaders:s,publish:!0});return new Promise((a,c)=>{if(this.awsRealTimeSocket){const u=h=>{const f=JSON.parse(h.data);if(f.id===i&&f.type==="publish_success"&&(this.awsRealTimeSocket&&this.awsRealTimeSocket.removeEventListener("message",u),p(),a()),f.errors&&f.errors.length>0){const E=f.errors.map(g=>g.errorType);p(),c(new Error(`Publish errors: ${E.join(", ")}`))}},d=h=>{p(),c(new Error(`WebSocket error: ${h}`))},l=()=>{p(),c(new Error("WebSocket is closed"))},p=()=>{var h,f,E;(h=this.awsRealTimeSocket)==null||h.removeEventListener("message",u),(f=this.awsRealTimeSocket)==null||f.removeEventListener("error",d),(E=this.awsRealTimeSocket)==null||E.removeEventListener("close",l)};this.awsRealTimeSocket.addEventListener("message",u),this.awsRealTimeSocket.addEventListener("error",d),this.awsRealTimeSocket.addEventListener("close",l),this.awsRealTimeSocket.send(r)}else c(new Error("WebSocket is not connected"))})}async _cleanupSubscription(t,n){n==null||n.unsubscribe();try{await this._waitForSubscriptionToBeConnected(t);const{subscriptionState:i}=this.subscriptionObserverMap.get(t)||{};if(!i)return;if(i===Ce.CONNECTED)this._sendUnsubscriptionMessage(t);else throw new Error("Subscription never connected")}catch(i){this.logger.debug(`Error while unsubscribing ${i}`)}finally{this._removeSubscriptionObserver(t)}}_startConnectionStateMonitoring(){return this.connectionStateMonitor.connectionStateObservable.subscribe(t=>{hs({event:dh,data:{provider:this,connectionState:t},message:`Connection state is ${t}`}),this.connectionState=t,t===Q.ConnectionDisrupted&&this.reconnectionMonitor.record(st.START_RECONNECT),[Q.Connected,Q.ConnectedPendingDisconnect,Q.ConnectedPendingKeepAlive,Q.ConnectedPendingNetwork,Q.ConnectionDisruptedPendingNetwork,Q.Disconnected].includes(t)&&this.reconnectionMonitor.record(st.HALT_RECONNECT)})}async _startSubscriptionWithAWSAppSyncRealTime({options:t,observer:n,subscriptionId:i,customUserAgentDetails:o}){const{query:s,variables:r}=t;this.subscriptionObserverMap.set(i,{observer:n,query:s??"",variables:r??{},subscriptionState:Ce.PENDING,startAckTimeoutId:void 0});const{additionalCustomHeaders:a,libraryConfigHeaders:c}=await $n(t),u=await this._prepareSubscriptionPayload({options:t,subscriptionId:i,customUserAgentDetails:o,additionalCustomHeaders:a,libraryConfigHeaders:c});try{await this._connectWebSocket(t)}catch(p){this._logStartSubscriptionError(i,n,p);return}const{subscriptionFailedCallback:d,subscriptionReadyCallback:l}=this.subscriptionObserverMap.get(i)??{};this.subscriptionObserverMap.set(i,{observer:n,subscriptionState:Ce.PENDING,query:s??"",variables:r??{},subscriptionReadyCallback:l,subscriptionFailedCallback:d,startAckTimeoutId:setTimeout(()=>{this._timeoutStartSubscriptionAck(i)},ph)}),this.awsRealTimeSocket&&this.awsRealTimeSocket.send(u)}_logStartSubscriptionError(t,n,i){this.logger.debug({err:i});const o=String(i.message??"");if(this._closeSocket(),this.connectionState!==Q.ConnectionDisruptedPendingNetwork){_s(i)?n.error({errors:[{...new bt(`${fe.CONNECTION_FAILED}: ${o}`)}]}):this.logger.debug(`${fe.CONNECTION_FAILED}: ${o}`);const{subscriptionFailedCallback:s}=this.subscriptionObserverMap.get(t)||{};typeof s=="function"&&s()}}async _waitForSubscriptionToBeConnected(t){const n=this.subscriptionObserverMap.get(t);if(n){const{subscriptionState:i}=n;if(i===Ce.PENDING)return new Promise((o,s)=>{const{observer:r,subscriptionState:a,variables:c,query:u}=n;this.subscriptionObserverMap.set(t,{observer:r,subscriptionState:a,variables:c,query:u,subscriptionReadyCallback:o,subscriptionFailedCallback:s})})}}_sendUnsubscriptionMessage(t){try{if(this.awsRealTimeSocket&&this.awsRealTimeSocket.readyState===WebSocket.OPEN&&this.socketStatus===te.READY){const n=this._unsubscribeMessage(t),i=JSON.stringify(n);this.awsRealTimeSocket.send(i)}}catch(n){this.logger.debug({err:n})}}_removeSubscriptionObserver(t){this.subscriptionObserverMap.delete(t),this.allowNoSubscriptions||setTimeout(this._closeSocketIfRequired.bind(this),1e3)}_closeSocketIfRequired(){if(!(this.subscriptionObserverMap.size>0)){if(!this.awsRealTimeSocket){this.socketStatus=te.CLOSED;return}if(this.connectionStateMonitor.record(ae.CLOSING_CONNECTION),this.awsRealTimeSocket.bufferedAmount>0)setTimeout(this._closeSocketIfRequired.bind(this),1e3);else{this.logger.debug("closing WebSocket...");const t=this.awsRealTimeSocket;t.onclose=null,t.onerror=null,t.close(1e3),this.awsRealTimeSocket=void 0,this.socketStatus=te.CLOSED,this._closeSocket()}}}maintainKeepAlive(){this.keepAliveTimestamp=Date.now()}keepAliveHeartbeat(t){const n=Date.now();n-this.keepAliveTimestamp>mh?this.connectionStateMonitor.record(ae.KEEP_ALIVE_MISSED):this.connectionStateMonitor.record(ae.KEEP_ALIVE),n-this.keepAliveTimestamp>t&&this._errorDisconnect(fe.TIMEOUT_DISCONNECT)}_handleIncomingSubscriptionMessage(t){if(typeof t.data!="string")return;const[n,i]=this._handleSubscriptionData(t);if(n){this.maintainKeepAlive();return}const{type:o,id:s,payload:r}=i,{observer:a=null,query:c="",variables:u={},startAckTimeoutId:d,subscriptionReadyCallback:l,subscriptionFailedCallback:p}=this.subscriptionObserverMap.get(s)||{};if(o===ce.GQL_START_ACK||o===ce.EVENT_SUBSCRIBE_ACK){this.logger.debug(`subscription ready for ${JSON.stringify({query:c,variables:u})}`),typeof l=="function"&&l(),d&&clearTimeout(d),hs({event:fe.SUBSCRIPTION_ACK,data:{query:c,variables:u},message:"Connection established for subscription"});const h=Ce.CONNECTED;a&&this.subscriptionObserverMap.set(s,{observer:a,query:c,variables:u,startAckTimeoutId:void 0,subscriptionState:h,subscriptionReadyCallback:l,subscriptionFailedCallback:p}),this.connectionStateMonitor.record(ae.CONNECTION_ESTABLISHED);return}if(o===ce.GQL_CONNECTION_KEEP_ALIVE){this.maintainKeepAlive();return}if(o===ce.GQL_ERROR){const h=Ce.FAILED;a&&(this.subscriptionObserverMap.set(s,{observer:a,query:c,variables:u,startAckTimeoutId:d,subscriptionReadyCallback:l,subscriptionFailedCallback:p,subscriptionState:h}),this.logger.debug(`${fe.CONNECTION_FAILED}: ${JSON.stringify(r??i)}`),a.error({errors:[{...new bt(`${fe.CONNECTION_FAILED}: ${JSON.stringify(r??i)}`)}]}),d&&clearTimeout(d),typeof p=="function"&&p())}}_errorDisconnect(t){this.logger.debug(`Disconnect error: ${t}`),this.awsRealTimeSocket&&(this._closeSocket(),this.awsRealTimeSocket.close()),this.socketStatus=te.CLOSED}_closeSocket(){this.keepAliveHeartbeatIntervalId&&(clearInterval(this.keepAliveHeartbeatIntervalId),this.keepAliveHeartbeatIntervalId=void 0),this.connectionStateMonitor.record(ae.CLOSED)}_timeoutStartSubscriptionAck(t){const n=this.subscriptionObserverMap.get(t);if(n){const{observer:i,query:o,variables:s}=n;if(!i)return;this.subscriptionObserverMap.set(t,{observer:i,query:o,variables:s,subscriptionState:Ce.FAILED}),this._closeSocket(),this.logger.debug("timeoutStartSubscription",JSON.stringify({query:o,variables:s}))}}_initializeWebSocketConnection({appSyncGraphqlEndpoint:t,authenticationType:n,apiKey:i,region:o,additionalCustomHeaders:s}){if(this.socketStatus!==te.READY)return new Promise(async(r,a)=>{if(this.promiseArray.push({res:r,rej:a}),this.socketStatus===te.CLOSED)try{this.socketStatus=te.CONNECTING;const u=await br({authenticationType:n,payload:"{}",canonicalUri:this.wsConnectUri,apiKey:i,appSyncGraphqlEndpoint:t,region:o,additionalCustomHeaders:s}),d=u?JSON.stringify(u):"",p=`header-${nt.convert(d,{urlSafe:!0,skipPadding:!0})}`,h=Ch(s),f=Rh(t,h);await this._establishRetryableConnection(f,p),this.promiseArray.forEach(({res:E})=>{this.logger.debug("Notifying connection successful"),E()}),this.socketStatus=te.READY,this.promiseArray=[]}catch(c){this.logger.debug("Connection exited with",c),this.promiseArray.forEach(({rej:u})=>{u(c)}),this.promiseArray=[],this.awsRealTimeSocket&&this.awsRealTimeSocket.readyState===WebSocket.OPEN&&this.awsRealTimeSocket.close(3001),this.awsRealTimeSocket=void 0,this.socketStatus=te.CLOSED}})}async _establishRetryableConnection(t,n){this.logger.debug("Establishing retryable connection"),await su(this._establishConnection.bind(this),[t,n],ah)}async _openConnection(t,n){return new Promise((i,o)=>{const s=this._getNewWebSocket(t,[this.wsProtocolName,n]);s.onerror=()=>{this.logger.debug("WebSocket connection error")},s.onclose=()=>{this._closeSocket(),o(new Error("Connection handshake error"))},s.onopen=()=>{this.awsRealTimeSocket=s,i()}})}_getNewWebSocket(t,n){return new WebSocket(t,n)}async _initiateHandshake(){return new Promise((t,n)=>{if(!this.awsRealTimeSocket){n(new Error("awsRealTimeSocket undefined"));return}let i=!1;this.awsRealTimeSocket.onerror=r=>{this.logger.debug(`WebSocket error ${JSON.stringify(r)}`)},this.awsRealTimeSocket.onclose=r=>{this.logger.debug(`WebSocket closed ${r.reason}`),this._closeSocket(),n(new Error(JSON.stringify(r)))},this.awsRealTimeSocket.onmessage=r=>{if(typeof r.data!="string")return;this.logger.debug(`subscription message from AWS AppSyncRealTime: ${r.data} `);const a=JSON.parse(r.data),{type:c}=a,u=this._extractConnectionTimeout(a);if(c===ce.GQL_CONNECTION_ACK){i=!0,this._registerWebsocketHandlers(u),t("Connected to AWS AppSyncRealTime");return}if(c===ce.GQL_CONNECTION_ERROR){const{errorType:d,errorCode:l}=this._extractErrorCodeAndType(a);n({errorType:d,errorCode:l})}};const o={type:ce.GQL_CONNECTION_INIT};this.awsRealTimeSocket.send(JSON.stringify(o));const s=r=>{r||(this.connectionStateMonitor.record(ae.CONNECTION_FAILED),n(new Error(`Connection timeout: ack from AWSAppSyncRealTime was not received after ${rs} ms`)))};setTimeout(()=>{s(i)},rs)})}_registerWebsocketHandlers(t){this.awsRealTimeSocket&&(this.keepAliveHeartbeatIntervalId=setInterval(()=>{this.keepAliveHeartbeat(t)},fh),this.awsRealTimeSocket.onmessage=this._handleIncomingSubscriptionMessage.bind(this),this.awsRealTimeSocket.onerror=n=>{this.logger.debug(n),this._errorDisconnect(fe.CONNECTION_CLOSED)},this.awsRealTimeSocket.onclose=n=>{this.logger.debug(`WebSocket closed ${n.reason}`),this._closeSocket(),this._errorDisconnect(fe.CONNECTION_CLOSED)})}}const fs="AWSAppSyncRealTimeProvider",Oh="graphql-ws",Ph="/connect";class Dh extends xh{constructor(){super({providerName:fs,wsProtocolName:Oh,connectUri:Ph})}getProviderName(){return fs}subscribe(t,n){return super.subscribe(t,n)}async _prepareSubscriptionPayload({options:t,subscriptionId:n,customUserAgentDetails:i,additionalCustomHeaders:o,libraryConfigHeaders:s}){const{appSyncGraphqlEndpoint:r,authenticationType:a,query:c,variables:u,apiKey:d,region:l}=t,h=JSON.stringify({query:c,variables:u}),f={...await br({apiKey:d,appSyncGraphqlEndpoint:r,authenticationType:a,payload:h,canonicalUri:"",region:l,additionalCustomHeaders:o}),...s,...o,[Zr]:ct(i)},E={id:n,payload:{data:h,extensions:{authorization:{...f}}},type:ce.GQL_START};return JSON.stringify(E)}_handleSubscriptionData(t){this.logger.debug(`subscription message from AWS AppSync RealTime: ${t.data}`);const{id:n="",payload:i,type:o}=JSON.parse(String(t.data)),{observer:s=null,query:r="",variables:a={}}=this.subscriptionObserverMap.get(n)||{};return this.logger.debug({id:n,observer:s,query:r,variables:a}),o===ce.DATA&&i&&i.data?(s?s.next(i):this.logger.debug(`observer not found for id: ${n}`),[!0,{id:n,type:o,payload:i}]):[!1,{id:n,type:o,payload:i}]}_unsubscribeMessage(t){return{id:t,type:ce.GQL_STOP}}_extractConnectionTimeout(t){const{payload:{connectionTimeoutMs:n=hh}={}}=t;return n}_extractErrorCodeAndType(t){const{payload:{errors:[{errorType:n="",errorCode:i=0}={}]=[]}={}}=t;return{errorCode:i,errorType:n}}}class Te extends ee{constructor(t){super(t),this.constructor=Te,Object.setPrototypeOf(this,Te.prototype)}}var tt;(function(e){e.NoAuthSession="NoAuthSession",e.NoRegion="NoRegion",e.NoCustomEndpoint="NoCustomEndpoint"})(tt||(tt={}));const kh={[tt.NoAuthSession]:{message:"Auth session should not be empty."},[tt.NoRegion]:{message:"Missing region."},[tt.NoCustomEndpoint]:{message:"Custom endpoint region is present without custom endpoint."}};function Mh(e,t){const{message:n,recoverySuggestion:i}=kh[t];if(!e)throw new Te({name:t,message:n,recoverySuggestion:i})}const Fh=new Y("GraphQLAPI resolveConfig"),ms=e=>{var c,u;const t=e.getConfig();(c=t.API)!=null&&c.GraphQL||Fh.warn("The API configuration is missing. This is likely due to Amplify.configure() not being called prior to generateClient().");const{apiKey:n,customEndpoint:i,customEndpointRegion:o,defaultAuthMode:s,endpoint:r,region:a}=((u=t.API)==null?void 0:u.GraphQL)??{};return Mh(!(!i&&o),tt.NoCustomEndpoint),{apiKey:n,customEndpoint:i,customEndpointRegion:o,defaultAuthMode:s,endpoint:r,region:a}},Es=e=>{var i,o,s,r,a,c;const t=(s=(o=(i=e.libraryOptions)==null?void 0:i.API)==null?void 0:o.GraphQL)==null?void 0:s.headers,n=(c=(a=(r=e.libraryOptions)==null?void 0:r.API)==null?void 0:a.GraphQL)==null?void 0:c.withCredentials;return{headers:t,withCredentials:n}};function gs(e){return e.errors&&Array.isArray(e.errors)&&e.errors.forEach(t=>{Lh(t)&&(t.message="Unauthorized",t.recoverySuggestion=`If you're calling an Amplify-generated API, make sure to set the "authMode" in generateClient({ authMode: '...' }) to the backend authorization rule's auth provider ('apiKey', 'userPool', 'iam', 'oidc', 'lambda')`)}),e}function Lh(e){var t,n,i,o;return!!((n=(t=e==null?void 0:e.originalError)==null?void 0:t.name)!=null&&n.startsWith("UnauthorizedException")||(i=e.message)!=null&&i.startsWith("Connection failed:")&&((o=e.message)!=null&&o.includes("Permission denied")))}var Ye;(function(e){e.NO_API_KEY="No api-key configured",e.NO_CURRENT_USER="No current user",e.NO_CREDENTIALS="No credentials",e.NO_FEDERATED_JWT="No federated jwt",e.NO_AUTH_TOKEN="No auth token specified"})(Ye||(Ye={}));const xr=Symbol("amplify"),an=Symbol("authMode"),Or=Symbol("authToken"),ii=Symbol("apiKey"),Pr=Symbol("headers"),cn=Symbol("endpoint");function xi(e){const t=e;return{amplify:t[xr],apiKey:t[ii],authMode:t[an],authToken:t[Or],endpoint:t[cn],headers:t[Pr]}}const Uh={name:"NoApiKey",message:Ye.NO_API_KEY,recoverySuggestion:'The API request was made with `authMode: "apiKey"` but no API Key was passed into `Amplify.configure()`. Review if your API key is passed into the `Amplify.configure()` function.'},Kh={name:"NoCredentials",message:Ye.NO_CREDENTIALS,recoverySuggestion:'The API request was made with `authMode: "iam"` but no authentication credentials are available.\n\nIf you intended to make a request using an authenticated role, review if your user is signed in before making the request.\n\nIf you intend to make a request using an unauthenticated role or also known as "guest access", verify if "Auth.Cognito.allowGuestAccess" is set to "true" in the `Amplify.configure()` function.'},Bh={name:"NoValidAuthTokens",message:Ye.NO_FEDERATED_JWT,recoverySuggestion:"If you intended to make an authenticated API request, review if the current user is signed in."},Vh={name:"NoSignedUser",message:Ye.NO_CURRENT_USER,recoverySuggestion:"Review the underlying exception field for more details. If you intended to make an authenticated API request, review if the current user is signed in."},$h={name:"NoAuthorizationHeader",message:Ye.NO_AUTH_TOKEN,recoverySuggestion:'The API request was made with `authMode: "lambda"` but no `authToken` is set. Review if a valid authToken is passed into the request options or in the `Amplify.configure()` function.'},qh={name:"NoEndpoint",message:"No GraphQL endpoint configured in `Amplify.configure()`.",recoverySuggestion:"Review if the GraphQL API endpoint is set in the `Amplify.configure()` function."},ys=e=>({data:{},errors:[new bt(e.message,null,null,null,null,e)]});function Hh(e){if(!e)return!1;const t=e;return Array.isArray(t.errors)&&t.errors.length>0}async function Wh(e,t,n,i={}){var s;let o={};switch(t){case"apiKey":if(!n)throw new Te(Uh);o={"X-Api-Key":n};break;case"iam":{if((await e.Auth.fetchAuthSession()).credentials===void 0)throw new Te(Kh);break}case"oidc":case"userPool":{let r;try{r=(s=(await e.Auth.fetchAuthSession()).tokens)==null?void 0:s.accessToken.toString()}catch(a){throw new Te({...Vh,underlyingError:a})}if(!r)throw new Te(Bh);o={Authorization:r};break}case"lambda":if(typeof i=="object"&&!i.Authorization)throw new Te($h);o={Authorization:i.Authorization};break}return o}const jh="x-amz-user-agent",Gh=e=>typeof e!="function";class zh{constructor(){this.appSyncRealTime=new Map,this._api={post:oh,cancelREST:sh,isCancelErrorREST:Hp,updateRequestToBeCancellable:rh}}getModuleName(){return"InternalGraphQLAPI"}getGraphqlOperationType(t){const i=Bn(t).definitions,[{operation:o}]=i;return o}graphql(t,{query:n,variables:i={},authMode:o,authToken:s,endpoint:r,apiKey:a},c,u){const d=Bn(typeof n=="string"?n:Tt(n)),[l={}]=d.definitions.filter(f=>f.kind==="OperationDefinition"),{operation:p}=l,h=c||{};switch(p){case"query":case"mutation":{const f=new AbortController;let E;return Gh(t)?E=this._graphql(t,{query:d,variables:i,authMode:o,apiKey:a,endpoint:r},h,f,u,s):E=t(async y=>await this._graphql(y,{query:d,variables:i,authMode:o,apiKey:a,endpoint:r},h,f,u,s)),this._api.updateRequestToBeCancellable(E,f),E}case"subscription":return this._graphqlSubscribe(t,{query:d,variables:i,authMode:o,apiKey:a,endpoint:r},h,u,s);default:throw new Error(`invalid operation type: ${p}`)}}async _graphql(t,{query:n,variables:i,authMode:o,endpoint:s,apiKey:r},a={},c,u,d){const{apiKey:l,region:p,endpoint:h,customEndpoint:f,customEndpointRegion:E,defaultAuthMode:g}=ms(t),y=o||g||"iam",I=y==="identityPool"?"iam":y,{headers:T,withCredentials:v}=Es(t);let S;if(typeof a=="function"){const P={method:"POST",url:new we(s||f||h||"").toString(),queryString:Tt(n)};S=await a(P)}else S=a;d&&(S={...S,Authorization:d});const A=await Wh(t,I,r??l,S),O={...!f&&A,...f&&(E?A:{})||{},...T&&await T({query:Tt(n),variables:i}),...S,...!f&&{[jh]:ct(u)}},D={query:Tt(n),variables:i||null};let k;f&&!E||I!=="oidc"&&I!=="userPool"&&I!=="iam"&&I!=="lambda"?k=void 0:k={service:E?"execute-api":"appsync",region:E||p};const K=s||f||h;if(!K)throw ys(new Te(qh));let q;try{const{body:P}=await this._api.post(t,{url:new we(K),options:{headers:O,body:D,signingServiceInfo:k,withCredentials:v},abortController:c});q=await P.json()}catch(P){if(this.isCancelError(P))throw P;q=ys(P)}if(Hh(q))throw gs(q);return q}isCancelError(t){return this._api.isCancelErrorREST(t)}cancel(t,n){return this._api.cancelREST(t,n)}_graphqlSubscribe(t,{query:n,variables:i,authMode:o,apiKey:s,endpoint:r},a={},c,u){const d=ms(t),l=o||(d==null?void 0:d.defaultAuthMode)||"iam",p=l==="identityPool"?"iam":l,{headers:h}=Es(t),f=r??(d==null?void 0:d.endpoint),E=f??"none",g=this.appSyncRealTime.get(E)??new Dh;return this.appSyncRealTime.set(E,g),g.subscribe({query:Tt(n),variables:i,appSyncGraphqlEndpoint:f,region:d==null?void 0:d.region,authenticationType:p,apiKey:s??(d==null?void 0:d.apiKey),additionalHeaders:a,authToken:u,libraryConfigHeaders:h},c).pipe(Jr(y=>{throw y.errors?gs(y):y}))}}function _n(e){const t=new Set;for(const n of e.attributes||[])if(Qh(n))for(const i of n.properties.rules)i.allow==="owner"?t.add(i.ownerField||"owner"):i.allow==="groups"&&i.groupsField!==void 0&&t.add(i.groupsField);return Array.from(t)}function Qh(e){var t,n;return(e==null?void 0:e.type)==="auth"&&typeof(e==null?void 0:e.properties)=="object"&&Array.isArray((t=e==null?void 0:e.properties)==null?void 0:t.rules)?((n=e==null?void 0:e.properties)==null?void 0:n.rules).every(i=>!!i.allow):!1}function un(e){return`${e[0].toUpperCase()}${e.slice(1)}`}function Ke(e){let t,n;const i=new Promise((o,s)=>{t=o,n=s});return e(i).then(o=>{t(o)}).catch(o=>{n(o)}),i}const En=new WeakMap;function Be(e,t){return En.set(t,e),e.finally(()=>{En.delete(t)})}function Yh(e){const t=e.cancel.bind(e);e.cancel=function(n,i){const o=new Set;let s=n;for(;s&&En.has(s);){if(o.has(s))throw new Error("A cycle was detected in the modeled graphql cancellation chain. This is a bug. Please report it!");o.add(s),s=En.get(s)}return t(s,i)}}const Xe={HAS_ONE:"HAS_ONE",HAS_MANY:"HAS_MANY",BELONGS_TO:"BELONGS_TO"},Ss={ID:"ID",String:"String",AWSDate:"String",AWSTime:"String",AWSDateTime:"String",AWSTimestamp:"Int",AWSEmail:"String",AWSPhone:"String",AWSURL:"String",AWSIPAddress:"String",AWSJSON:"String",Boolean:"Boolean",Int:"Int",Float:"Float"},gn=e=>e.length===1?e[0]:e.reduce((t,n,i)=>i===0?n:t+un(n),""),Oe=(e,t,n)=>{var o;if(!n)return null;const i={};for(const[s,r]of Object.entries(n)){const a=t?(o=e.models[t])==null?void 0:o.fields[s]:void 0,c={fieldDef:a,value:r};Jh(c)?i[s]=c.value.items.map(u=>Oe(e,c.fieldDef.type.model,u)):Xh(a)?i[s]=Oe(e,a.type.model,r):i[s]=r}return i};function Jh(e){var t,n;return typeof((t=e.fieldDef)==null?void 0:t.type)=="object"&&"model"in e.fieldDef.type&&typeof e.fieldDef.type.model=="string"&&e.fieldDef.isArray&&Array.isArray((n=e.value)==null?void 0:n.items)}function Xh(e){return typeof(e==null?void 0:e.type)=="object"&&"model"in e.type&&typeof e.type.model=="string"}function Pe(e,t,n,i,o,s,r=!1){const a=i.models[t],c=a.fields,u=Object.entries(c).filter(([d,l])=>{var p;return((p=l==null?void 0:l.type)==null?void 0:p.model)!==void 0}).map(([d])=>d);return n.map(d=>{var p,h,f,E,g;if(d==null)return d;const l={};for(const y of u){const I=c[y],v=(I==null?void 0:I.type).model,S=i.models[v],A=S.primaryKeyInfo.primaryKeyFieldName,O=S.primaryKeyInfo.sortKeyFieldNames,D=(p=I.association)==null?void 0:p.connectionType;let k=[];I.association&&"associatedWith"in I.association&&(k=I.association.associatedWith);const K=[];switch(I.association&&"targetNames"in I.association&&K.push(...I.association.targetNames),D){case Xe.BELONGS_TO:{const q=O.reduce((P,_)=>(d[_]&&(P[_]=d[_]),P),{});if(((h=e.models[v])==null?void 0:h.get)===void 0)break;r?l[y]=(P,_)=>d[K[0]]?e.models[v].get(P,{[A]:d[K[0]],...q},{authMode:(_==null?void 0:_.authMode)||o,authToken:(_==null?void 0:_.authToken)||s}):{data:null}:l[y]=P=>d[K[0]]?e.models[v].get({[A]:d[K[0]],...q},{authMode:(P==null?void 0:P.authMode)||o,authToken:(P==null?void 0:P.authToken)||s}):{data:null};break}case Xe.HAS_ONE:case Xe.HAS_MANY:{const q=D===Xe.HAS_ONE?x=>({data:(x==null?void 0:x.data.shift())||null,errors:x.errors,extensions:x.extensions}):x=>x,P=a.primaryKeyInfo.primaryKeyFieldName,_=a.primaryKeyInfo.sortKeyFieldNames,L=S.fields[k[0]];if(L.type.model){let x=[];L.association&&"targetNames"in L.association&&(x=(f=L.association)==null?void 0:f.targetNames);const B=x.map((M,U)=>U===0?{[M]:{eq:d[P]}}:{[M]:{eq:d[_[U-1]]}});if(((E=e.models[v])==null?void 0:E.list)===void 0)break;r?l[y]=(M,U)=>d[P]?Ke(async Le=>{const St=e.models[v].list(M,{filter:{and:B},limit:U==null?void 0:U.limit,nextToken:U==null?void 0:U.nextToken,authMode:(U==null?void 0:U.authMode)||o,authToken:(U==null?void 0:U.authToken)||s}),kn=Be(St,Le);return q(await kn)}):[]:l[y]=M=>d[P]?Ke(async U=>{const Le=e.models[v].list({filter:{and:B},limit:M==null?void 0:M.limit,nextToken:M==null?void 0:M.nextToken,authMode:(M==null?void 0:M.authMode)||o,authToken:(M==null?void 0:M.authToken)||s}),St=Be(Le,U);return q(await St)}):[];break}const re=k.map((x,B)=>B===0?{[x]:{eq:d[P]}}:{[x]:{eq:d[_[B-1]]}});if(((g=e.models[v])==null?void 0:g.list)===void 0)break;r?l[y]=(x,B)=>d[P]?Ke(async M=>{const U=e.models[v].list(x,{filter:{and:re},limit:B==null?void 0:B.limit,nextToken:B==null?void 0:B.nextToken,authMode:(B==null?void 0:B.authMode)||o,authToken:(B==null?void 0:B.authToken)||s}),Le=Be(U,M);return q(await Le)}):[]:l[y]=x=>d[P]?Ke(async B=>{const M=e.models[v].list({filter:{and:re},limit:x==null?void 0:x.limit,nextToken:x==null?void 0:x.nextToken,authMode:(x==null?void 0:x.authMode)||o,authToken:(x==null?void 0:x.authToken)||s}),U=Be(M,B);return q(await U)}):[];break}}}return{...d,...l}})}const oi={CREATE:{operationPrefix:"create",usePlural:!1},GET:{operationPrefix:"get",usePlural:!1},UPDATE:{operationPrefix:"update",usePlural:!1},DELETE:{operationPrefix:"delete",usePlural:!1},LIST:{operationPrefix:"list",usePlural:!0},INDEX_QUERY:{operationPrefix:"",usePlural:!1},ONCREATE:{operationPrefix:"onCreate",usePlural:!1},ONUPDATE:{operationPrefix:"onUpdate",usePlural:!1},ONDELETE:{operationPrefix:"onDelete",usePlural:!1},OBSERVEQUERY:{operationPrefix:"observeQuery",usePlural:!1}},si="*",bn=(e,t)=>{const{fields:n}=e,i=Object.values(n).map(({type:o,name:s})=>{if(typeof o.enum=="string")return[s,rt];if(typeof o.nonModel=="string")return[s,bn(t.nonModels[o.nonModel],t)];if(typeof o=="string")return[s,rt]}).filter(o=>o!==void 0);return Object.fromEntries(i)},Zh=(e,t)=>{const{fields:n}=e,i=Object.values(n).map(({type:s,name:r})=>{if(typeof s.enum=="string"||typeof s=="string")return[r,rt];if(typeof s.nonModel=="string")return[r,bn(t.nonModels[s.nonModel],t)]}).filter(s=>s!==void 0),o=_n(e).map(s=>[s,rt]);return Object.fromEntries(i.concat(o))};function ef(e){const{fields:t}=e,n=Object.values(t).map(({type:o,name:s})=>{if(typeof o=="string")return s;if(typeof o=="object"){if(typeof(o==null?void 0:o.enum)=="string")return s;if(typeof(o==null?void 0:o.nonModel)=="string")return`${s}.${si}`}}).filter(Boolean),i=_n(e);return Array.from(new Set(n.concat(i)))}const rt="";function tf(e,t,n){const i=(o,s)=>{var g,y,I,T,v,S;const[r,...a]=o.split("."),c=a[0],u=e.models[s]??e.nonModels[s],d=u==null?void 0:u.fields,l=(y=(g=d==null?void 0:d[r])==null?void 0:g.type)==null?void 0:y.model,p=e.models[l],h=(T=(I=d==null?void 0:d[r])==null?void 0:I.type)==null?void 0:T.nonModel,f=e.nonModels[h],E=p?"model":f?"nonModel":"field";if(E==="nonModel"){let A={};if(!c)throw Error(`${r} must declare a wildcard (*) or a field of custom type ${h}`);return c===si?A={[r]:bn(f,e)}:A={[r]:i(a.join("."),h)},A}else if(E==="model"){let A={};if(!c)throw Error(`${r} must declare a wildcard (*) or a field of model ${l}`);if(c===si){const O=e.models[l];A={[r]:Zh(O,e)}}else A={[r]:i(a.join("."),l)};return(v=d[r])!=null&&v.isArray&&(A={[r]:{items:A[r]}}),A}else{const A=d==null?void 0:d[r],O=e.nonModels[s],D=(S=O==null?void 0:O.fields)==null?void 0:S[r];if(O){if(!D)throw Error(`${r} is not a field of custom type ${s}`)}else{const k=_n(u).includes(r);if(!A&&!k)throw Error(`${r} is not a field of model ${s}`)}return{[r]:rt}}};return n.reduce((o,s)=>Dr(i(s,t),o),{})}function yn(e){const t=[];return Object.entries(e).forEach(([n,i])=>{i===rt?t.push(n):typeof i=="object"&&i!==null&&(i!=null&&i.items?t.push(n,"{","items","{",yn(i.items),"}","}"):t.push(n,"{",yn(i),"}"))}),t.join(" ")}function Dr(e,t){const n=i=>i&&typeof i=="object";for(const i in e)Object.prototype.hasOwnProperty.call(e,i)&&(Object.prototype.hasOwnProperty.call(t,i)&&n(t[i])?Dr(e[i],t[i]):t[i]=e[i]);return t}function kr(e,t,n){const i=e.models[t],o=tf(e,t,n??ef(i));return yn(o)}function xn(e,t,n,i,o){var q,P;const{name:s,pluralName:r,fields:a,primaryKeyInfo:{isCustomPrimaryKey:c,primaryKeyFieldName:u,sortKeyFieldNames:d},attributes:l}=t,p=s.charAt(0).toUpperCase()+s.slice(1),h=r.charAt(0).toUpperCase()+r.slice(1),{operationPrefix:f,usePlural:E}=oi[n],{selectionSet:g}=i||{};let y,I;if(f)y=`${f}${E?h:p}`;else if(o){const{queryField:_,pk:L,sk:z=[]}=o;y=_;let re={};if(z.length===1){const[x]=z,B=typeof a[x].type=="string"?a[x].type:"String",M=Ss[B];re={[x]:`Model${M}KeyConditionInput`}}else if(z.length>1){const x=gn(z),B=(P=(q=l==null?void 0:l.find(M=>{var U;return((U=M==null?void 0:M.properties)==null?void 0:U.queryField)===_}))==null?void 0:q.properties)==null?void 0:P.name;re={[x]:`Model${un(s)}${un(B)}CompositeKeyConditionInput`}}I={[L]:`${Object.prototype.hasOwnProperty.call(a[L].type,"enum")?a[L].type.enum:a[L].type}!`,...re}}else throw new Error("Error generating GraphQL Document - invalid operation name");let T,v,S;const A=kr(e,s,g),O={[u]:`${a[u].type}!`},D={},k=_=>{if(d.length===0)return{};if(_==="get")return d.reduce((L,z)=>{const re=a[z].type;return _==="get"&&(L[z]=`${re}!`),L},{});if(d.length===1){const[L]=d,z=typeof a[L].type=="string"?a[L].type:"String",re=Ss[z];return{[L]:`Model${re}KeyConditionInput`}}else return{[gn(d)]:`Model${un(s)}PrimaryCompositeKeyConditionInput`}};switch(c&&(Object.assign(O,k("get")),Object.assign(D,{[u]:`${a[u].type}`,sortDirection:"ModelSortDirection"},k("list"))),n){case"CREATE":case"UPDATE":case"DELETE":S??(S={input:`${f.charAt(0).toLocaleUpperCase()+f.slice(1)}${p}Input!`}),T??(T="mutation");case"GET":S??(S=O),v??(v=A);case"LIST":S??(S={...D,filter:`Model${p}FilterInput`,limit:"Int",nextToken:"String"}),T??(T="query"),v??(v=`items { ${A} } nextToken __typename`);case"INDEX_QUERY":S??(S={...I,filter:`Model${p}FilterInput`,sortDirection:"ModelSortDirection",limit:"Int",nextToken:"String"}),T??(T="query"),v??(v=`items { ${A} } nextToken __typename`);case"ONCREATE":case"ONUPDATE":case"ONDELETE":S??(S={filter:`ModelSubscription${p}FilterInput`}),T??(T="subscription"),v??(v=A);break;case"OBSERVEQUERY":default:throw new Error("Internal error: Attempted to generate graphql document for observeQuery. Please report this error.")}return`${T}${S?`(${Object.entries(S).map(([_,L])=>`$${_}: ${L}`)})`:""} { ${y}${S?`(${Object.keys(S).map(_=>`${_}: $${_}`)})`:""} { ${v} } }`}function On(e,t,n,i,o){const{fields:s,primaryKeyInfo:{isCustomPrimaryKey:r,primaryKeyFieldName:a,sortKeyFieldNames:c}}=e,u=(c==null?void 0:c.length)&&gn(c);let d={};switch(t){case"CREATE":d={input:n?Is(n,e,i):{}};break;case"UPDATE":d={input:n?Object.fromEntries(Object.entries(Is(n,e,i)).filter(([l])=>s[l]?!s[l].isReadOnly:!_n(e).includes(l))):{}};break;case"GET":case"DELETE":n&&(d=r?[a,...c].reduce((l,p)=>(l[p]=n[p],l),{}):{[a]:n[a]}),t==="DELETE"&&(d={input:d});break;case"LIST":n!=null&&n.filter&&(d.filter=n.filter),n!=null&&n.sortDirection&&(d.sortDirection=n.sortDirection),n&&n[a]&&(d[a]=n[a]),u&&n&&n[u]&&(d[u]=n[u]),n!=null&&n.nextToken&&(d.nextToken=n.nextToken),n!=null&&n.limit&&(d.limit=n.limit);break;case"INDEX_QUERY":{const{pk:l,sk:p=[]}=o,h=(p==null?void 0:p.length)&&gn(p);d[l]=n[l],h&&n&&n[h]&&(d[h]=n[h]),n!=null&&n.filter&&(d.filter=n.filter),n!=null&&n.sortDirection&&(d.sortDirection=n.sortDirection),n!=null&&n.nextToken&&(d.nextToken=n.nextToken),n!=null&&n.limit&&(d.limit=n.limit);break}case"ONCREATE":case"ONUPDATE":case"ONDELETE":n!=null&&n.filter&&(d={filter:n.filter});break;case"OBSERVEQUERY":throw new Error("Internal error: Attempted to build variables for observeQuery. Please report this error.");default:{const l=t;throw new Error(`Unhandled operation case: ${l}`)}}return d}function Is(e,t,n){const{fields:i}=t,o={};return Object.entries(e).forEach(([s,r])=>{var u,d;const a=(u=i[s])==null?void 0:u.type,c=a==null?void 0:a.model;if(c){const l=(d=i[s])==null?void 0:d.association,h=n.models[c].primaryKeyInfo;if((l==null?void 0:l.connectionType)===Xe.HAS_ONE){const f=l;f.targetNames.forEach((E,g)=>{const y=f.associatedWith[g];o[E]=r[y]})}(l==null?void 0:l.connectionType)===Xe.BELONGS_TO&&l.targetNames.forEach((E,g)=>{if(g===0){const y=h.primaryKeyFieldName;o[E]=r[y]}else{const y=h.sortKeyFieldNames[g-1];o[E]=r[y]}})}else o[s]=r}),o}function gt(e,t,n={}){const i=t(e);return{authMode:n.authMode||i.authMode,authToken:n.authToken||i.authToken}}function yt(e,t,n){let i=t(e).headers||{};return n&&(i=n),i}function ri(e){if(e!=null&&e.errors)return{...e,data:[]};throw e}function Sn(e){if(e.errors)return{...e,data:null};throw e}const Oi=Symbol("INTERNAL_USER_AGENT_OVERRIDE");var Ee;(function(e){e.CreateConversation="1",e.GetConversation="2",e.ListConversations="3",e.DeleteConversation="4",e.SendMessage="5",e.ListMessages="6",e.OnStreamEvent="7",e.Generation="8",e.UpdateConversation="9"})(Ee||(Ee={}));const Fe=e=>({category:"ai",action:e});function Pn(e){return e?{[Oi]:e}:void 0}const nf=e=>{var t;return typeof((t=e==null?void 0:e.token)==null?void 0:t.value)=="symbol"};function Dn(e,t,n,i,o,s,r){const a=i.arguments!==void 0;return(...u)=>{const d=u[u.length-1];let l,p;if(o)if(nf(u[0]))l=u[0];else throw new Error(`Invalid first argument passed to ${i.name}. Expected contextSpec`);return a&&(o?p=u[1]:p=u[0]),n==="subscription"?cf(e,t,i,s,p,d,r):af(e,t,n,i,s,p,d,l,r)}}function Ze(e,t){return typeof e[t]=="string"}function of(e){return e instanceof Object&&"enum"in e}function sf(e){return e instanceof Object&&"input"in e}function rf({type:e,isRequired:t}){const n=t?"!":"";return of(e)?`${e.enum}${n}`:sf(e)?`${e.input}${n}`:`${e}${n}`}function Mr(e){if(e.arguments===void 0)return"";const t=Object.entries(e.arguments).map(([n,i])=>{const o=rf(i),s=i.isArray?`[${o}]${i.isArrayNullable?"":"!"}`:o;return`$${n}: ${s}`}).join(", ");return t.length>0?`(${t})`:""}function Fr(e){if(e.arguments===void 0)return"";const t=Object.keys(e.arguments).map(n=>`${n}: $${n}`).join(", ");return t.length>0?`(${t})`:""}function Lr(e,t){if(Ze(t,"type")||Ze(t.type,"enum"))return"";if(Ze(t.type,"nonModel")){const n=e.nonModels[t.type.nonModel];return`{${yn(bn(n,e))}}`}else return Ze(t.type,"model")?`{${kr(e,t.type.model)}}`:""}function Ur(e,t={}){const n={};if(e.arguments===void 0)return n;for(const i of Object.values(e.arguments))if(typeof t[i.name]<"u")n[i.name]=t[i.name];else if(i.isRequired)throw new Error(`${e.name} requires arguments '${i.name}'`);return n}function af(e,t,n,i,o,s,r,a,c){return Ke(async u=>{const{name:d}=i,l=gt(e,o,r),p=yt(e,o,r==null?void 0:r.headers),h=Mr(i),f=Fr(i),E=Lr(t,i),g=Ze(i.type,"model")?i.type.model:void 0,y=`
    ${n.toLocaleLowerCase()}${h} {
      ${d}${f} ${E}
    }
  `,I=Ur(i,s),T=Pn(c);try{const v=a?e.graphql(a,{...l,query:y,variables:I},p):e.graphql({...l,query:y,variables:I,...T},p),S=Be(v,u),{data:A,extensions:O}=await S;if(A){const[D]=Object.keys(A),k=Array.isArray(A[D]),K=k?A[D].filter(P=>P):A[D],q=g?Pe(e,g,k?K:[K],t,l.authMode,l.authToken,!!a):K;return{data:!k&&Array.isArray(q)?q.shift():q,extensions:O}}else return{data:null,extensions:O}}catch(v){const{data:S,errors:A}=v;if(S&&Object.keys(S).length!==0&&A){const[O]=Object.keys(S),D=Array.isArray(S[O]),k=D?S[O].filter(K=>K):S[O];if(k){const K=g?Pe(e,g,D?k:[k],t,l.authMode,l.authToken,!!a):k;return{data:!D&&Array.isArray(K)?K.shift():K,errors:A}}else return Sn(v)}else return Sn(v)}})}function cf(e,t,n,i,o,s,r){const a="subscription",{name:c}=n,u=gt(e,i,s),d=yt(e,i,s==null?void 0:s.headers),l=Mr(n),p=Fr(n),h=Lr(t,n),f=Ze(n.type,"model")?n.type.model:void 0,E=`
    ${a.toLocaleLowerCase()}${l} {
      ${c}${p} ${h}
    }
  `,g=Ur(n,o),y=Pn(r);return e.graphql({...u,query:E,variables:g,...y},d).pipe(ai(T=>{const[v]=Object.keys(T.data),S=T.data[v],[A]=f?Pe(e,f,[S],t,u.authMode,u.authToken):[S];return A}))}const uf={queries:"query",mutations:"mutation",subscriptions:"subscription"};function Pi(e,t,n,i){if(!t)return{};const o=t.modelIntrospection;if(!o)return{};const s=o[n];if(!s)return{};const r={},a=i(e).amplify===null;for(const c of Object.values(s))r[c.name]=Dn(e,o,uf[n],c,a,i);return r}function df(e,t,n){return Pi(e,t,"mutations",n)}function lf(e,t,n){return Pi(e,t,"queries",n)}function pf(e,t,n){return Pi(e,t,"subscriptions",n)}function qt(e,t,n,i,o,s=!1,r){return s?(u,d,l)=>vs(e,t,n,d,l,i,o,u,r):(u,d)=>vs(e,t,n,u,d,i,o,void 0,r)}function vs(e,t,n,i,o,s,r,a,c){return Ke(async u=>{const{name:d}=n,l=xn(t,n,s,o),p=On(n,s,i,t),h=gt(e,r,o),f=yt(e,r,o==null?void 0:o.headers),E=Pn(c);try{const g=a?e.graphql(a,{...h,query:l,variables:p},f):e.graphql({...h,query:l,variables:p,...E},f),y=Be(g,u),{data:I,extensions:T}=await y;if(I){const[v]=Object.keys(I),S=Oe(t,d,I[v]);if(S===null)return{data:null,extensions:T};if(o!=null&&o.selectionSet)return{data:S,extensions:T};{const[A]=Pe(e,d,[S],t,h.authMode,h.authToken,!!a);return{data:A,extensions:T}}}else return{data:null,extensions:T}}catch(g){const{data:y,errors:I}=g;if(y&&Object.keys(y).length!==0&&I){const[T]=Object.keys(y),v=Oe(t,d,y[T]);if(v){if(o!=null&&o.selectionSet)return{data:v,errors:I};{const[S]=Pe(e,d,[v],t,h.authMode,h.authToken,!!a);return{data:S,errors:I}}}else return Sn(g)}else return Sn(g)}})}function Di(e,t,n,i,o=!1,s){return o?(c,u)=>Ts(e,t,n,i,u,c,s):c=>Ts(e,t,n,i,c,void 0,s)}function Ts(e,t,n,i,o,s,r){return Ke(async a=>{var f,E,g,y;const{name:c}=n,u=xn(t,n,"LIST",o),d=On(n,"LIST",o,t),l=gt(e,i,o),p=yt(e,i,o==null?void 0:o.headers),h=Pn(r);try{const I=s?e.graphql(s,{...l,query:u,variables:d},p):e.graphql({...l,query:u,variables:d,...h},p),T=Be(I,a),{data:v,extensions:S}=await T;if(v!==void 0){const[A]=Object.keys(v);if(v[A].items){const O=v[A].items.map(D=>Oe(t,c,D));return o!=null&&o.selectionSet?{data:O,nextToken:v[A].nextToken,extensions:S}:{data:Pe(e,c,O,t,l.authMode,l.authToken,!!s),nextToken:v[A].nextToken,extensions:S}}return{data:v[A],nextToken:v[A].nextToken,extensions:S}}}catch(I){const{data:T,errors:v}=I;if(T!=null&&Object.keys(T).length!==0&&v){const[S]=Object.keys(T);if((f=T[S])!=null&&f.items){const A=T[S].items.map(O=>Oe(t,c,O));return A?o!=null&&o.selectionSet?{data:A,nextToken:(E=T[S])==null?void 0:E.nextToken,errors:v}:{data:Pe(e,c,A,t,l.authMode,l.authToken,!!s),nextToken:(g=T[S])==null?void 0:g.nextToken,errors:v}:{data:T[S],nextToken:(y=T[S])==null?void 0:y.nextToken,errors:v}}else return ri(I)}else return ri(I)}})}const hf=e=>e.map(t=>t.image?Kr(t):t.document?ff(t):t.toolUse?Ef(t):t.toolResult?gf(t):Br(t)),Kr=({image:e})=>({image:{...e,source:{...e.source,bytes:Ns(e.source.bytes)}}}),ff=({document:e})=>({document:{...e,source:{...e.source,bytes:Ns(e.source.bytes)}}}),mf=({json:e})=>({json:JSON.parse(e)}),Ef=({toolUse:e})=>({toolUse:{...e,input:JSON.parse(e.input)}}),gf=({toolResult:e})=>({toolResult:{toolUseId:e.toolUseId,content:e.content.map(t=>t.image?Kr(t):t.json?mf(t):Br(t))}}),Br=e=>Object.fromEntries(Object.entries(e).filter(([t,n])=>n!==null)),Vr=({content:e,createdAt:t,id:n,conversationId:i,role:o})=>({content:hf(e??[]),conversationId:i,createdAt:t,id:n,role:o}),yf=(e,t,n,i,o)=>async s=>{const r=Di(e,t,i,o,!1,Fe(Ee.ListMessages)),{data:a,nextToken:c,errors:u}=await r({...s,filter:{conversationId:{eq:n}}});return{data:a.map(d=>Vr(d)),nextToken:c,errors:u}},Sf=({id:e,conversationId:t,associatedUserMessageId:n,contentBlockIndex:i,contentBlockDoneAtIndex:o,contentBlockDeltaIndex:s,contentBlockText:r,contentBlockToolUse:a,stopReason:c,errors:u})=>u?{error:{id:e,conversationId:t,associatedUserMessageId:n,errors:u}}:{next:vf({id:e,conversationId:t,associatedUserMessageId:n,contentBlockIndex:i,contentBlockDoneAtIndex:o,contentBlockDeltaIndex:s,text:r,toolUse:If(a),stopReason:c})},If=e=>{if(e)return{...e,input:JSON.parse(e.input)}},vf=e=>Object.fromEntries(Object.entries(e).filter(([t,n])=>n!==null)),Tf=(e,t,n,i,o)=>s=>{const{conversations:r}=t;if(!r)return{};const a=r[i].message.subscribe;return Dn(e,t,"subscription",a,!1,o,Fe(Ee.OnStreamEvent))({conversationId:n}).subscribe(u=>{const{next:d,error:l}=Sf(u);l&&s.error(l),d&&s.next(d)})},wf=e=>JSON.stringify(e),Nf=e=>e.map(t=>t.image?$r(t):t.document?Cf(t):t.toolResult?_f(t):t),Af=({tools:e})=>({tools:Object.entries(e).map(([t,n])=>({toolSpec:{name:t,description:n.description,inputSchema:{json:JSON.stringify(n.inputSchema.json)}}}))}),$r=({image:e})=>({image:{...e,source:{...e.source,bytes:As(e.source.bytes)}}}),Cf=({document:e})=>({document:{...e,source:{...e.source,bytes:As(e.source.bytes)}}}),Rf=({json:e})=>({json:JSON.stringify(e)}),_f=({toolResult:e})=>({toolResult:{...e,content:e.content.map(t=>t.image?$r(t):t.json?Rf(t):t)}}),bf=(e,t,n,i,o)=>async s=>{const{conversations:r}=t;if(!r)return{};const a=typeof s=="string"?{content:[{text:s}]}:s,{content:c,aiContext:u,toolConfiguration:d}=a,l=r[i].message.send,p=Dn(e,t,"mutation",l,!1,o,Fe(Ee.SendMessage)),{data:h,errors:f}=await p({conversationId:n,content:Nf(c),...u&&{aiContext:wf(u)},...d&&{toolConfiguration:Af(d)}});return{data:h&&Vr(h),errors:f}},Ht=(e,t,n,i,o,s,r,a,c,u)=>{if(!n)throw new Error(`An error occurred converting a ${s} conversation: Missing ID`);return{id:n,createdAt:i,updatedAt:o,metadata:c,name:u,onStreamEvent:Tf(e,t,n,s,a),sendMessage:bf(e,t,n,s,a),listMessages:yf(e,t,n,r,a)}},xf=(e,t,n,i,o,s)=>async r=>{const{name:a,metadata:c}=r??{},u=JSON.stringify(c),d=qt(e,t,i,"CREATE",s,!1,Fe(Ee.CreateConversation)),{data:l,errors:p}=await d({name:a,metadata:u});return{data:Ht(e,t,l==null?void 0:l.id,l==null?void 0:l.createdAt,l==null?void 0:l.updatedAt,n,o,s,l==null?void 0:l.metadata,l==null?void 0:l.name),errors:p}},Of=(e,t,n,i,o,s)=>async({id:r})=>{const a=qt(e,t,i,"GET",s,!1,Fe(Ee.GetConversation)),{data:c,errors:u}=await a({id:r});return{data:c&&Ht(e,t,c.id,c.createdAt,c.updatedAt,n,o,s,c==null?void 0:c.metadata,c==null?void 0:c.name),errors:u}},Pf=(e,t,n,i,o,s)=>async r=>{const a=Di(e,t,i,s,!1,Fe(Ee.ListConversations)),{data:c,nextToken:u,errors:d}=await a(r);return{data:c.map(l=>Ht(e,t,l.id,l.createdAt,l.updatedAt,n,o,s,l==null?void 0:l.metadata,l==null?void 0:l.name)),nextToken:u,errors:d}},Df=(e,t,n,i,o,s)=>async({id:r})=>{const a=qt(e,t,i,"DELETE",s,!1,Fe(Ee.DeleteConversation)),{data:c,errors:u}=await a({id:r});return{data:c&&Ht(e,t,c==null?void 0:c.id,c==null?void 0:c.createdAt,c==null?void 0:c.updatedAt,n,o,s,c==null?void 0:c.metadata,c==null?void 0:c.name),errors:u}},kf=(e,t,n,i,o,s)=>async({id:r,metadata:a,name:c})=>{const u=JSON.stringify(a),d=qt(e,t,i,"UPDATE",s,!1,Fe(Ee.UpdateConversation)),{data:l,errors:p}=await d({id:r,metadata:u,name:c});return{data:l&&Ht(e,t,l==null?void 0:l.id,l==null?void 0:l.createdAt,l==null?void 0:l.updatedAt,n,o,s,l==null?void 0:l.metadata,l==null?void 0:l.name),errors:p}};function Mf(e,t,n){const i=t==null?void 0:t.modelIntrospection;if(!(i!=null&&i.conversations))return{};const o={};for(const{name:s,conversation:r,message:a,models:c,nonModels:u,enums:d}of Object.values(i.conversations)){const l=c[r.modelName],p=c[a.modelName];if(!l||!p)return{};const h={...i,models:{...i.models,...c},nonModels:{...i.nonModels,...u},enums:{...i.enums,...d}};o[s]={update:kf(e,h,s,l,p,n),create:xf(e,h,s,l,p,n),get:Of(e,h,s,l,p,n),delete:Df(e,h,s,l,p,n),list:Pf(e,h,s,l,p,n)}}return o}function Ff(e,t,n){const i=t==null?void 0:t.modelIntrospection;if(!(i!=null&&i.generations))return{};const o={};for(const s of Object.values(i.generations))o[s.name]=Dn(e,i,"query",s,!1,n,Fe(Ee.Generation));return o}const Lf=e=>{const t=e.modelIntrospection;if(!t)return{};const n={};for(const[i,o]of Object.entries(t.enums))n[o.name]={values:()=>o.values};return n};function Uf(e,t,n,i,o,s=!1){return s?(c,u,d)=>ws(e,t,n,i,o,{...u,...d},c):(c,u)=>ws(e,t,n,i,o,{...c,...u})}function Kf(e,t,n,i,o){const{data:s,extensions:r}=n,[a]=Object.keys(s);if(s[a].items){const c=s[a].items.map(u=>Oe(e,t,u));return{data:i?c:o(c),nextToken:s[a].nextToken,extensions:r}}return{data:s[a],nextToken:s[a].nextToken,extensions:r}}function ws(e,t,n,i,o,s,r){return Ke(async a=>{var h,f,E,g;const{name:c}=n,u=xn(t,n,"INDEX_QUERY",s,i),d=On(n,"INDEX_QUERY",s,t,i),l=gt(e,o,s),p=y=>Pe(e,c,y,t,l.authMode,l.authToken,!!r);try{const y=yt(e,o,s==null?void 0:s.headers),T=[{...l,query:u,variables:d},y];r!==void 0&&T.unshift(r);const v=e.graphql(...T),A=await Be(v,a);if(A.data!==void 0)return Kf(t,c,A,s==null?void 0:s.selectionSet,p)}catch(y){const{data:I,errors:T}=y;if(I!=null&&Object.keys(I).length!==0&&T){const[v]=Object.keys(I);if((h=I[v])!=null&&h.items){const S=(f=I[v])==null?void 0:f.items.map(A=>Oe(t,c,A));if(S)return{data:s!=null&&s.selectionSet?S:p(S),nextToken:(E=I[v])==null?void 0:E.nextToken}}return{data:I[v],nextToken:(g=I[v])==null?void 0:g.nextToken}}else return ri(y)}})}function Bf(e,t,n,i,o){const{name:s}=n;return a=>{const c=xn(t,n,i,a),u=On(n,i,a,t),d=gt(e,o,a),l=yt(e,o,a==null?void 0:a.headers);return e.graphql({...d,query:c,variables:u},l).pipe(ai(h=>{const[f]=Object.keys(h.data),E=h.data[f],g=Oe(t,s,E);if(g===null)return null;if(a!=null&&a.selectionSet)return g;{const[y]=Pe(e,s,[g],t,d.authMode,d.authToken);return y}}))}}function Vf(e){const{primaryKeyFieldName:t,sortKeyFieldNames:n}=e.primaryKeyInfo;return[t,...n]}function $f(e,t,n){const i=Object.fromEntries(n.map(o=>[o,e[o]]));for(let o=0;o<t.length;o++)if(Object.keys(i).every(s=>i[s]===t[o][s]))return o;return-1}function qf(e,t){const{name:n}=t;return o=>new xt(s=>{const r=[],a=[];let c=(...f)=>a.push(...f);const u=e[n].onCreate(o).subscribe({next(f){c({item:f,type:"create"})},error(f){s.error({type:"onCreate",error:f})}}),d=e[n].onUpdate(o).subscribe({next(f){c({item:f,type:"update"})},error(f){s.error({type:"onUpdate",error:f})}}),l=e[n].onDelete(o).subscribe({next(f){c({item:f,type:"delete"})},error(f){s.error({type:"onDelete",error:f})}});function p(f){for(const E of f){const g=$f(E.item,r,h);switch(E.type){case"create":g<0&&r.push(E.item);break;case"update":g>=0&&(r[g]=E.item);break;case"delete":g>=0&&r.splice(g,1);break;default:console.error("Unrecognized message in observeQuery.",E)}}s.next({items:r,isSynced:!0})}const h=Vf(t);return(async()=>{let f=!0,E=null;for(;!s.closed&&(f||E);){f=!1;const{data:g,errors:y,nextToken:I}=await e[n].list({...o,nextToken:E});E=I,r.push(...g);const T=a.length===0&&E==null;if(s.next({items:r,isSynced:T}),Array.isArray(y))for(const v of y)s.error(v)}a.length>0&&p(a),c=(...g)=>(p(g),r.length)})(),()=>{u.unsubscribe(),d.unsubscribe(),l.unsubscribe()}})}const Hf=e=>{var t,n,i;return e.type==="key"&&((t=e.properties)==null?void 0:t.name)&&((n=e.properties)==null?void 0:n.queryField)&&((i=e.properties)==null?void 0:i.fields.length)>0},Wf=e=>{var n;return((n=e.attributes)==null?void 0:n.filter(Hf).map(i=>{const o=i.properties.queryField,[s,...r]=i.properties.fields;return{queryField:o,pk:s,sk:r}}))||[]},jf=(e,t)=>{var a;const n=(a=e.models[t].attributes)==null?void 0:a.find(c=>c.type==="model"),i={queries:["list","get","observeQuery"],mutations:["create","update","delete"],subscriptions:["onCreate","onUpdate","onDelete"]},o=[];if(!n)return oi;if(n.properties)for(const[c,u]of Object.entries(n.properties))c in i&&(u===null?o.push(...i[c]):u instanceof Object&&o.push(...Object.keys(u)));o.includes("list")&&o.push("observeQuery");const s=o.map(c=>c.toUpperCase());return Object.fromEntries(Object.entries(oi).filter(([c])=>!s.includes(c)))};function Gf(e,t,n){const i={},o=t.modelIntrospection;if(!o)return{};const s=["ONCREATE","ONUPDATE","ONDELETE"];for(const r of Object.values(o.models)){const{name:a}=r;i[a]={};const c=jf(o,a);Object.entries(c).forEach(([d,{operationPrefix:l}])=>{const p=d;p==="LIST"?i[a][l]=Di(e,o,r,n):s.includes(p)?i[a][l]=Bf(e,o,r,p,n):p==="OBSERVEQUERY"?i[a][l]=qf(i,r):i[a][l]=qt(e,o,r,p,n)});const u=Wf(r);for(const d of u)i[a][d.queryField]=Uf(e,o,r,d,n)}return i}function qr(e,t,n){return Yh(e),e.models=Gf(e,t,n),e.enums=Lf(t),e.queries=lf(e,t,n),e.mutations=df(e,t,n),e.subscriptions=pf(e,t,n),e.conversations=Mf(e,t,n),e.generations=Ff(e,t,n),e}function zf(e){return Oi in e}class Qf extends zh{getModuleName(){return"GraphQLAPI"}graphql(t,n,i){const o={category:ln.API,action:qn.GraphQl};if(zf(n)){const{[Oi]:s,...r}=n;return super.graphql(t,r,i,{...o,...s})}return super.graphql(t,n,i,{...o})}isCancelError(t){return super.isCancelError(t)}cancel(t,n){return super.cancel(t,n)}}const ki=new Qf;function Yf(e,t){const n=xi(this),i=n.endpoint,o=n.authMode,s=n.apiKey;if(e.authMode=e.authMode||o,e.apiKey=e.apiKey??s,e.authToken=e.authToken||n.authToken,i&&e.authMode==="apiKey"&&!e.apiKey)throw new Error("graphql() requires an explicit `apiKey` for a custom `endpoint` when `authMode = 'apiKey'`.");const r=t||n.headers;return ki.graphql(n.amplify,{...e,endpoint:i},r)}function Jf(e,t){return ki.cancel(e,t)}function Xf(e){return ki.isCancelError(e)}function Hr(e){return e!==void 0}function Zf(e){return e.event==="configure"}function em(e){var i;const t={[xr]:e.amplify,[an]:e.authMode,[Or]:e.authToken,[ii]:"apiKey"in e?e.apiKey:void 0,[cn]:"endpoint"in e?e.endpoint:void 0,[Pr]:e.headers,graphql:Yf,cancel:Jf,isCancelError:Xf,models:wt,enums:wt,queries:wt,mutations:wt,subscriptions:wt},n=(i=e.amplify.getConfig().API)==null?void 0:i.GraphQL;if(t[cn]){if(!t[an])throw new Error("generateClient() requires an explicit `authMode` when `endpoint` is provided.");if(t[an]==="apiKey"&&!t[ii])throw new Error("generateClient() requires an explicit `apiKey` when `endpoint` is provided and `authMode = 'apiKey'`.")}return t[cn]||(Hr(n)?qr(t,n,xi):tm(t)),t}const tm=e=>{He.listen("core",t=>{var i;if(!Zf(t.payload))return;const n=(i=t.payload.data.API)==null?void 0:i.GraphQL;Hr(n)&&qr(e,n,xi)})},wt=new Proxy({},{get(){throw new Error("Client could not be generated. This is likely due to `Amplify.configure()` not being called prior to `generateClient()` or because the configuration passed to `Amplify.configure()` is missing GraphQL provider configuration.")}});function sm(e){return em({amplify:V})}export{im as D,He as H,Si as a,ql as b,Il as c,bl as d,sm as g,om as i,Rl as r,Al as s};
