import{a as N,u as y,r as a,j as e,L as j}from"./react-vendor-C_ls207L.js";import{S as C}from"./StandardLayout-CHsFjCWf.js";import{F as v}from"./FormBox-Dl2qNixC.js";import{T as p}from"./TextInput-BQHZCKtc.js";import{P as S}from"./PrimaryButton-BzVl43HT.js";/* empty css             */import{d as E}from"./amplify-core-Blotw2Bg.js";import"./vendor-DeJPPs1q.js";import"./sanity-BS235U2J.js";import"./PageWrapper-CRYaw3_L.js";import"./Footer-B_S_3MWt.js";/* empty css                  */const z=()=>{const n=N(),i=y(),[l,g]=a.useState(""),[d,P]=a.useState(""),[r,x]=a.useState(""),[m,_]=a.useState(""),[o,c]=a.useState(!1),[u,w]=a.useState(""),[h,t]=a.useState("");a.useEffect(()=>{var s;(s=i.state)!=null&&s.email?g(i.state.email):(t("No email address provided. Please start the password reset process again."),setTimeout(()=>n("/forgot-password"),4e3))},[i.state,n]);const b=async s=>{if(s.preventDefault(),t(""),w(""),!d||!r||!m){t("Please fill in all fields.");return}if(r!==m){t("Passwords do not match.");return}if(r.length<8){t("Password must be at least 8 characters long.");return}c(!0);try{await E({username:l,confirmationCode:d,newPassword:r}),w("Your password has been successfully reset! Redirecting to login..."),c(!1),setTimeout(()=>{n("/login",{state:{message:"Password successfully reset. Please log in.",email:l}})},3e3)}catch(f){console.error("Error resetting password:",f),f.name==="CodeMismatchException"?t("Invalid confirmation code. Please check the code and try again."):t(f.message||"An error occurred. Please try again."),c(!1)}};return e.jsx(C,{title:"Reset Your Password",subtitle:"Please create a new password for your account.",className:"reset-password-page",children:e.jsxs(v,{children:[u&&e.jsx("p",{className:"auth-form__message success",role:"alert",children:u}),!u&&e.jsxs("form",{onSubmit:b,className:"auth-form",children:[e.jsxs("p",{className:"auth-form__instruction",children:["A password reset code has been sent to ",e.jsx("strong",{children:l}),". Please enter the code and your new password below."]}),e.jsx(p,{id:"confirmationCode",name:"confirmationCode",type:"text",label:"Reset Code",placeholder:"Enter the code from your email",value:d,onChange:s=>P(s.target.value),disabled:o,containerClassName:"auth-form__input-field"}),e.jsx(p,{id:"newPassword",name:"newPassword",type:"password",label:"New Password",placeholder:"Enter your new password",value:r,onChange:s=>x(s.target.value),disabled:o,containerClassName:"auth-form__input-field"}),e.jsx(p,{id:"confirmPassword",name:"confirmPassword",type:"password",label:"Confirm New Password",placeholder:"Confirm your new password",value:m,onChange:s=>_(s.target.value),disabled:o,containerClassName:"auth-form__input-field"}),h&&e.jsx("p",{className:"auth-form__message error",role:"alert",children:h}),e.jsx("div",{className:"auth-form__button-container",children:e.jsx(S,{type:"submit",disabled:o,className:"auth-form__submit-button",children:o?"Resetting...":"Set New Password"})}),e.jsx("div",{className:"auth-form__links",children:e.jsx(j,{to:"/login",className:"auth-form__link",children:"Back to Login"})})]})]})})};export{z as default};
